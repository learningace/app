(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{S4wv:function(t,e,n){"use strict";n.r(e),n.d(e,"CourseModule",function(){return Md});var r=n("ofXK"),i=n("Dk7Y"),o=n("tyNb"),s=n("fXoL"),u=n("ZEmE"),a=n("1Ywj"),c=n("3Pt+");function h(t,e){1&t&&(s.Qb(0,"div",13),s.uc(1," First let's find out what type of course you are making "),s.Pb())}function f(t,e){1&t&&(s.Qb(0,"div",13),s.uc(1," How about a working title for the course "),s.Pb())}function l(t,e){1&t&&(s.Qb(0,"div",13),s.uc(1," What category best fits the knowledge you will share "),s.Pb())}function p(t,e){if(1&t&&(s.Qb(0,"span"),s.uc(1),s.ac(2,"titlecase"),s.Pb()),2&t){const t=s.Zb(2);s.Bb(1),s.wc(" Select a course type : ",s.bc(2,1,t.courseProperty.type)," ")}}function d(t,e){if(1&t&&(s.Qb(0,"span"),s.uc(1),s.ac(2,"titlecase"),s.Pb()),2&t){const t=s.Zb(2);s.Bb(1),s.wc(" Give your course a title : ",s.bc(2,1,t.courseProperty.name)," ")}}function v(t,e){if(1&t&&(s.Qb(0,"div",14),s.tc(1,p,3,3,"span",15),s.tc(2,d,3,3,"span",15),s.Pb()),2&t){const t=s.Zb();s.Bb(1),s.ec("ngIf",1==t.currentStep),s.Bb(1),s.ec("ngIf",2==t.currentStep)}}const y=function(t){return{selected:t}};function g(t,e){if(1&t){const t=s.Rb();s.Qb(0,"div",16),s.Qb(1,"div",17),s.Xb("click",function(){return s.lc(t),s.Zb().addCourseProperty("CONTENT","type")}),s.Qb(2,"span",18),s.uc(3,"Content Based"),s.Pb(),s.Qb(4,"small"),s.uc(5,"Create rich learning experience with help of lecture, queries, assesments "),s.Pb(),s.Pb(),s.Qb(6,"div",17),s.Xb("click",function(){return s.lc(t),s.Zb().addCourseProperty("VIRTUAL","type")}),s.Qb(7,"span",18),s.uc(8,"Virtual Classroom"),s.Pb(),s.Qb(9,"small"),s.uc(10,"Conduct live classes with your students. Engage in rich live interactive classes "),s.Pb(),s.Pb(),s.Qb(11,"div",17),s.Xb("click",function(){return s.lc(t),s.Zb().addCourseProperty("PRACTICE","type")}),s.Qb(12,"span",18),s.uc(13,"Practice Test"),s.Pb(),s.Qb(14,"small"),s.uc(15,"Help students prepare for certifcation exams by providing powerful practice exercises "),s.Pb(),s.Pb(),s.Pb()}if(2&t){const t=s.Zb();s.Bb(1),s.ec("ngClass",s.gc(3,y,"CONTENT"==t.courseProperty.type)),s.Bb(5),s.ec("ngClass",s.gc(5,y,"VIRTUAL"==t.courseProperty.type)),s.Bb(5),s.ec("ngClass",s.gc(7,y,"PRACTICE"==t.courseProperty.type))}}function b(t,e){if(1&t){const t=s.Rb();s.Qb(0,"div",19),s.Qb(1,"label"),s.uc(2,"Name :"),s.Pb(),s.Qb(3,"div",20),s.Qb(4,"input",21,22),s.Xb("ngModelChange",function(e){return s.lc(t),s.Zb().courseProperty.name=e})("input",function(){s.lc(t);const e=s.kc(5);return s.Zb().addCourseProperty(e,"name")}),s.Pb(),s.Qb(6,"div",23),s.Qb(7,"span",24),s.uc(8),s.Pb(),s.Pb(),s.Pb(),s.Pb()}if(2&t){const t=s.Zb();s.Bb(4),s.ec("ngModel",t.courseProperty.name),s.Bb(4),s.vc(t.nameLeftLength)}}function m(t,e){if(1&t){const t=s.Rb();s.Qb(0,"div",19),s.Qb(1,"label"),s.uc(2),s.Pb(),s.Qb(3,"select",25,26),s.Xb("ngModelChange",function(e){return s.lc(t),s.Zb().courseProperty.categoryId=e})("change",function(e){return s.lc(t),s.Zb().addCourseProperty(e,"CATEGORY")}),s.Qb(5,"option",27),s.uc(6,"Choose a category"),s.Pb(),s.Qb(7,"option",28),s.uc(8,"Math"),s.Pb(),s.Qb(9,"option",29),s.uc(10,"Science"),s.Pb(),s.Qb(11,"option",30),s.uc(12,"Physics"),s.Pb(),s.Qb(13,"option",31),s.uc(14,"Chemistry "),s.Pb(),s.Qb(15,"option",32),s.uc(16,"Biology"),s.Pb(),s.Qb(17,"option",33),s.uc(18,"History"),s.Pb(),s.Qb(19,"option",34),s.uc(20,"Business and Management"),s.Pb(),s.Qb(21,"option",35),s.uc(22,"IT and Computer Science"),s.Pb(),s.Qb(23,"option",36),s.uc(24,"Literature"),s.Pb(),s.Qb(25,"option",37),s.uc(26,"Language"),s.Pb(),s.Qb(27,"option",38),s.uc(28,"Law"),s.Pb(),s.Qb(29,"option",39),s.uc(30,"Psychology"),s.Pb(),s.Qb(31,"option",40),s.uc(32,"Creative arts and media"),s.Pb(),s.Qb(33,"option",41),s.uc(34,"Healthcare and medicine"),s.Pb(),s.Qb(35,"option",42),s.uc(36,"Design"),s.Pb(),s.Pb(),s.Pb()}if(2&t){const t=s.Zb();s.Bb(2),s.wc("Select a category : ",t.courseProperty.category," "),s.Bb(1),s.ec("ngModel",t.courseProperty.categoryId)}}function w(t,e){if(1&t){const t=s.Rb();s.Qb(0,"button",43),s.Xb("click",function(){return s.lc(t),s.Zb().backStep()}),s.uc(1,"Back "),s.Pb()}}function I(t,e){if(1&t){const t=s.Rb();s.Qb(0,"button",44),s.Xb("click",function(){return s.lc(t),s.Zb().nextStep()}),s.uc(1,"Next "),s.Pb()}if(2&t){const t=s.Zb();s.ec("disabled",!t.checkValidation())("title",t.getValidationMsg())}}function _(t,e){if(1&t){const t=s.Rb();s.Qb(0,"button",44),s.Xb("click",function(){return s.lc(t),s.Zb().createCourse()}),s.uc(1,"Create Course "),s.Pb()}if(2&t){const t=s.Zb();s.ec("disabled",!t.checkValidation())("title",t.getValidationMsg())}}const E=function(t,e){return{"w-100":t,"w-50":e}};let O=(()=>{class t{constructor(t,e){this.title=t,this.route=e,this.nameLeftLength=60,this.nameMaxLength=60,this.courseProperty={type:"",name:"",category:"",categoryId:0},this.stepsConfig={1:{showHeader:!1,valid:!1},2:{showHeader:!0,valid:!1},3:{showHeader:!1,valid:!1}},this.currentStep=1,this.maxStep=3,this.title.setTitle("LearningAce | Add a course"),sessionStorage.getItem("step")&&(this.currentStep=+(sessionStorage.getItem("step")||""),this.courseProperty.type=sessionStorage.getItem("type")||"",this.courseProperty.name=sessionStorage.getItem("name")||"",this.courseProperty.category=sessionStorage.getItem("category")||"",this.nameLeftLength=this.nameMaxLength-this.courseProperty.name.length,this.courseProperty.categoryId=+(sessionStorage.getItem("categoryId")||""))}addCourseProperty(t,e){switch(e){case"type":this.courseProperty.type=t,sessionStorage.setItem("type",t);break;case"name":this.courseProperty.name=t.value,this.nameLeftLength=this.nameMaxLength-this.courseProperty.name.length,sessionStorage.setItem("name",t.value);break;case"description":this.courseProperty.name=t.target.value,sessionStorage.setItem("description",t.target.value);break;case"CATEGORY":this.courseProperty.category=this.categoriesMap(parseInt(t.target.value)),this.courseProperty.categoryId=t.target.value,sessionStorage.setItem("category",this.courseProperty.category),sessionStorage.setItem("categoryId",this.courseProperty.categoryId.toString())}}nextStep(){this.currentStep++,sessionStorage.setItem("step",this.currentStep.toString())}backStep(){this.currentStep--,sessionStorage.setItem("step",this.currentStep.toString())}createCourse(){this.route.navigate(["/lecture"])}checkValidation(){switch(this.currentStep){case 1:return""!=this.courseProperty.type;case 2:return""!=this.courseProperty.name;case 3:return""!=this.courseProperty.category}return!1}getValidationMsg(){switch(this.currentStep){case 1:if(""==this.courseProperty.type)return"Select a course type first to proceed further";break;case 2:if(0==this.courseProperty.name.length)return"Please a name for course";break;case 3:if(""==this.courseProperty.category)return"Please choose a category"}return"Click to proceed"}categoriesMap(t){switch(t){case 0:return"";case 1:return"Math";case 2:return"Science";case 3:return"Physics";case 4:return"Chemistry";case 5:return"Biology";case 6:return"History";case 7:return"Business and management";case 8:return"IT and Computer Science";case 9:return"Literature";case 10:return"Language";case 11:return"Law";case 12:return"Psychology";case 13:return"Creative arts and media";case 14:return"Healthcare and medicine";case 15:return"Design"}return""}ngOnDestroy(){sessionStorage.clear(),console.log("destroying")}}return t.\u0275fac=function(e){return new(e||t)(s.Lb(u.a),s.Lb(o.f))},t.\u0275cmp=s.Fb({type:t,selectors:[["app-add-course"]],decls:18,vars:20,consts:[[3,"background","type","elevation","stackable"],[2,"cursor","pointer"],["routerLink","/","src","../../../assets/logo4.png","alt","LearningAce logo","width","150px",2,"padding-left","10px"],[1,"ui-button"],[1,"container"],["class","display-4","style","font-size: xx-large; margin-bottom: 20px; width: 100%; text-align: center;",4,"ngIf"],[1,"card","shadow","rounded",3,"ngClass"],["class","card-header",4,"ngIf"],["style","display: flex; flex-direction: row; justify-content: space-around;flex-wrap: wrap;",4,"ngIf"],["class","m-2",4,"ngIf"],[1,"card-footer"],["class","btn btn-primary float-left",3,"click",4,"ngIf"],["class","btn btn-primary float-right",3,"disabled","title","click",4,"ngIf"],[1,"display-4",2,"font-size","xx-large","margin-bottom","20px","width","100%","text-align","center"],[1,"card-header"],[4,"ngIf"],[2,"display","flex","flex-direction","row","justify-content","space-around","flex-wrap","wrap"],[1,"ui-card-4","d-flex","justify-content-center","box",2,"width","200px","height","200px","margin","20px","cursor","pointer","padding","10px","text-align","center",3,"ngClass","click"],[2,"font-size","larger"],[1,"m-2"],[1,"input-group"],["type","text","maxlength","60",1,"form-control",3,"ngModel","ngModelChange","input"],["courseName","ngModel"],[1,"input-group-append"],[1,"input-group-text"],[1,"custom-select",3,"ngModel","ngModelChange","change"],["category","ngModel"],["value","0"],["value","1"],["value","2"],["value","3"],["value","4"],["value","5"],["value","6"],["value","7"],["value","8"],["value","9"],["value","10"],["value","11"],["value","12"],["value","13"],["value","14"],["value","15"],[1,"btn","btn-primary","float-left",3,"click"],[1,"btn","btn-primary","float-right",3,"disabled","title","click"]],template:function(t,e){1&t&&(s.Qb(0,"app-header",0),s.Qb(1,"header",1),s.Mb(2,"img",2),s.Pb(),s.Qb(3,"div",3),s.uc(4),s.Pb(),s.Pb(),s.Qb(5,"div",4),s.tc(6,h,2,0,"div",5),s.tc(7,f,2,0,"div",5),s.tc(8,l,2,0,"div",5),s.Qb(9,"div",6),s.tc(10,v,3,2,"div",7),s.tc(11,g,16,9,"div",8),s.tc(12,b,9,2,"div",9),s.tc(13,m,37,2,"div",9),s.Qb(14,"div",10),s.tc(15,w,2,0,"button",11),s.tc(16,I,2,2,"button",12),s.tc(17,_,2,2,"button",12),s.Pb(),s.Pb(),s.Pb()),2&t&&(s.ec("background","light-gray")("type","horizontal")("elevation",!0)("stackable",!0),s.Bb(4),s.xc(" Step ",e.currentStep," of ",e.maxStep,""),s.Bb(2),s.ec("ngIf",1==e.currentStep),s.Bb(1),s.ec("ngIf",2==e.currentStep),s.Bb(1),s.ec("ngIf",3==e.currentStep),s.Bb(1),s.ec("ngClass",s.hc(17,E,1==e.currentStep,1!=e.currentStep)),s.Bb(1),s.ec("ngIf",e.stepsConfig[e.currentStep].showHeader),s.Bb(1),s.ec("ngIf",1==e.currentStep),s.Bb(1),s.ec("ngIf",2==e.currentStep),s.Bb(1),s.ec("ngIf",3==e.currentStep),s.Bb(2),s.ec("ngIf",1!=e.currentStep),s.Bb(1),s.ec("ngIf",e.currentStep!=e.maxStep),s.Bb(1),s.ec("ngIf",e.currentStep==e.maxStep))},directives:[a.a,o.g,r.l,r.j,c.a,c.d,c.f,c.i,c.m,c.j,c.n],pipes:[r.o],styles:['.glyphicon[_ngcontent-%COMP%]{position:relative;top:1px;display:inline-block;font-family:Glyphicons Halflings;font-style:normal;font-weight:400;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.glyphicon-plus-sign[_ngcontent-%COMP%]:before{content:"\\e081"}.glyphicon-plus[_ngcontent-%COMP%]:before{content:"\\002b"}.box[_ngcontent-%COMP%]{border-radius:20px;transition:.5s ease;transition-property:all}.box[_ngcontent-%COMP%]:hover, .selected[_ngcontent-%COMP%]{box-shadow:0 1px 5px 1px #006089;transform:scale(1.05);-moz-transform:scale(1.05);-o-transform:scale(1.05)}.selected[_ngcontent-%COMP%]{color:green;font-weight:700}.card[_ngcontent-%COMP%]{margin-right:auto;margin-left:auto}@media (min-width:768px) and (max-width:991px){.card[_ngcontent-%COMP%]{width:75%!important}}@media (max-width:767px){.card[_ngcontent-%COMP%]{width:100%!important}}']}),t})();var T=n("nYR2"),j=n("JIr8"),S=n("tk/3");let x=(()=>{class t{constructor(t){this.http=t}searchByKeyword(t){return this.http.get("https://api.unsplash.com/search/photos",{headers:{Authorization:"Client-ID wJW7lhdpvEJKii2QcUjvg5HdjP_cDcTIAnj6rmKQgr4"},params:{query:t,per_page:"12"}})}getPage(t,e){return this.http.get("https://api.unsplash.com/search/photos",{headers:{Authorization:"Client-ID wJW7lhdpvEJKii2QcUjvg5HdjP_cDcTIAnj6rmKQgr4"},params:{query:t,page:e,per_page:"12"}})}}return t.\u0275fac=function(e){return new(e||t)(s.Ub(S.b))},t.\u0275prov=s.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var N=n("0IaG");function A(t,e){if(1&t&&(s.Qb(0,"div",14),s.uc(1),s.Pb()),2&t){const t=s.Zb();s.Bb(1),s.vc(t.error)}}function P(t,e){1&t&&s.Mb(0,"div",15)}function k(t,e){if(1&t&&(s.Qb(0,"div",17),s.Mb(1,"img",18),s.Pb()),2&t){const t=e.$implicit;s.Bb(1),s.ec("src",t.url,s.nc)("alt",t.alt_description)}}function D(t,e){if(1&t&&(s.Ob(0),s.tc(1,k,2,2,"div",16),s.Nb()),2&t){const t=s.Zb();s.Bb(1),s.ec("ngForOf",t.imageResults)}}let C=(()=>{class t{constructor(t){this.unsplash=t,this.show=!1,this.imageResults=[],this.previousResults=[],this.loading=!1,this.error="",this.currentPage=0,this.totalPages=0,this.key=""}ngOnInit(){}getPhotosByKey(t){this.key=t,this.error="",this.loading=!0,this.imageResults=[],this.unsplash.searchByKeyword(t).pipe(Object(T.a)(()=>{this.loading=!1}),Object(j.a)(t=>this.error=t.error.errors[0])).subscribe(t=>{if(0==t.total_pages)return this.error="No results. Try with different keyword",void(this.currentPage=0);this.currentPage=1;const e=t.results;for(let n of e)this.imageResults.push({url:n.urls.thumb,alt_description:n.alt_description});this.totalPages=t.total_pages,console.log(this.totalPages)})}nextPage(){if(this.currentPage++,this.error="",this.loading=!0,!(this.currentPage<=this.totalPages&&""!=this.key))return this.currentPage=0,this.error="Nothing to fetch next page from",void(this.loading=!1);this.previousResults=this.imageResults,this.unsplash.getPage(this.key,this.currentPage.toString()).pipe(Object(T.a)(()=>{this.loading=!1}),Object(j.a)(t=>this.error=t.error.errors[0])).subscribe(t=>{this.imageResults=[];const e=t.results;for(let n of e)this.imageResults.push({url:n.urls.thumb,alt_description:n.alt_description})})}backPage(){if(this.error="",0==this.currentPage||1==this.currentPage)return 1==this.currentPage||(this.currentPage=0,this.error="Nothing to fetch previous page from"),void(this.loading=!1);this.imageResults=[],this.loading=!0,this.currentPage--,this.unsplash.getPage(this.key,this.currentPage.toString()).pipe(Object(T.a)(()=>{this.loading=!1}),Object(j.a)(t=>this.error=t.error.errors[0])).subscribe(t=>{const e=t.results;for(let n of e)this.imageResults.push({url:n.urls.thumb,alt_description:n.alt_description})})}}return t.\u0275fac=function(e){return new(e||t)(s.Lb(x))},t.\u0275cmp=s.Fb({type:t,selectors:[["app-unsplash-toolbar"]],decls:22,vars:8,consts:[["mat-dialog-title",""],[1,"input-group"],["ngModel","","type","text","required","",1,"form-control"],["searchKey","ngModel"],[1,"append"],[1,"btn","btn-light",3,"disabled","click"],[1,"mat-typography",2,"min-height","60vh","min-width","80vw"],[2,"display","flex","flex-direction","row","flex-wrap","wrap","justify-content","center","align-items","center"],["class","alert alert-danger",4,"ngIf"],["class","lds-dual-ring",4,"ngIf"],[4,"ngIf"],["align","end"],[1,"btn","btn-primary","mr-5",3,"disabled","click"],["mat-dialog-close","",1,"btn","btn-light"],[1,"alert","alert-danger"],[1,"lds-dual-ring"],["class","card shadow m-1",4,"ngFor","ngForOf"],[1,"card","shadow","m-1"],[1,"image-fluid",3,"src","alt"]],template:function(t,e){if(1&t){const t=s.Rb();s.Qb(0,"h2",0),s.uc(1,"Search for the photo"),s.Pb(),s.Qb(2,"div",1),s.Mb(3,"input",2,3),s.Qb(5,"span",4),s.Qb(6,"button",5),s.Xb("click",function(){s.lc(t);const n=s.kc(4);return e.getPhotosByKey(n.value)}),s.uc(7," Search "),s.Pb(),s.Pb(),s.Pb(),s.Qb(8,"div"),s.uc(9),s.Pb(),s.Qb(10,"mat-dialog-content",6),s.Qb(11,"div",7),s.tc(12,A,2,1,"div",8),s.tc(13,P,1,0,"div",9),s.tc(14,D,2,1,"ng-container",10),s.Pb(),s.Pb(),s.Qb(15,"mat-dialog-actions",11),s.Qb(16,"button",12),s.Xb("click",function(){return e.backPage()}),s.uc(17," Back "),s.Pb(),s.Qb(18,"button",12),s.Xb("click",function(){return e.nextPage()}),s.uc(19," Next "),s.Pb(),s.Qb(20,"button",13),s.uc(21,"Cancel"),s.Pb(),s.Pb()}if(2&t){const t=s.kc(4);s.Bb(6),s.ec("disabled",t.invalid),s.Bb(3),s.xc("Pages ",e.currentPage," of ",e.totalPages,""),s.Bb(3),s.ec("ngIf",e.error),s.Bb(1),s.ec("ngIf",e.loading),s.Bb(1),s.ec("ngIf",e.imageResults),s.Bb(2),s.ec("disabled",t.invalid),s.Bb(2),s.ec("disabled",t.invalid)}},directives:[N.f,c.a,c.f,c.i,c.l,N.d,r.l,N.b,N.c,r.k],styles:['.lds-dual-ring[_ngcontent-%COMP%]{display:inline-block;width:80px;height:80px}.lds-dual-ring[_ngcontent-%COMP%]:after{content:" ";display:block;width:64px;height:64px;margin:8px;border-radius:50%;border-color:#000 transparent;border-style:solid;border-width:6px;animation:lds-dual-ring 1.2s linear infinite}@keyframes lds-dual-ring{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}']}),t})();var L=n("D0XW"),R=n("HDdC"),M=n("Cfvw"),U=n("LRne"),V=n("JX91"),q=n("Zy1z"),F=n("lJxs"),B=n("Kqap"),z=n("/uUt"),G=n("pLZG"),H=n("pxpQ"),K=n("spgP"),Q=n("Jgta"),J=n("zIRd"),X=n("q/0M"),W=n("qOnz"),Y=function(t,e){return(Y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function Z(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var $,tt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},et=et||{},nt=tt||self;function rt(){}function it(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function ot(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var st="closure_uid_"+(1e9*Math.random()>>>0),ut=0;function at(t,e,n){return t.call.apply(t.bind,arguments)}function ct(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function ht(t,e,n){return(ht=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?at:ct).apply(null,arguments)}function ft(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function lt(){return Date.now()}function pt(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function dt(){this.j=this.j,this.i=this.i}dt.prototype.j=!1,dt.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,st)&&t[st]||(t[st]=++ut)}(this)},dt.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var vt=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},yt=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function gt(t){return Array.prototype.concat.apply([],arguments)}function bt(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function mt(t){return/^[\s\xa0]*$/.test(t)}var wt,It=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function _t(t,e){return-1!=t.indexOf(e)}function Et(t,e){return t<e?-1:t>e?1:0}t:{var Ot=nt.navigator;if(Ot){var Tt=Ot.userAgent;if(Tt){wt=Tt;break t}}wt=""}function jt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function St(t){var e={};for(var n in t)e[n]=t[n];return e}var xt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Nt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<xt.length;o++)n=xt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function At(t){return At[" "](t),t}At[" "]=rt;var Pt,kt,Dt=_t(wt,"Opera"),Ct=_t(wt,"Trident")||_t(wt,"MSIE"),Lt=_t(wt,"Edge"),Rt=Lt||Ct,Mt=_t(wt,"Gecko")&&!(_t(wt.toLowerCase(),"webkit")&&!_t(wt,"Edge"))&&!(_t(wt,"Trident")||_t(wt,"MSIE"))&&!_t(wt,"Edge"),Ut=_t(wt.toLowerCase(),"webkit")&&!_t(wt,"Edge");function Vt(){var t=nt.document;return t?t.documentMode:void 0}t:{var qt="",Ft=(kt=wt,Mt?/rv:([^\);]+)(\)|;)/.exec(kt):Lt?/Edge\/([\d\.]+)/.exec(kt):Ct?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(kt):Ut?/WebKit\/(\S+)/.exec(kt):Dt?/(?:Version)[ \/]?(\S+)/.exec(kt):void 0);if(Ft&&(qt=Ft?Ft[1]:""),Ct){var Bt=Vt();if(null!=Bt&&Bt>parseFloat(qt)){Pt=String(Bt);break t}}Pt=qt}var zt={};function Gt(t){return function(t,e){var n=zt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,function(){for(var e=0,n=It(String(Pt)).split("."),r=It(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=Et(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||Et(0==s[2].length,0==u[2].length)||Et(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e})}var Ht=nt.document&&Ct&&(Vt()||parseInt(Pt,10))||void 0,Kt=!Ct||9<=Number(Ht),Qt=Ct&&!Gt("9"),Jt=function(){if(!nt.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{nt.addEventListener("test",rt,e),nt.removeEventListener("test",rt,e)}catch(n){}return t}();function Xt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Wt(t,e){if(Xt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Mt){t:{try{At(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Yt[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}Xt.prototype.b=function(){this.defaultPrevented=!0},pt(Wt,Xt);var Yt={2:"touch",3:"pen",4:"mouse"};Wt.prototype.b=function(){Wt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Qt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var Zt="closure_listenable_"+(1e6*Math.random()|0),$t=0;function te(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++$t,this.Y=this.Z=!1}function ee(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function ne(t){this.src=t,this.a={},this.b=0}function re(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=vt(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(ee(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function ie(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}ne.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=ie(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new te(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var oe="closure_lm_"+(1e6*Math.random()|0),se={};function ue(t,e,n,r,i){if(r&&r.once)return ce(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)ue(t,e[o],n,r,i);return null}return n=ge(n),t&&t[Zt]?t.va(e,n,ot(r)?!!r.capture:!!r,i):ae(t,e,n,!1,r,i)}function ae(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=ot(i)?!!i.capture:!!i;if(s&&!Kt)return null;var u=ve(t);if(u||(t[oe]=u=new ne(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=de,e=Kt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Jt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(le(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function ce(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)ce(t,e[o],n,r,i);return null}return n=ge(n),t&&t[Zt]?t.wa(e,n,ot(r)?!!r.capture:!!r,i):ae(t,e,n,!0,r,i)}function he(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)he(t,e[o],n,r,i);else r=ot(r)?!!r.capture:!!r,n=ge(n),t&&t[Zt]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=ie(o=t.a[e],n,r,i))&&(ee(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=ve(t))&&(e=t.a[e.toString()],t=-1,e&&(t=ie(e,n,r,i)),(n=-1<t?e[t]:null)&&fe(n))}function fe(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[Zt])re(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(le(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=ve(e))?(re(n,t),0==n.b&&(n.src=null,e[oe]=null)):ee(t)}}}function le(t){return t in se?se[t]:se[t]="on"+t}function pe(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&fe(t),n.call(r,e)}function de(t,e){if(t.Y)return!0;if(!Kt){if(!e)t:{e=["window","event"];for(var n=nt,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return pe(t,e=new Wt(e,this))}return pe(t,new Wt(e,this))}function ve(t){return(t=t[oe])instanceof ne?t:null}var ye="__closure_events_fn_"+(1e9*Math.random()>>>0);function ge(t){return"function"==typeof t?t:(t[ye]||(t[ye]=function(e){return t.handleEvent(e)}),t[ye])}function be(){dt.call(this),this.c=new ne(this),this.J=this,this.C=null}function me(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new Xt(e,t);else if(e instanceof Xt)e.target=e.target||t;else{var i=e;Nt(e=new Xt(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=we(s,r,!0,e)&&i}if(i=we(s=e.a=t,r,!0,e)&&i,i=we(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=we(s=e.a=n[o],r,!1,e)&&i}function we(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&re(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}pt(be,dt),be.prototype[Zt]=!0,($=be.prototype).addEventListener=function(t,e,n,r){ue(this,t,e,n,r)},$.removeEventListener=function(t,e,n,r){he(this,t,e,n,r)},$.G=function(){if(be.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)ee(n[r]);delete e.a[t],e.b--}}this.C=null},$.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},$.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ie=nt.JSON.stringify;function _e(){this.b=this.a=null}var Ee,Oe=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())(function(){return new je},function(t){t.reset()});function Te(){var t=Ae,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function je(){this.next=this.b=this.a=null}function Se(t){nt.setTimeout(function(){throw t},0)}function xe(t,e){Ee||function(){var t=nt.Promise.resolve(void 0);Ee=function(){t.then(Pe)}}(),Ne||(Ee(),Ne=!0),Ae.add(t,e)}_e.prototype.add=function(t,e){var n=Oe.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},je.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},je.prototype.reset=function(){this.next=this.b=this.a=null};var Ne=!1,Ae=new _e;function Pe(){for(var t;t=Te();){try{t.a.call(t.b)}catch(n){Se(n)}var e=Oe;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Ne=!1}function ke(t,e){be.call(this),this.b=t||1,this.a=e||nt,this.f=ht(this.Za,this),this.g=lt()}function De(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Ce(t,e,n){if("function"==typeof t)n&&(t=ht(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=ht(t.handleEvent,t)}return 2147483647<Number(e)?-1:nt.setTimeout(t,e||0)}function Le(t){t.a=Ce(function(){t.a=null,t.c&&(t.c=!1,Le(t))},t.h);var e=t.b;t.b=null,t.g.apply(null,e)}pt(ke,be),($=ke.prototype).aa=!1,$.M=null,$.Za=function(){if(this.aa){var t=lt()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),me(this,"tick"),this.aa&&(De(this),this.start()))}},$.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=lt())},$.G=function(){ke.X.G.call(this),De(this),delete this.a};var Re=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}Y(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Le(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(nt.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(dt);function Me(t){dt.call(this),this.b=t,this.a={}}pt(Me,dt);var Ue=[];function Ve(t,e,n,r){Array.isArray(n)||(n&&(Ue[0]=n.toString()),n=Ue);for(var i=0;i<n.length;i++){var o=ue(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function qe(t){jt(t.a,function(t,e){this.a.hasOwnProperty(e)&&fe(t)},t),t.a={}}function Fe(){this.a=!0}function Be(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Ie(n)}catch(u){return e}}(t,n)+(r?" "+r:"")})}Me.prototype.G=function(){Me.X.G.call(this),qe(this)},Me.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Fe.prototype.info=function(){};var ze={},Ge=null;function He(){return Ge=Ge||new be}function Ke(t){Xt.call(this,ze.Fa,t)}function Qe(t){var e=He();me(e,new Ke(e,t))}function Je(t,e){Xt.call(this,ze.STAT_EVENT,t),this.stat=e}function Xe(t){var e=He();me(e,new Je(e,t))}function We(t){Xt.call(this,ze.Ga,t)}function Ye(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return nt.setTimeout(function(){t()},e)}ze.Fa="serverreachability",pt(Ke,Xt),ze.STAT_EVENT="statevent",pt(Je,Xt),ze.Ga="timingevent",pt(We,Xt);var Ze={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},$e={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function tn(){}function en(){}tn.prototype.a=null;var nn,rn={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function on(){Xt.call(this,"d")}function sn(){Xt.call(this,"c")}function un(){}function an(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new Me(this),this.P=cn,this.R=new ke(t=Rt?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}pt(on,Xt),pt(sn,Xt),pt(un,tn),nn=new un;var cn=45e3,hn={},fn={};function ln(t,e,n){t.H=1,t.i=Cn(xn(e)),t.j=n,t.I=!0,pn(t,null)}function pn(t,e){t.u=lt(),yn(t),t.l=xn(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),Qn(n.b,"t",r),t.D=0,t.a=Fr(t.g,t.g.C?e:null),0<t.O&&(t.F=new Re(ht(t.Ca,t,t.a),t.O)),Ve(t.J,t.a,"readystatechange",t.Xa),e=t.B?St(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Qe(1),function(t,e,n,r,i,o){t.info(function(){if(t.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var f=h.split("_");s=2<=f.length&&"type"==f[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.c,t.m,t.l,t.f,t.S,t.j)}function dn(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=vn(t,n);if(i==fn){4==e&&(t.h=4,Xe(14),r=!1),Be(t.c,t.f,null,"[Incomplete Response]");break}if(i==hn){t.h=4,Xe(15),Be(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}Be(t.c,t.f,i,null),In(t,i)}4==e&&0==n.length&&(t.h=1,Xe(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Dr(e),e.F=!0,Xe(11))):(Be(t.c,t.f,n,"[Invalid Chunked Response]"),wn(t),mn(t))}function vn(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?fn:(n=Number(e.substring(n,r)),isNaN(n)?hn:(r+=1)+n>e.length?fn:(e=e.substr(r,n),t.D=r+n,e))}function yn(t){t.T=lt()+t.P,gn(t,t.P)}function gn(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ye(ht(t.Va,t),e)}function bn(t){t.o&&(nt.clearTimeout(t.o),t.o=null)}function mn(t){0==t.g.v||t.A||Rr(t.g,t)}function wn(t){bn(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,De(t.R),qe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function In(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||tr(n.b,t)))if(n.I=t.N,!t.C&&tr(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(Sp){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Lr(n),Or(n)}kr(n),Xe(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=Ye(ht(n.Sa,n),6e3));if(1>=$n(n.b)&&n.ea){try{n.ea()}catch(Sp){}n.ea=void 0}}else Ur(n,11)}else if((t.C||n.a==t)&&Lr(n),!mt(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(null!=u&&"number"==typeof u&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=a.b;!f.a&&(_t(h,"spdy")||_t(h,"quic")||_t(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(er(f,f.b),f.b=null))}if(a.A){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(a.na=l,Dn(a.B,a.A,l))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=lt()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((a=n).la=qr(a,a.C?a.ga:null,a.fa),p.C){nr(a.b,p);var d=p,v=a.D;v&&d.setTimeout(v),d.o&&(bn(d),yn(d)),a.a=p}else Pr(a);0<n.g.length&&Sr(n)}else"stop"!=i[0]&&"close"!=i[0]||Ur(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Ur(n,7):Er(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);Qe(4)}catch(Sp){}}function _n(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(it(t)||"string"==typeof t)yt(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(it(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(it(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function En(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof En)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function On(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Tn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Tn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Tn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}($=an.prototype).setTimeout=function(t){this.P=t},$.Xa=function(t){t=t.target;var e=this.F;e&&3==mr(t)?e.f():this.Ca(t)},$.Ca=function(t){try{if(t==this.a)t:{var e=mr(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!Rt&&!this.a.$())){this.A||4!=e||7==n||Qe(8==n||0>=r?3:2),bn(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!mt(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,Xe(12),wn(this),mn(this);break t}Be(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,In(this,a)}this.I?(dn(this,e,o),Rt&&this.b&&3==e&&(Ve(this.J,this.R,"tick",this.Wa),this.R.start())):(Be(this.c,this.f,o,null),In(this,o)),4==e&&wn(this),this.b&&!this.A&&(4==e?Rr(this.g,this):(this.b=!1,yn(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Xe(12)):(this.h=0,Xe(13)),wn(this),mn(this)}}}catch(c){}},$.Wa=function(){if(this.a){var t=mr(this.a),e=this.a.$();this.D<e.length&&(bn(this),dn(this,t,e),this.b&&4!=t&&yn(this))}},$.cancel=function(){this.A=!0,wn(this)},$.Va=function(){this.o=null;var t=lt();0<=t-this.T?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.c,this.l),2!=this.H&&(Qe(3),Xe(17)),wn(this),this.h=2,mn(this)):gn(this,this.T-t)},($=En.prototype).K=function(){On(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},$.L=function(){return On(this),this.a.concat()},$.get=function(t,e){return Tn(this.b,t)?this.b[t]:e},$.set=function(t,e){Tn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},$.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var jn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Sn(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Sn){this.a=void 0!==e?e:t.a,Nn(this,t.f),this.j=t.j,An(this,t.c),Pn(this,t.h),this.g=t.g,e=t.b;var n=new zn;n.c=e.c,e.a&&(n.a=new En(e.a),n.b=e.b),kn(this,n),this.i=t.i}else t&&(n=String(t).match(jn))?(this.a=!!e,Nn(this,n[1]||"",!0),this.j=Ln(n[2]||""),An(this,n[3]||"",!0),Pn(this,n[4]),this.g=Ln(n[5]||"",!0),kn(this,n[6]||"",!0),this.i=Ln(n[7]||"")):(this.a=!!e,this.b=new zn(null,this.a))}function xn(t){return new Sn(t)}function Nn(t,e,n){t.f=n?Ln(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function An(t,e,n){t.c=n?Ln(e,!0):e}function Pn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function kn(t,e,n){e instanceof zn?(t.b=e,function(t,e){e&&!t.f&&(Gn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Hn(this,e),Qn(this,n,t))},t)),t.f=e}(t.b,t.a)):(n||(e=Rn(e,Fn)),t.b=new zn(e,t.a))}function Dn(t,e,n){t.b.set(e,n)}function Cn(t){return Dn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^lt()).toString(36)),t}function Ln(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Rn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Mn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Mn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Sn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Rn(e,Un,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(Rn(e,Un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Rn(n,"/"==n.charAt(0)?qn:Vn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Rn(n,Bn)),t.join("")};var Un=/[#\/\?@]/g,Vn=/[#\?:]/g,qn=/[#\?]/g,Fn=/[#\?@]/g,Bn=/#/g;function zn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Gn(t){t.a||(t.a=new En,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function Hn(t,e){Gn(t),e=Jn(t,e),Tn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Tn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&On(t)))}function Kn(t,e){return Gn(t),e=Jn(t,e),Tn(t.a.b,e)}function Qn(t,e,n){Hn(t,e),0<n.length&&(t.c=null,t.a.set(Jn(t,e),bt(n)),t.b+=n.length)}function Jn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}($=zn.prototype).add=function(t,e){Gn(this),this.c=null,t=Jn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},$.forEach=function(t,e){Gn(this),this.a.forEach(function(n,r){yt(n,function(n){t.call(e,n,r,this)},this)},this)},$.L=function(){Gn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},$.K=function(t){Gn(this);var e=[];if("string"==typeof t)Kn(this,t)&&(e=gt(e,this.a.get(Jn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=gt(e,t[n])}return e},$.set=function(t,e){return Gn(this),this.c=null,Kn(this,t=Jn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},$.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},$.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var Xn=function(){return function(t,e){this.b=t,this.a=e}}();function Wn(t){this.g=t||Yn,t=nt.PerformanceNavigationTiming?0<(t=nt.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(nt.ia&&nt.ia.ya&&nt.ia.ya()&&nt.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var Yn=10;function Zn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function $n(t){return t.b?1:t.a?t.a.size:0}function tr(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function er(t,e){t.a?t.a.add(e):t.b=e}function nr(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function rr(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=Z(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return bt(t.c)}function ir(){}function or(){this.a=new ir}function sr(t,e,n){var r=n||"";try{_n(t,function(t,n){var i=t;ot(t)&&(i=Ie(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(vd){throw e.push(r+"type="+encodeURIComponent("_badmap")),vd}}function ur(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}Wn.prototype.cancel=function(){var t,e;if(this.c=rr(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=Z(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},ir.prototype.stringify=function(t){return nt.JSON.stringify(t,void 0)},ir.prototype.parse=function(t){return nt.JSON.parse(t,void 0)};var ar=nt.JSON.parse;function cr(t){be.call(this),this.headers=new En,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=hr,this.D=this.F=!1}pt(cr,be);var hr="",fr=/^https?$/i,lr=["POST","PUT"];function pr(t){return"content-type"==t.toLowerCase()}function dr(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,vr(t),gr(t)}function vr(t){t.u||(t.u=!0,me(t,"complete"),me(t,"error"))}function yr(t){if(t.b&&void 0!==et&&(!t.s[1]||4!=mr(t)||2!=t.W()))if(t.l&&4==mr(t))Ce(t.za,0,t);else if(me(t,"readystatechange"),4==mr(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(jn)[1]||null;if(!o&&nt.self&&nt.self.location){var s=nt.self.location.protocol;o=s.substr(0,s.length-1)}i=!fr.test(o?o.toLowerCase():"")}e=i}if(e)me(t,"complete"),me(t,"success");else{t.h=6;try{var u=2<mr(t)?t.a.statusText:""}catch(n){u=""}t.f=u+" ["+t.W()+"]",vr(t)}}finally{gr(t)}}}function gr(t,e){if(t.a){br(t);var n=t.a,r=t.s[0]?rt:null;t.a=null,t.s=null,e||me(t,"ready");try{n.onreadystatechange=r}catch(vd){}}}function br(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(nt.clearTimeout(t.m),t.m=null)}function mr(t){return t.a?t.a.readyState:0}function wr(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return jt(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Dn(t,e,n))}function Ir(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function _r(t){this.pa=0,this.g=[],this.c=new Fe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Ir("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Ir("baseRetryDelayMs",5e3,t),this.Ra=Ir("retryDelaySeedMs",1e4,t),this.Ma=Ir("forwardChannelMaxRetries",2,t),this.ma=Ir("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Wn(t&&t.concurrentRequestLimit),this.ka=new or,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Er(t){if(Tr(t),3==t.v){var e=t.R++,n=xn(t.B);Dn(n,"SID",t.J),Dn(n,"RID",e),Dn(n,"TYPE","terminate"),Nr(t,n),(e=new an(t,t.c,e,void 0)).H=2,e.i=Cn(xn(n)),n=!1,nt.navigator&&nt.navigator.sendBeacon&&(n=nt.navigator.sendBeacon(e.i.toString(),"")),!n&&nt.Image&&((new Image).src=e.i,n=!0),n||(e.a=Fr(e.g,null),e.a.ba(e.i)),e.u=lt(),yn(e)}Vr(t)}function Or(t){t.a&&(Dr(t),t.a.cancel(),t.a=null)}function Tr(t){Or(t),t.j&&(nt.clearTimeout(t.j),t.j=null),Lr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&nt.clearTimeout(t.h),t.h=null)}function jr(t,e){t.g.push(new Xn(t.Oa++,e)),3==t.v&&Sr(t)}function Sr(t){Zn(t.b)||t.h||(t.h=!0,xe(t.Ba,t),t.u=0)}function xr(t,e){var n;n=e?e.f:t.R++;var r=xn(t.B);Dn(r,"SID",t.J),Dn(r,"RID",n),Dn(r,"AID",t.P),Nr(t,r),t.i&&t.l&&wr(r,t.i,t.l),n=new an(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Ar(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),er(t.b,n),ln(n,r,e)}function Nr(t,e){t.f&&_n({},function(t,n){Dn(e,n,t)})}function Ar(t,e,n){n=Math.min(t.g.length,n);var r=t.f?ht(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].b)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(0>(c-=o))o=Math.max(0,i[a].b-100),u=!1;else try{sr(h,s,"req"+c+"_")}catch(Ei){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Pr(t){t.a||t.j||(t.T=1,xe(t.Aa,t),t.o=0)}function kr(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=Ye(ht(t.Aa,t),Mr(t,t.o)),t.o++,0))}function Dr(t){null!=t.s&&(nt.clearTimeout(t.s),t.s=null)}function Cr(t){t.a=new an(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=xn(t.la);Dn(e,"RID","rpc"),Dn(e,"SID",t.J),Dn(e,"CI",t.H?"0":"1"),Dn(e,"AID",t.P),Nr(t,e),Dn(e,"TYPE","xmlhttp"),t.i&&t.l&&wr(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Cn(xn(e)),n.j=null,n.I=!0,pn(n,t)}function Lr(t){null!=t.m&&(nt.clearTimeout(t.m),t.m=null)}function Rr(t,e){var n=null;if(t.a==e){Lr(t),Dr(t),t.a=null;var r=2}else{if(!tr(t.b,e))return;n=e.s,nr(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=lt()-e.u;var i=t.u;me(r=He(),new We(r,n,e,i)),Sr(t)}else Pr(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!($n(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=Ye(ht(t.Ba,t,e),Mr(t,t.u)),t.u++,0)))}(t,e)||2==r&&kr(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:Ur(t,5);break;case 4:Ur(t,10);break;case 3:Ur(t,6);break;default:Ur(t,2)}}function Mr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function Ur(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=ht(t.Ya,t);n||(n=new Sn("//www.google.com/images/cleardot.gif"),nt.location&&"http"==nt.location.protocol||Nn(n,"https"),Cn(n)),function(t,e){var n=new Fe;if(nt.Image){var r=new Image;r.onload=ft(ur,n,r,"TestLoadImage: loaded",!0,e),r.onerror=ft(ur,n,r,"TestLoadImage: error",!1,e),r.onabort=ft(ur,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=ft(ur,n,r,"TestLoadImage: timeout",!1,e),nt.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else Xe(2);t.v=0,t.f&&t.f.ra(e),Vr(t),Tr(t)}function Vr(t){t.v=0,t.I=-1,t.f&&(0==rr(t.b).length&&0==t.g.length||(t.b.c.length=0,bt(t.g),t.g.length=0),t.f.qa())}function qr(t,e,n){var r=function(t){return t instanceof Sn?xn(t):new Sn(t,void 0)}(n);if(""!=r.c)e&&An(r,e+"."+r.c),Pn(r,r.h);else{var i=nt.location;r=function(t,e,n,r){var i=new Sn(null,void 0);return t&&Nn(i,t),e&&An(i,e),n&&Pn(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&jt(t.V,function(t,e){Dn(r,e,t)}),n=t.na,(e=t.A)&&n&&Dn(r,e,n),Dn(r,"VER",t.ha),Nr(t,r),r}function Fr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new cr(t.Na)).F=t.C,e}function Br(){}function zr(){if(Ct&&!(10<=Number(Ht)))throw Error("Environmental error: no available transport.")}function Gr(t,e){be.call(this),this.a=new _r(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!mt(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!mt(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new Qr(this)}function Hr(t){on.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Kr(){sn.call(this),this.status=1}function Qr(t){this.a=t}($=cr.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(t){var e;return(e=t.a)||(e=t.a={}),e}(this.H?this.H:nn),this.a.onreadystatechange=ht(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void dr(this,o)}t=n||"";var i=new En(this.headers);r&&_n(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=pr,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=nt.FormData&&t instanceof nt.FormData,!(0<=vt(lr,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{br(this),0<this.o&&((this.D=function(t){return Ct&&Gt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=ht(this.xa,this)):this.m=Ce(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){dr(this,o)}},$.xa=function(){void 0!==et&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,me(this,"timeout"),this.abort(8))},$.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,me(this,"complete"),me(this,"abort"),gr(this))},$.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),gr(this,!0)),cr.X.G.call(this)},$.za=function(){this.j||(this.A||this.l||this.g?yr(this):this.Ua())},$.Ua=function(){yr(this)},$.W=function(){try{return 2<mr(this)?this.a.status:-1}catch(kt){return-1}},$.$=function(){try{return this.a?this.a.responseText:""}catch(kt){return""}},$.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),ar(e)}},$.ua=function(){return this.h},$.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},($=_r.prototype).ha=8,$.v=1,$.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new an(this,this.c,t,void 0),r=this.l;if(this.O&&(r?Nt(r=St(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Ar(this,n,e),Dn(i=xn(this.B),"RID",t),Dn(i,"CVER",22),this.A&&Dn(i,"X-HTTP-Session-Id",this.A),Nr(this,i),this.i&&r&&wr(i,this.i,r),er(this.b,n),this.Ia&&Dn(i,"TYPE","init"),this.da?(Dn(i,"$req",e),Dn(i,"SID","null"),n.U=!0,ln(n,i,null)):ln(n,i,e),this.v=2}}else 3==this.v&&(t?xr(this,t):0==this.g.length||Zn(this.b)||xr(this))},$.Aa=function(){if(this.j=null,Cr(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=Ye(ht(this.Ta,this),t)}},$.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Xe(10),Or(this),Cr(this))},$.Sa=function(){null!=this.m&&(this.m=null,Or(this),kr(this),Xe(19))},$.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),Xe(2)):(this.c.info("Failed to ping google.com"),Xe(1))},($=Br.prototype).ta=function(){},$.sa=function(){},$.ra=function(){},$.qa=function(){},$.Ja=function(){},zr.prototype.a=function(t,e){return new Gr(t,e)},pt(Gr,be),Gr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;Xe(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=qr(t,null,t.fa),Sr(t)},Gr.prototype.close=function(){Er(this.a)},Gr.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,jr(this.a,e)}else this.l?((e={}).__data__=Ie(t),jr(this.a,e)):jr(this.a,t)},Gr.prototype.G=function(){this.a.f=null,delete this.f,Er(this.a),delete this.a,Gr.X.G.call(this)},pt(Hr,on),pt(Kr,sn),pt(Qr,Br),Qr.prototype.ta=function(){me(this.a,"a")},Qr.prototype.sa=function(t){me(this.a,new Hr(t))},Qr.prototype.ra=function(t){me(this.a,new Kr(t))},Qr.prototype.qa=function(){me(this.a,"b")},zr.prototype.createWebChannel=zr.prototype.a,Gr.prototype.send=Gr.prototype.h,Gr.prototype.open=Gr.prototype.g,Gr.prototype.close=Gr.prototype.close,Ze.NO_ERROR=0,Ze.TIMEOUT=8,Ze.HTTP_ERROR=6,$e.COMPLETE="complete",en.EventType=rn,rn.OPEN="a",rn.CLOSE="b",rn.ERROR="c",rn.MESSAGE="d",be.prototype.listen=be.prototype.va,cr.prototype.listenOnce=cr.prototype.wa,cr.prototype.getLastError=cr.prototype.Qa,cr.prototype.getLastErrorCode=cr.prototype.ua,cr.prototype.getStatus=cr.prototype.W,cr.prototype.getResponseJson=cr.prototype.Pa,cr.prototype.getResponseText=cr.prototype.$,cr.prototype.send=cr.prototype.ba;var Jr=Ze,Xr=$e,Wr=ze,Yr=en,Zr=cr,$r=n("0RTl"),ti=new X.b("@firebase/firestore");function ei(){return ti.logLevel}function ni(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ti.logLevel<=X.a.DEBUG){var r=e.map(oi);ti.debug.apply(ti,Object($r.i)(["Firestore (8.2.4): "+t],r))}}function ri(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ti.logLevel<=X.a.ERROR){var r=e.map(oi);ti.error.apply(ti,Object($r.i)(["Firestore (8.2.4): "+t],r))}}function ii(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ti.logLevel<=X.a.WARN){var r=e.map(oi);ti.warn.apply(ti,Object($r.i)(["Firestore (8.2.4): "+t],r))}}function oi(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(vd){return t}}function si(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.2.4) INTERNAL ASSERTION FAILED: "+t;throw ri(e),new Error(e)}function ui(t,e){t||si()}function ai(t,e){return t}function ci(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var hi=function(){function t(){}return t.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=ci(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function fi(t,e){return t<e?-1:t>e?1:0}function li(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function pi(t){return t+"\0"}var di=function(){function t(t){this.i=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.i)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},t.prototype.o=function(){return 2*this.i.length},t.prototype.u=function(t){return fi(this.i,t.i)},t.prototype.isEqual=function(t){return this.i===t.i},t}();di.h=new di("");var vi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},yi=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object($r.d)(e,t),e}(Error),gi=function(){function t(t){this.l=t}return t.fromBase64String=function(e){try{return new t(di.fromBase64String(e))}catch(e){throw new yi(vi.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(di.fromUint8Array(e))},t.prototype.toBase64=function(){return this.l.toBase64()},t.prototype.toUint8Array=function(){return this.l.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.l.isEqual(t.l)},t}(),bi=function(t){this._=t};function mi(){if("undefined"==typeof Uint8Array)throw new yi(vi.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function wi(){if("undefined"==typeof atob)throw new yi(vi.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Ii=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object($r.d)(e,t),e.fromBase64String=function(t){return wi(),new e(gi.fromBase64String(t))},e.fromUint8Array=function(t){return mi(),new e(gi.fromUint8Array(t))},e.prototype.toBase64=function(){return wi(),this._.toBase64()},e.prototype.toUint8Array=function(){return mi(),this._.toUint8Array()},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(bi),_i=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.I=o},Ei=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"m",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Oi=function(){function t(t){this.uid=t}return t.prototype.A=function(){return null!=this.uid},t.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Oi.UNAUTHENTICATED=new Oi(null),Oi.P=new Oi("google-credentials-uid"),Oi.g=new Oi("first-party-uid");var Ti=function(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t},ji=function(){function t(){this.p=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.v=function(){},t.prototype.S=function(t){this.p=t,t(Oi.UNAUTHENTICATED)},t.prototype.D=function(){this.p=null},t}(),Si=function(){function t(t){var e=this;this.C=null,this.currentUser=Oi.UNAUTHENTICATED,this.N=!1,this.F=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.F++,e.currentUser=e.O(),e.N=!0,e.p&&e.p(e.currentUser)},this.F=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then(function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)},function(){}))}return t.prototype.getToken=function(){var t=this,e=this.F,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.F!==e?(ni("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(ui("string"==typeof n.accessToken),new Ti(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.v=function(){this.forceRefresh=!0},t.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},t.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},t.prototype.O=function(){var t=this.auth&&this.auth.getUid();return ui(null===t||"string"==typeof t),new Oi(t)},t}(),xi=function(){function t(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=Oi.g}return Object.defineProperty(t.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Ni=function(){function t(t,e){this.k=t,this.M=e}return t.prototype.getToken=function(){return Promise.resolve(new xi(this.k,this.M))},t.prototype.S=function(t){t(Oi.g)},t.prototype.D=function(){},t.prototype.v=function(){},t}(),Ai=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.L=function(t){return n.$(t)},this.B=function(t){return e.q(t)})}return t.prototype.$=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.B&&this.B(t),t},t}();Ai.U=-1;var Pi=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new yi(vi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new yi(vi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new yi(vi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new yi(vi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.K=function(t){return this.seconds===t.seconds?fi(this.nanoseconds,t.nanoseconds):fi(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),ki=function(){function t(t){this.timestamp=t}return t.W=function(e){return new t(e)},t.min=function(){return new t(new Pi(0,0))},t.prototype.u=function(t){return this.timestamp.K(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.j=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.G=function(){return this.timestamp},t}(),Di=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&si(),void 0===n?n=t.length-e:n>t.length-e&&si(),this.segments=t,this.offset=e,this.H=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.H},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.J(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.Y(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.X=function(t){return this.Y(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.Z=function(){return this.Y(this.segments,this.offset,this.length-1)},t.prototype.tt=function(){return this.segments[this.offset]},t.prototype.et=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.nt=function(){return 0===this.length},t.prototype.st=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.it=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.rt=function(){return this.segments.slice(this.offset,this.limit())},t.J=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Ci=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object($r.d)(e,t),e.prototype.Y=function(t,n,r){return new e(t,n,r)},e.prototype.ot=function(){return this.rt().join("/")},e.prototype.toString=function(){return this.ot()},e.ct=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new yi(vi.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.at=function(){return new e([])},e}(Di),Li=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ri=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object($r.d)(e,t),e.prototype.Y=function(t,n,r){return new e(t,n,r)},e.ut=function(t){return Li.test(t)},e.prototype.ot=function(){return this.rt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.ut(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.ot()},e.prototype.ht=function(){return 1===this.length&&"__name__"===this.get(0)},e.lt=function(){return new e(["__name__"])},e._t=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new yi(vi.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new yi(vi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new yi(vi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new yi(vi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.at=function(){return new e([])},e}(Di),Mi=function(){function t(t){this.path=t}return t.ft=function(e){return new t(Ci.ct(e))},t.dt=function(e){return new t(Ci.ct(e).X(5))},t.prototype.wt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Ci.J(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.J=function(t,e){return Ci.J(t.path,e.path)},t.Et=function(t){return t.length%2==0},t.Tt=function(e){return new t(new Ci(e.slice()))},t}();function Ui(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Vi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function qi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Fi=function(){function t(t){this.fields=t,t.sort(Ri.J)}return t.prototype.It=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].st(t))return!0;return!1},t.prototype.isEqual=function(t){return li(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),Bi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zi(t){if(ui(!!t),"string"==typeof t){var e=0,n=Bi.exec(t);if(ui(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Gi(t.seconds),nanos:Gi(t.nanos)}}function Gi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Hi(t){return"string"==typeof t?di.fromBase64String(t):di.fromUint8Array(t)}function Ki(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Qi(t){var e=t.mapValue.fields.__previous_value__;return Ki(e)?Qi(e):e}function Ji(t){var e=zi(t.mapValue.fields.__local_write_time__.timestampValue);return new Pi(e.seconds,e.nanos)}function Xi(t){return null==t}function Wi(t){return 0===t&&1/t==-1/0}function Yi(t){return"number"==typeof t&&Number.isInteger(t)&&!Wi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Zi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ki(t)?4:10:si()}function $i(t,e){var n=Zi(t);if(n!==Zi(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ji(t).isEqual(Ji(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=zi(t.timestampValue),r=zi(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Hi(t.bytesValue).isEqual(Hi(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Gi(t.geoPointValue.latitude)===Gi(e.geoPointValue.latitude)&&Gi(t.geoPointValue.longitude)===Gi(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Gi(t.integerValue)===Gi(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Gi(t.doubleValue),r=Gi(e.doubleValue);return n===r?Wi(n)===Wi(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return li(t.arrayValue.values||[],e.arrayValue.values||[],$i);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Ui(n)!==Ui(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!$i(n[i],r[i])))return!1;return!0}(t,e);default:return si()}}function to(t,e){return void 0!==(t.values||[]).find(function(t){return $i(t,e)})}function eo(t,e){var n=Zi(t),r=Zi(e);if(n!==r)return fi(n,r);switch(n){case 0:return 0;case 1:return fi(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Gi(t.integerValue||t.doubleValue),r=Gi(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return no(t.timestampValue,e.timestampValue);case 4:return no(Ji(t),Ji(e));case 5:return fi(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Hi(t),r=Hi(e);return n.u(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=fi(n[i],r[i]);if(0!==o)return o}return fi(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=fi(Gi(t.latitude),Gi(e.latitude));return 0!==n?n:fi(Gi(t.longitude),Gi(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=eo(n[i],r[i]);if(o)return o}return fi(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=fi(r[s],o[s]);if(0!==u)return u;var a=eo(n[r[s]],i[o[s]]);if(0!==a)return a}return fi(r.length,o.length)}(t.mapValue,e.mapValue);default:throw si()}}function no(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return fi(t,e);var n=zi(t),r=zi(e),i=fi(n.seconds,r.seconds);return 0!==i?i:fi(n.nanos,r.nanos)}function ro(t){return io(t)}function io(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=zi(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Hi(t.bytesValue).toBase64():"referenceValue"in t?Mi.dt(t.referenceValue).toString():"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=io(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+io(t.fields[o])}return e+"}"}(t.mapValue):si();var e}function oo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.ot()}}function so(t){return!!t&&"integerValue"in t}function uo(t){return!!t&&"arrayValue"in t}function ao(t){return!!t&&"nullValue"in t}function co(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ho(t){return!!t&&"mapValue"in t}var fo=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.nt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!ho(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.et()])||null},t.prototype.isEqual=function(t){return $i(this.proto,t.proto)},t}(),lo=function(){function t(t){void 0===t&&(t=fo.empty()),this.At=t,this.Rt=new Map}return t.prototype.set=function(t,e){return this.Pt(t,e),this},t.prototype.delete=function(t){return this.Pt(t,null),this},t.prototype.Pt=function(t,e){for(var n=this.Rt,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===Zi(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.et(),e)},t.prototype.yt=function(){var t=this.gt(Ri.at(),this.Rt);return null!=t?new fo(t):this.At},t.prototype.gt=function(t,e){var n=this,r=!1,i=this.At.field(t),o=ho(i)?Object.assign({},i.mapValue.fields):{};return e.forEach(function(e,i){if(e instanceof Map){var s=n.gt(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)}),r?{mapValue:{fields:o}}:null},t}();function po(t){var e=[];return Vi(t.fields||{},function(t,n){var r=new Ri([t]);if(ho(n)){var i=po(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)}),new Fi(e)}var vo=function(t,e){this.key=t,this.version=e},yo=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).Vt=r,o.bt=!!i.bt,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Object($r.d)(e,t),e.prototype.field=function(t){return this.Vt.field(t)},e.prototype.data=function(){return this.Vt},e.prototype.vt=function(){return this.Vt.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.bt===t.bt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Vt.isEqual(t.Vt)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Vt.toString()+", {hasLocalMutations: "+this.bt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.bt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(vo),go=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Object($r.d)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(vo),bo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object($r.d)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(vo),mo=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.St=null};function wo(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new mo(t,e,n,r,i,o,s)}function Io(t){var e=ai(t);if(null===e.St){var n=e.path.ot();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.ot()+t.op.toString()+ro(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.ot()+t.dir}(t)}).join(","),Xi(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Co(e.startAt)),e.endAt&&(n+="|ub:",n+=Co(e.endAt)),e.St=n}return e.St}function _o(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Ro(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!$i(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Uo(t.startAt,e.startAt)&&Uo(t.endAt,e.endAt)}function Eo(t){return Mi.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Oo=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object($r.d)(e,t),e.create=function(t,n,r){return t.ht()?"in"===n||"not-in"===n?this.Dt(t,n,r):new To(t,n,r):"array-contains"===n?new No(t,r):"in"===n?new Ao(t,r):"not-in"===n?new Po(t,r):"array-contains-any"===n?new ko(t,r):new e(t,n,r)},e.Dt=function(t,e,n){return"in"===e?new jo(t,n):new So(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Ct(eo(e,this.value)):null!==e&&Zi(this.value)===Zi(e)&&this.Ct(eo(e,this.value))},e.prototype.Ct=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return si()}},e.prototype.xt=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),To=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Mi.dt(r.referenceValue),i}return Object($r.d)(e,t),e.prototype.matches=function(t){var e=Mi.J(t.key,this.key);return this.Ct(e)},e}(Oo),jo=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=xo(0,n),r}return Object($r.d)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(Oo),So=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=xo(0,n),r}return Object($r.d)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(Oo);function xo(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return Mi.dt(t.referenceValue)})}var No=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object($r.d)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return uo(e)&&to(e.arrayValue,this.value)},e}(Oo),Ao=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object($r.d)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&to(this.value.arrayValue,e)},e}(Oo),Po=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object($r.d)(e,t),e.prototype.matches=function(t){if(to(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!to(this.value.arrayValue,e)},e}(Oo),ko=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object($r.d)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!uo(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return to(e.value.arrayValue,t)})},e}(Oo),Do=function(t,e){this.position=t,this.before=e};function Co(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return ro(t)}).join(",")}var Lo=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Ro(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Mo(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.ht()?Mi.J(Mi.dt(s.referenceValue),n.key):eo(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Uo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!$i(t.position[n],e.position[n]))return!1;return!0}var Vo=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Nt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Ft=null,this.Ot=null};function qo(t,e,n,r,i,o,s,u){return new Vo(t,e,n,r,i,o,s,u)}function Fo(t){return new Vo(t)}function Bo(t){return!Xi(t.limit)&&"F"===t.limitType}function zo(t){return!Xi(t.limit)&&"L"===t.limitType}function Go(t){return t.Nt.length>0?t.Nt[0].field:null}function Ho(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.xt())return r.field}return null}function Ko(t){return null!==t.collectionGroup}function Qo(t){var e=ai(t);if(null===e.Ft){e.Ft=[];var n=Ho(e),r=Go(e);if(null!==n&&null===r)n.ht()||e.Ft.push(new Lo(n)),e.Ft.push(new Lo(Ri.lt(),"asc"));else{for(var i=!1,o=0,s=e.Nt;o<s.length;o++){var u=s[o];e.Ft.push(u),u.field.ht()&&(i=!0)}if(!i){var a=e.Nt.length>0?e.Nt[e.Nt.length-1].dir:"asc";e.Ft.push(new Lo(Ri.lt(),a))}}}return e.Ft}function Jo(t){var e=ai(t);if(!e.Ot)if("F"===e.limitType)e.Ot=wo(e.path,e.collectionGroup,Qo(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Qo(e);r<i.length;r++){var o=i[r];n.push(new Lo(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new Do(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Do(e.startAt.position,!e.startAt.before):null;e.Ot=wo(e.path,e.collectionGroup,n,e.filters,e.limit,s,u)}return e.Ot}function Xo(t,e,n){return new Vo(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Wo(t,e){return _o(Jo(t),Jo(e))&&t.limitType===e.limitType}function Yo(t){return Io(Jo(t))+"|lt:"+t.limitType}function Zo(t){return"Query(target="+function(t){var e=t.path.ot();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.ot()+" "+e.op+" "+ro(e.value);var e}).join(", ")+"]"),Xi(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.ot()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Co(t.startAt)),t.endAt&&(e+=", endAt: "+Co(t.endAt)),"Target("+e+")"}(Jo(t))+"; limitType="+t.limitType+")"}function $o(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.wt(t.collectionGroup)&&t.path.st(n):Mi.Et(t.path)?t.path.isEqual(n):t.path.it(n)}(t,e)&&function(t,e){for(var n=0,r=t.Nt;n<r.length;n++){var i=r[n];if(!i.field.ht()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Mo(t.startAt,Qo(t),e)||t.endAt&&Mo(t.endAt,Qo(t),e))}(t,e)}function ts(t){return function(e,n){for(var r=!1,i=0,o=Qo(t);i<o.length;i++){var s=o[i],u=es(s,e,n);if(0!==u)return u;r=r||s.field.ht()}return 0}}function es(t,e,n){var r=t.field.ht()?Mi.J(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?eo(r,i):si()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return si()}}var ns=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=ki.min()),void 0===o&&(o=ki.min()),void 0===s&&(s=di.h),this.target=t,this.targetId=e,this.kt=n,this.sequenceNumber=r,this.Mt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.Lt=function(e){return new t(this.target,this.targetId,this.kt,e,this.Mt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.$t=function(e,n){return new t(this.target,this.targetId,this.kt,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Bt=function(e){return new t(this.target,this.targetId,this.kt,this.sequenceNumber,this.Mt,e,this.resumeToken)},t}();function rs(t,e){if(t.qt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Wi(e)?"-0":e}}function is(t){return{integerValue:""+t}}function os(t,e){return Yi(e)?is(e):rs(t,e)}var ss=function(){this.Ut=void 0};function us(t,e,n){return t instanceof hs?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof fs?ls(t,e):t instanceof ps?ds(t,e):function(t,e){var n=cs(t,e),r=ys(n)+ys(t.Qt);return so(n)&&so(t.Qt)?is(r):rs(t.Kt,r)}(t,e)}function as(t,e,n){return t instanceof fs?ls(t,e):t instanceof ps?ds(t,e):n}function cs(t,e){return t instanceof vs?so(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var hs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object($r.d)(e,t),e}(ss),fs=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object($r.d)(e,t),e}(ss);function ls(t,e){for(var n=gs(e),r=function(t){n.some(function(e){return $i(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ps=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object($r.d)(e,t),e}(ss);function ds(t,e){for(var n=gs(e),r=function(t){n=n.filter(function(e){return!$i(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var vs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Kt=e,r.Qt=n,r}return Object($r.d)(e,t),e}(ss);function ys(t){return Gi(t.integerValue||t.doubleValue)}function gs(t){return uo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var bs=function(t,e){this.field=t,this.transform=e},ms=function(t,e){this.version=t,this.transformResults=e},ws=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.Wt=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"jt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Is(t,e){return void 0!==t.updateTime?e instanceof yo&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof yo}var _s=function(){};function Es(t,e,n){return t instanceof xs?function(t,e,n){var r=t.value;if(n.transformResults){var i=Ps(t.fieldTransforms,e,n.transformResults);r=Ds(t.fieldTransforms,r,i)}return new yo(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Ns?function(t,e,n){if(!Is(t.Gt,e))return new bo(t.key,n.version);var r=As(t,e,n.transformResults?Ps(t.fieldTransforms,e,n.transformResults):[]);return new yo(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new go(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function Os(t,e,n,r){return t instanceof xs?function(t,e,n,r){if(!Is(t.Gt,e))return e;var i=t.value,o=ks(t.fieldTransforms,n,e);i=Ds(t.fieldTransforms,i,o);var s=Ss(e);return new yo(t.key,s,i,{bt:!0})}(t,e,r):t instanceof Ns?function(t,e,n,r){if(!Is(t.Gt,e))return e;var i=Ss(e),o=As(t,e,ks(t.fieldTransforms,n,e));return new yo(t.key,i,o,{bt:!0})}(t,e,r):function(t,e){return Is(t.Gt,e)?new go(t.key,ki.min()):e}(t,e)}function Ts(t,e){return function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof yo?e.field(o.field):void 0,u=cs(o.transform,s||null);null!=u&&(n=null==n?(new lo).set(o.field,u):n.set(o.field,u))}return n?n.yt():null}(t.fieldTransforms,e)}function js(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Gt.isEqual(e.Gt)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&li(t,e,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof fs&&e instanceof fs||t instanceof ps&&e instanceof ps?li(t.elements,e.elements,$i):t instanceof vs&&e instanceof vs?$i(t.Qt,e.Qt):t instanceof hs&&e instanceof hs}(t.transform,e.transform)}(t,e)})}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.zt.isEqual(e.zt))}function Ss(t){return t instanceof yo?t.version:ki.min()}var xs=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.Gt=r,o.fieldTransforms=i,o.type=0,o}return Object($r.d)(e,t),e}(_s),Ns=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.zt=r,s.Gt=i,s.fieldTransforms=o,s.type=1,s}return Object($r.d)(e,t),e}(_s);function As(t,e,n){var r;return r=function(t,e){var n=new lo(e);return t.zt.fields.forEach(function(e){if(!e.nt()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}}),n.yt()}(t,r=e instanceof yo?e.data():fo.empty()),Ds(t.fieldTransforms,r,n)}function Ps(t,e,n){var r=[];ui(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof yo&&(u=e.field(o.field)),r.push(as(s,u,n[i]))}return r}function ks(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof yo&&(c=n.field(u.field)),i.push(us(a,c,e))}return i}function Ds(t,e,n){for(var r=new lo(e),i=0;i<t.length;i++)r.set(t[i].field,n[i]);return r.yt()}var Cs,Ls,Rs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Gt=n,r.type=2,r.fieldTransforms=[],r}return Object($r.d)(e,t),e}(_s),Ms=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Gt=n,r.type=3,r.fieldTransforms=[],r}return Object($r.d)(e,t),e}(_s),Us=function(t){this.count=t};function Vs(t){switch(t){case vi.OK:return si();case vi.CANCELLED:case vi.UNKNOWN:case vi.DEADLINE_EXCEEDED:case vi.RESOURCE_EXHAUSTED:case vi.INTERNAL:case vi.UNAVAILABLE:case vi.UNAUTHENTICATED:return!1;case vi.INVALID_ARGUMENT:case vi.NOT_FOUND:case vi.ALREADY_EXISTS:case vi.PERMISSION_DENIED:case vi.FAILED_PRECONDITION:case vi.ABORTED:case vi.OUT_OF_RANGE:case vi.UNIMPLEMENTED:case vi.DATA_LOSS:return!0;default:return si()}}function qs(t){if(void 0===t)return ri("GRPC error has no .code"),vi.UNKNOWN;switch(t){case Cs.OK:return vi.OK;case Cs.CANCELLED:return vi.CANCELLED;case Cs.UNKNOWN:return vi.UNKNOWN;case Cs.DEADLINE_EXCEEDED:return vi.DEADLINE_EXCEEDED;case Cs.RESOURCE_EXHAUSTED:return vi.RESOURCE_EXHAUSTED;case Cs.INTERNAL:return vi.INTERNAL;case Cs.UNAVAILABLE:return vi.UNAVAILABLE;case Cs.UNAUTHENTICATED:return vi.UNAUTHENTICATED;case Cs.INVALID_ARGUMENT:return vi.INVALID_ARGUMENT;case Cs.NOT_FOUND:return vi.NOT_FOUND;case Cs.ALREADY_EXISTS:return vi.ALREADY_EXISTS;case Cs.PERMISSION_DENIED:return vi.PERMISSION_DENIED;case Cs.FAILED_PRECONDITION:return vi.FAILED_PRECONDITION;case Cs.ABORTED:return vi.ABORTED;case Cs.OUT_OF_RANGE:return vi.OUT_OF_RANGE;case Cs.UNIMPLEMENTED:return vi.UNIMPLEMENTED;case Cs.DATA_LOSS:return vi.DATA_LOSS;default:return si()}}(Ls=Cs||(Cs={}))[Ls.OK=0]="OK",Ls[Ls.CANCELLED=1]="CANCELLED",Ls[Ls.UNKNOWN=2]="UNKNOWN",Ls[Ls.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ls[Ls.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ls[Ls.NOT_FOUND=5]="NOT_FOUND",Ls[Ls.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ls[Ls.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ls[Ls.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ls[Ls.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ls[Ls.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ls[Ls.ABORTED=10]="ABORTED",Ls[Ls.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ls[Ls.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ls[Ls.INTERNAL=13]="INTERNAL",Ls[Ls.UNAVAILABLE=14]="UNAVAILABLE",Ls[Ls.DATA_LOSS=15]="DATA_LOSS";var Fs=function(){function t(t,e){this.J=t,this.root=e||zs.EMPTY}return t.prototype.Ht=function(e,n){return new t(this.J,this.root.Ht(e,n,this.J).copy(null,null,zs.Jt,null,null))},t.prototype.remove=function(e){return new t(this.J,this.root.remove(e,this.J).copy(null,null,zs.Jt,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.nt();){var n=this.J(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.nt();){var r=this.J(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.nt=function(){return this.root.nt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.Yt=function(){return this.root.Yt()},t.prototype.Xt=function(){return this.root.Xt()},t.prototype.Zt=function(t){return this.root.Zt(t)},t.prototype.forEach=function(t){this.Zt(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.Zt(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.te=function(t){return this.root.te(t)},t.prototype.ee=function(){return new Bs(this.root,null,this.J,!1)},t.prototype.ne=function(t){return new Bs(this.root,t,this.J,!1)},t.prototype.se=function(){return new Bs(this.root,null,this.J,!0)},t.prototype.ie=function(t){return new Bs(this.root,t,this.J,!0)},t}(),Bs=function(){function t(t,e,n,r){this.re=r,this.oe=[];for(var i=1;!t.nt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.re?t.left:t.right;else{if(0===i){this.oe.push(t);break}this.oe.push(t),t=this.re?t.right:t.left}}return t.prototype.ce=function(){var t=this.oe.pop(),e={key:t.key,value:t.value};if(this.re)for(t=t.left;!t.nt();)this.oe.push(t),t=t.right;else for(t=t.right;!t.nt();)this.oe.push(t),t=t.left;return e},t.prototype.ae=function(){return this.oe.length>0},t.prototype.ue=function(){if(0===this.oe.length)return null;var t=this.oe[this.oe.length-1];return{key:t.key,value:t.value}},t}(),zs=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.nt=function(){return!1},t.prototype.Zt=function(t){return this.left.Zt(t)||t(this.key,this.value)||this.right.Zt(t)},t.prototype.te=function(t){return this.right.te(t)||t(this.key,this.value)||this.left.te(t)},t.prototype.min=function(){return this.left.nt()?this:this.left.min()},t.prototype.Yt=function(){return this.min().key},t.prototype.Xt=function(){return this.right.nt()?this.key:this.right.Xt()},t.prototype.Ht=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ht(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ht(t,e,n))).he()},t.prototype.le=function(){if(this.left.nt())return t.EMPTY;var e=this;return e.left._e()||e.left.left._e()||(e=e.fe()),(e=e.copy(null,null,null,e.left.le(),null)).he()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.nt()||i.left._e()||i.left.left._e()||(i=i.fe()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left._e()&&(i=i.de()),i.right.nt()||i.right._e()||i.right.left._e()||(i=i.we()),0===n(e,i.key)){if(i.right.nt())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.le())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.he()},t.prototype._e=function(){return this.color},t.prototype.he=function(){var t=this;return t.right._e()&&!t.left._e()&&(t=t.Ee()),t.left._e()&&t.left.left._e()&&(t=t.de()),t.left._e()&&t.right._e()&&(t=t.Te()),t},t.prototype.fe=function(){var t=this.Te();return t.right.left._e()&&(t=(t=(t=t.copy(null,null,null,null,t.right.de())).Ee()).Te()),t},t.prototype.we=function(){var t=this.Te();return t.left.left._e()&&(t=(t=t.de()).Te()),t},t.prototype.Ee=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.de=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Te=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ie=function(){var t=this.me();return Math.pow(2,t)<=this.size+1},t.prototype.me=function(){if(this._e()&&this.left._e())throw si();if(this.right._e())throw si();var t=this.left.me();if(t!==this.right.me())throw si();return t+(this._e()?0:1)},t}();zs.EMPTY=null,zs.RED=!0,zs.Jt=!1,zs.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw si()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw si()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw si()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw si()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw si()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.Ht=function(t,e,n){return new zs(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.nt=function(){return!0},t.prototype.Zt=function(t){return!1},t.prototype.te=function(t){return!1},t.prototype.Yt=function(){return null},t.prototype.Xt=function(){return null},t.prototype._e=function(){return!1},t.prototype.Ie=function(){return!0},t.prototype.me=function(){return 0},t}());var Gs=function(){function t(t){this.J=t,this.data=new Fs(this.J)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.Yt()},t.prototype.last=function(){return this.data.Xt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Zt(function(e,n){return t(e),!1})},t.prototype.Ae=function(t,e){for(var n=this.data.ne(t[0]);n.ae();){var r=n.ce();if(this.J(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Re=function(t,e){var n;for(n=void 0!==e?this.data.ne(e):this.data.ee();n.ae();)if(!t(n.ce().key))return},t.prototype.Pe=function(t){var e=this.data.ne(t);return e.ae()?e.ce().key:null},t.prototype.ee=function(){return new Hs(this.data.ee())},t.prototype.ne=function(t){return new Hs(this.data.ne(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).Ht(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.nt=function(){return this.data.nt()},t.prototype.ye=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.ee(),r=e.data.ee();n.ae();){var i=n.ce().key,o=r.ce().key;if(0!==this.J(i,o))return!1}return!0},t.prototype.rt=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.J);return n.data=e,n},t}(),Hs=function(){function t(t){this.ge=t}return t.prototype.ce=function(){return this.ge.ce().key},t.prototype.ae=function(){return this.ge.ae()},t}(),Ks=new Fs(Mi.J);function Qs(){return Ks}function Js(){return Qs()}var Xs=new Fs(Mi.J);function Ws(){return Xs}var Ys=new Fs(Mi.J);function Zs(){return Ys}var $s=new Gs(Mi.J);function tu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=$s,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var eu=new Gs(fi);function nu(){return eu}var ru=function(){function t(t){this.J=t?function(e,n){return t(e,n)||Mi.J(e.key,n.key)}:function(t,e){return Mi.J(t.key,e.key)},this.Ve=Ws(),this.pe=new Fs(this.J)}return t.be=function(e){return new t(e.J)},t.prototype.has=function(t){return null!=this.Ve.get(t)},t.prototype.get=function(t){return this.Ve.get(t)},t.prototype.first=function(){return this.pe.Yt()},t.prototype.last=function(){return this.pe.Xt()},t.prototype.nt=function(){return this.pe.nt()},t.prototype.indexOf=function(t){var e=this.Ve.get(t);return e?this.pe.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.pe.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.pe.Zt(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ve.Ht(t.key,t),e.pe.Ht(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ve.remove(t),this.pe.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.pe.ee(),r=e.pe.ee();n.ae();){var i=n.ce().key,o=r.ce().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.J=this.J,r.Ve=e,r.pe=n,r},t}(),iu=function(){function t(){this.ve=new Fs(Mi.J)}return t.prototype.track=function(t){var e=t.doc.key,n=this.ve.get(e);n?0!==t.type&&3===n.type?this.ve=this.ve.Ht(e,t):3===t.type&&1!==n.type?this.ve=this.ve.Ht(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ve=this.ve.Ht(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ve=this.ve.remove(e):1===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):si():this.ve=this.ve.Ht(e,t)},t.prototype.Se=function(){var t=[];return this.ve.Zt(function(e,n){t.push(n)}),t},t}(),ou=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.De=n,this.docChanges=r,this.Ce=i,this.fromCache=o,this.xe=s,this.Ne=u}return t.Fe=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,ru.be(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Ce.nt()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.xe===t.xe&&this.Ce.isEqual(t.Ce)&&Wo(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.De.isEqual(t.De)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),su=function(){function t(t,e,n,r,i){this.Mt=t,this.Oe=e,this.ke=n,this.Me=r,this.Le=i}return t.$e=function(e,n){var r=new Map;return r.set(e,uu.Be(e,n)),new t(ki.min(),r,nu(),Qs(),tu())},t}(),uu=function(){function t(t,e,n,r,i){this.resumeToken=t,this.qe=e,this.Ue=n,this.Qe=r,this.Ke=i}return t.Be=function(e,n){return new t(di.h,n,tu(),tu(),tu())},t}(),au=function(t,e,n,r){this.We=t,this.removedTargetIds=e,this.key=n,this.je=r},cu=function(t,e){this.targetId=t,this.Ge=e},hu=function(t,e,n,r){void 0===n&&(n=di.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},fu=function(){function t(){this.ze=0,this.He=du(),this.Je=di.h,this.Ye=!1,this.Xe=!0}return Object.defineProperty(t.prototype,"qe",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Ze",{get:function(){return 0!==this.ze},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tn",{get:function(){return this.Xe},enumerable:!1,configurable:!0}),t.prototype.en=function(t){t.o()>0&&(this.Xe=!0,this.Je=t)},t.prototype.nn=function(){var t=tu(),e=tu(),n=tu();return this.He.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:si()}}),new uu(this.Je,this.Ye,t,e,n)},t.prototype.sn=function(){this.Xe=!1,this.He=du()},t.prototype.rn=function(t,e){this.Xe=!0,this.He=this.He.Ht(t,e)},t.prototype.on=function(t){this.Xe=!0,this.He=this.He.remove(t)},t.prototype.cn=function(){this.ze+=1},t.prototype.an=function(){this.ze-=1},t.prototype.un=function(){this.Xe=!0,this.Ye=!0},t}(),lu=function(){function t(t){this.hn=t,this.ln=new Map,this._n=Qs(),this.fn=pu(),this.dn=new Gs(fi)}return t.prototype.wn=function(t){for(var e=0,n=t.We;e<n.length;e++){var r=n[e];t.je instanceof yo?this.En(r,t.je):t.je instanceof go&&this.Tn(r,t.key,t.je)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.Tn(r=o[i],t.key,t.je)},t.prototype.In=function(t){var e=this;this.mn(t,function(n){var r=e.An(n);switch(t.state){case 0:e.Rn(n)&&r.en(t.resumeToken);break;case 1:r.an(),r.Ze||r.sn(),r.en(t.resumeToken);break;case 2:r.an(),r.Ze||e.removeTarget(n);break;case 3:e.Rn(n)&&(r.un(),r.en(t.resumeToken));break;case 4:e.Rn(n)&&(e.Pn(n),r.en(t.resumeToken));break;default:si()}})},t.prototype.mn=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.ln.forEach(function(t,r){n.Rn(r)&&e(r)})},t.prototype.yn=function(t){var e=t.targetId,n=t.Ge.count,r=this.gn(e);if(r){var i=r.target;if(Eo(i))if(0===n){var o=new Mi(i.path);this.Tn(e,o,new go(o,ki.min()))}else ui(1===n);else this.Vn(e)!==n&&(this.Pn(e),this.dn=this.dn.add(e))}},t.prototype.pn=function(t){var e=this,n=new Map;this.ln.forEach(function(r,i){var o=e.gn(i);if(o){if(r.qe&&Eo(o.target)){var s=new Mi(o.target.path);null!==e._n.get(s)||e.bn(i,s)||e.Tn(i,s,new go(s,t))}r.tn&&(n.set(i,r.nn()),r.sn())}});var r=tu();this.fn.forEach(function(t,n){var i=!0;n.Re(function(t){var n=e.gn(t);return!n||2===n.kt||(i=!1,!1)}),i&&(r=r.add(t))});var i=new su(t,n,this.dn,this._n,r);return this._n=Qs(),this.fn=pu(),this.dn=new Gs(fi),i},t.prototype.En=function(t,e){if(this.Rn(t)){var n=this.bn(t,e.key)?2:0;this.An(t).rn(e.key,n),this._n=this._n.Ht(e.key,e),this.fn=this.fn.Ht(e.key,this.vn(e.key).add(t))}},t.prototype.Tn=function(t,e,n){if(this.Rn(t)){var r=this.An(t);this.bn(t,e)?r.rn(e,1):r.on(e),this.fn=this.fn.Ht(e,this.vn(e).delete(t)),n&&(this._n=this._n.Ht(e,n))}},t.prototype.removeTarget=function(t){this.ln.delete(t)},t.prototype.Vn=function(t){var e=this.An(t).nn();return this.hn.Sn(t).size+e.Ue.size-e.Ke.size},t.prototype.cn=function(t){this.An(t).cn()},t.prototype.An=function(t){var e=this.ln.get(t);return e||(e=new fu,this.ln.set(t,e)),e},t.prototype.vn=function(t){var e=this.fn.get(t);return e||(e=new Gs(fi),this.fn=this.fn.Ht(t,e)),e},t.prototype.Rn=function(t){var e=null!==this.gn(t);return e||ni("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.gn=function(t){var e=this.ln.get(t);return e&&e.Ze?null:this.hn.Dn(t)},t.prototype.Pn=function(t){var e=this;this.ln.set(t,new fu),this.hn.Sn(t).forEach(function(n){e.Tn(t,n,null)})},t.prototype.bn=function(t,e){return this.hn.Sn(t).has(e)},t}();function pu(){return new Fs(Mi.J)}function du(){return new Fs(Mi.J)}var vu={asc:"ASCENDING",desc:"DESCENDING"},yu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},gu=function(t,e){this.T=t,this.qt=e};function bu(t,e){return t.qt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function mu(t,e){return t.qt?e.toBase64():e.toUint8Array()}function wu(t,e){return bu(t,e.G())}function Iu(t){return ui(!!t),ki.W(function(t){var e=zi(t);return new Pi(e.seconds,e.nanos)}(t))}function _u(t,e){return function(t){return new Ci(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).ot()}function Eu(t){var e=Ci.ct(t);return ui(Qu(e)),e}function Ou(t,e){return _u(t.T,e.path)}function Tu(t,e){var n=Eu(e);if(n.get(1)!==t.T.projectId)throw new yi(vi.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.T.projectId);if(n.get(3)!==t.T.database)throw new yi(vi.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.T.database);return new Mi(Nu(n))}function ju(t,e){return _u(t.T,e)}function Su(t){var e=Eu(t);return 4===e.length?Ci.at():Nu(e)}function xu(t){return new Ci(["projects",t.T.projectId,"databases",t.T.database]).ot()}function Nu(t){return ui(t.length>4&&"documents"===t.get(4)),t.X(5)}function Au(t,e,n){return{name:Ou(t,e),fields:n.proto.mapValue.fields}}function Pu(t,e,n){var r=Tu(t,e.name),i=Iu(e.updateTime),o=new fo({mapValue:{fields:e.fields}});return new yo(r,i,o,{hasCommittedMutations:!!n})}function ku(t,e){var n;if(e instanceof xs)n={update:Au(t,e.key,e.value)};else if(e instanceof Rs)n={delete:Ou(t,e.key)};else if(e instanceof Ns)n={update:Au(t,e.key,e.data),updateMask:Ku(e.zt)};else{if(!(e instanceof Ms))return si();n={verify:Ou(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof hs)return{fieldPath:e.field.ot(),setToServerValue:"REQUEST_TIME"};if(n instanceof fs)return{fieldPath:e.field.ot(),appendMissingElements:{values:n.elements}};if(n instanceof ps)return{fieldPath:e.field.ot(),removeAllFromArray:{values:n.elements}};if(n instanceof vs)return{fieldPath:e.field.ot(),increment:n.Qt};throw si()}(0,t)})),e.Gt.jt||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:wu(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:si()}(t,e.Gt)),n}function Du(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?ws.updateTime(Iu(t.updateTime)):void 0!==t.exists?ws.exists(t.exists):ws.Wt()}(e.currentDocument):ws.Wt(),r=e.updateTransforms?e.updateTransforms.map(function(e){return function(t,e){var n=null;"setToServerValue"in e?(ui("REQUEST_TIME"===e.setToServerValue),n=new hs):"appendMissingElements"in e?n=new fs(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new ps(e.removeAllFromArray.values||[]):"increment"in e?n=new vs(t,e.increment):si();var r=Ri._t(e.fieldPath);return new bs(r,n)}(t,e)}):[];if(e.update){var i=Tu(t,e.update.name),o=new fo({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){return new Fi((t.fieldPaths||[]).map(function(t){return Ri._t(t)}))}(e.updateMask);return new Ns(i,o,s,n,r)}return new xs(i,o,n,r)}if(e.delete){var u=Tu(t,e.delete);return new Rs(u,n)}if(e.verify){var a=Tu(t,e.verify);return new Ms(a,n)}return si()}function Cu(t,e){return{documents:[ju(t,e.path)]}}function Lu(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=ju(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ju(t,r.Z()),n.structuredQuery.from=[{collectionId:r.et()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(co(t.value))return{unaryFilter:{field:Bu(t.field),op:"IS_NAN"}};if(ao(t.value))return{unaryFilter:{field:Bu(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(co(t.value))return{unaryFilter:{field:Bu(t.field),op:"IS_NOT_NAN"}};if(ao(t.value))return{unaryFilter:{field:Bu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Bu(t.field),op:Fu(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:Bu(t.field),direction:qu(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.qt||Xi(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=Uu(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Uu(e.endAt)),n}function Ru(t){var e=Su(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){ui(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=Mu(n.where));var u=[];n.orderBy&&(u=n.orderBy.map(function(t){return function(t){return new Lo(zu(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var a=null;n.limit&&(a=function(t){var e;return Xi(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Vu(n.startAt));var h=null;return n.endAt&&(h=Vu(n.endAt)),qo(e,i,u,s,a,"F",c,h)}function Mu(t){return t?void 0!==t.unaryFilter?[Hu(t)]:void 0!==t.fieldFilter?[Gu(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return Mu(t)}).reduce(function(t,e){return t.concat(e)}):si():[]}function Uu(t){return{before:t.before,values:t.position}}function Vu(t){return new Do(t.values||[],!!t.before)}function qu(t){return vu[t]}function Fu(t){return yu[t]}function Bu(t){return{fieldPath:t.ot()}}function zu(t){return Ri._t(t.fieldPath)}function Gu(t){return Oo.create(zu(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return si()}}(t.fieldFilter.op),t.fieldFilter.value)}function Hu(t){switch(t.unaryFilter.op){case"IS_NAN":var e=zu(t.unaryFilter.field);return Oo.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=zu(t.unaryFilter.field);return Oo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=zu(t.unaryFilter.field);return Oo.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=zu(t.unaryFilter.field);return Oo.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return si()}}function Ku(t){var e=[];return t.fields.forEach(function(t){return e.push(t.ot())}),{fieldPaths:e}}function Qu(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var Ju=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},Xu=function(){function t(t){var e=this;this.Cn=null,this.xn=null,this.result=void 0,this.error=void 0,this.Nn=!1,this.Fn=!1,t(function(t){e.Nn=!0,e.result=t,e.Cn&&e.Cn(t)},function(t){e.Nn=!0,e.error=t,e.xn&&e.xn(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Fn&&si(),this.Fn=!0,this.Nn?this.error?this.On(n,this.error):this.kn(e,this.result):new t(function(t,i){r.Cn=function(n){r.kn(e,n).next(t,i)},r.xn=function(e){r.On(n,e).next(t,i)}})},t.prototype.Mn=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.Ln=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.kn=function(e,n){return e?this.Ln(function(){return e(n)}):t.resolve(n)},t.prototype.On=function(e,n){return e?this.Ln(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.$n=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.Bn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.$n(r)},t}(),Wu=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.qn=new Ju,this.transaction.oncomplete=function(){n.qn.resolve()},this.transaction.onabort=function(){e.error?n.qn.reject(new $u(t,e.error)):n.qn.resolve()},this.transaction.onerror=function(e){var r=ia(e.target.error);n.qn.reject(new $u(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new $u(n,e)}},Object.defineProperty(t.prototype,"Un",{get:function(){return this.qn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.qn.reject(t),this.aborted||(ni("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new ea(e)},t}(),Yu=function(){function t(e,n,r){this.name=e,this.version=n,this.Qn=r,12.2===t.Kn(Object(W.m)())&&ri("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return ni("SimpleDb","Removing database:",t),na(window.indexedDB.deleteDatabase(t)).Mn()},t.Wn=function(){if("undefined"==typeof indexedDB)return!1;if(t.jn())return!0;var e=Object(W.m)(),n=t.Kn(e),r=0<n&&n<10,i=t.Gn(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.jn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.zn)},t.Hn=function(t,e){return t.store(e)},t.Kn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Gn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Jn=function(t){return Object($r.b)(this,void 0,void 0,function(){var e,n=this;return Object($r.e)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(ni("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new $u(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new yi(vi.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new $u(t,n))},i.onupgradeneeded=function(t){ni("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.Qn.Yn(t.target.result,i.transaction,t.oldVersion,n.version).next(function(){ni("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Xn&&(this.db.onversionchange=function(t){return n.Xn(t)}),this.db)]}})})},t.prototype.Zn=function(t){this.Xn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object($r.b)(this,void 0,void 0,function(){var i,o,s,u,a;return Object($r.e)(this,function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,a,c,h;return Object($r.e)(this,function(f){switch(f.label){case 0:++o,f.label=1;case 1:return f.trys.push([1,4,,5]),[4,u.Jn(t)];case 2:return u.db=f.sent(),e=Wu.open(u.db,t,i?"readonly":"readwrite",n),s=r(e).catch(function(t){return e.abort(t),Xu.reject(t)}).Mn(),a={},s.catch(function(){}),[4,e.Un];case 3:return[2,(a.value=(f.sent(),s),a)];case 4:return ni("SimpleDb","Transaction failed with error:",(c=f.sent()).message,"Retrying:",h="FirebaseError"!==c.name&&o<3),u.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},u=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(a=c.sent()))return[2,a.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Zu=function(){function t(t){this.ts=t,this.es=!1,this.ns=null}return Object.defineProperty(t.prototype,"Nn",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ss",{get:function(){return this.ns},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.ts=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.es=!0},t.prototype.rs=function(t){this.ns=t},t.prototype.delete=function(){return na(this.ts.delete())},t}(),$u=function(t){function e(e,n){var r=this;return(r=t.call(this,vi.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object($r.d)(e,t),e}(yi);function ta(t){return"IndexedDbTransactionError"===t.name}var ea=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(ni("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(ni("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),na(n)},t.prototype.add=function(t){return ni("SimpleDb","ADD",this.store.name,t,t),na(this.store.add(t))},t.prototype.get=function(t){var e=this;return na(this.store.get(t)).next(function(n){return void 0===n&&(n=null),ni("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return ni("SimpleDb","DELETE",this.store.name,t),na(this.store.delete(t))},t.prototype.count=function(){return ni("SimpleDb","COUNT",this.store.name),na(this.store.count())},t.prototype.os=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.cs(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.us=function(t,e){ni("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.hs=!1;var r=this.cursor(n);return this.cs(r,function(t,e,n){return n.delete()})},t.prototype.ls=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.cs(r,e)},t.prototype._s=function(t){var e=this.cursor({});return new Xu(function(n,r){e.onerror=function(t){var e=ia(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.cs=function(t,e){var n=[];return new Xu(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Zu(i),s=e(i.primaryKey,i.value,o);if(s instanceof Xu){var u=s.catch(function(t){return o.done(),Xu.reject(t)});n.push(u)}o.Nn?r():null===o.ss?i.continue():i.continue(o.ss)}else r()}}).next(function(){return Xu.$n(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.hs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function na(t){return new Xu(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=ia(t.target.error);n(e)}})}var ra=!1;function ia(t){var e=Yu.Kn(Object(W.m)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new yi("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ra||(ra=!0,setTimeout(function(){throw r},0)),r}}return t}var oa=function(){function t(t,e,n,r,i){this.fs=t,this.ds=e,this.ws=n,this.op=r,this.Es=i,this.Ts=new Ju,this.then=this.Ts.promise.then.bind(this.Ts.promise),this.Ts.promise.catch(function(t){})}return t.Is=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.As=setTimeout(function(){return e.Rs()},t)},t.prototype.Ps=function(){return this.Rs()},t.prototype.cancel=function(t){null!==this.As&&(this.clearTimeout(),this.Ts.reject(new yi(vi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Rs=function(){var t=this;this.fs.ys(function(){return null!==t.As?(t.clearTimeout(),t.op().then(function(e){return t.Ts.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.As&&(this.Es(this),clearTimeout(this.As),this.As=null)},t}();function sa(t,e){if(ri("AsyncQueue",e+": "+t),ta(t))return new yi(vi.UNAVAILABLE,e+": "+t);throw t}var ua="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",aa=function(){function t(){this.gs=[]}return t.prototype.Vs=function(t){this.gs.push(t)},t.prototype.ps=function(){this.gs.forEach(function(t){return t()})},t}();function ca(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=fa(e)),e=ha(t.get(n),e);return fa(e)}function ha(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function fa(t){return t+"\x01\x01"}function la(t){var e=t.length;if(ui(e>=2),2===e)return ui("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),Ci.at();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&si(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:si()}o=s+2}return new Ci(r)}var pa=function(t,e){this.seconds=t,this.nanoseconds=e},da=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};da.store="owner",da.key="owner";var va=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};va.store="mutationQueues",va.keyPath="userId";var ya=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};ya.store="mutations",ya.keyPath="batchId",ya.userMutationsIndex="userMutationsIndex",ya.userMutationsKeyPath=["userId","batchId"];var ga=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,ca(e)]},t.key=function(t,e,n){return[t,ca(e),n]},t}();ga.store="documentMutations",ga.PLACEHOLDER=new ga;var ba=function(t,e){this.path=t,this.readTime=e},ma=function(t,e){this.path=t,this.version=e},wa=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};wa.store="remoteDocuments",wa.readTimeIndex="readTimeIndex",wa.readTimeIndexPath="readTime",wa.collectionReadTimeIndex="collectionReadTimeIndex",wa.collectionReadTimeIndexPath=["parentPath","readTime"];var Ia=function(t){this.byteSize=t};Ia.store="remoteDocumentGlobal",Ia.key="remoteDocumentGlobalKey";var _a=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};_a.store="targets",_a.keyPath="targetId",_a.queryTargetsIndexName="queryTargetsIndex",_a.queryTargetsKeyPath=["canonicalId","targetId"];var Ea=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ea.store="targetDocuments",Ea.keyPath=["targetId","path"],Ea.documentTargetsIndex="documentTargetsIndex",Ea.documentTargetsKeyPath=["path","targetId"];var Oa=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Oa.key="targetGlobalKey",Oa.store="targetGlobal";var Ta=function(t,e){this.collectionId=t,this.parent=e};Ta.store="collectionParents",Ta.keyPath=["collectionId","parent"];var ja=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};ja.store="clientMetadata",ja.keyPath="clientId";var Sa=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Sa.store="bundles",Sa.keyPath="bundleId";var xa=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};xa.store="namedQueries",xa.keyPath="name";var Na=Object($r.i)(Object($r.i)(Object($r.i)(Object($r.i)([va.store,ya.store,ga.store,wa.store,_a.store,da.store,Oa.store,Ea.store],[ja.store]),[Ia.store]),[Ta.store]),[Sa.store,xa.store]),Aa=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).bs=e,r.vs=n,r}return Object($r.d)(e,t),e}(aa);function Pa(t,e){var n=ai(t);return Yu.Hn(n.bs,e)}var ka=function(){function t(t,e,n,r){this.batchId=t,this.Ss=e,this.baseMutations=n,this.mutations=r}return t.prototype.Ds=function(t,e,n){for(var r=n.Cs,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Es(o,e,r[i]))}return e},t.prototype.xs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(s=r[n]).key.isEqual(t)&&(e=Os(s,e,0,this.Ss));for(var i=0,o=this.mutations;i<o.length;i++){var s;(s=o[i]).key.isEqual(t)&&(e=Os(s,e,0,this.Ss))}return e},t.prototype.Ns=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.xs(r.key,t.get(r.key));i&&(n=n.Ht(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},tu())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&li(this.mutations,t.mutations,function(t,e){return js(t,e)})&&li(this.baseMutations,t.baseMutations,function(t,e){return js(t,e)})},t}(),Da=function(){function t(t,e,n,r){this.batch=t,this.Fs=e,this.Cs=n,this.Os=r}return t.from=function(e,n,r){ui(e.mutations.length===r.length);for(var i=Zs(),o=e.mutations,s=0;s<o.length;s++)i=i.Ht(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Ca=function(t){this.ks=t};function La(t,e){if(e.document)return Pu(t.ks,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Mi.Tt(e.noDocument.path),r=qa(e.noDocument.readTime);return new go(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=Mi.Tt(e.unknownDocument.path);return r=qa(e.unknownDocument.version),new bo(i,r)}return si()}function Ra(t,e,n){var r=Ma(n),i=e.key.path.Z().rt();if(e instanceof yo){var o=function(t,e){return{name:Ou(t,e.key),fields:e.vt().mapValue.fields,updateTime:bu(t,e.version.G())}}(t.ks,e),s=e.hasCommittedMutations;return new wa(null,null,o,s,r,i)}if(e instanceof go){var u=e.key.path.rt(),a=Va(e.version);return s=e.hasCommittedMutations,new wa(null,new ba(u,a),null,s,r,i)}if(e instanceof bo){var c=e.key.path.rt(),h=Va(e.version);return new wa(new ma(c,h),null,null,!0,r,i)}return si()}function Ma(t){var e=t.G();return[e.seconds,e.nanoseconds]}function Ua(t){var e=new Pi(t[0],t[1]);return ki.W(e)}function Va(t){var e=t.G();return new pa(e.seconds,e.nanoseconds)}function qa(t){var e=new Pi(t.seconds,t.nanoseconds);return ki.W(e)}function Fa(t,e){for(var n=(e.baseMutations||[]).map(function(e){return Du(t.ks,e)}),r=e.mutations.length-1;r>=0;--r){var i=e.mutations[r];void 0!==(null==i?void 0:i.transform)&&(e.mutations[r-1].updateTransforms=i.transform.fieldTransforms,e.mutations.splice(r,1),--r)}var o=e.mutations.map(function(e){return Du(t.ks,e)}),s=Pi.fromMillis(e.localWriteTimeMs);return new ka(e.batchId,s,n,o)}function Ba(t){var e,n,r=qa(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?qa(t.lastLimboFreeSnapshotVersion):ki.min();return void 0!==t.query.documents?(ui(1===(n=t.query).documents.length),e=Jo(Fo(Su(n.documents[0])))):e=function(t){return Jo(Ru(t))}(t.query),new ns(e,t.targetId,0,t.lastListenSequenceNumber,r,i,di.fromBase64String(t.resumeToken))}function za(t,e){var n,r=Va(e.Mt),i=Va(e.lastLimboFreeSnapshotVersion);n=Eo(e.target)?Cu(t.ks,e.target):Lu(t.ks,e.target);var o=e.resumeToken.toBase64();return new _a(e.targetId,Io(e.target),r,o,e.sequenceNumber,i,n)}function Ga(t){var e=Ru({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Xo(e,e.limit,"L"):e}var Ha=function(){function t(){}return t.prototype.Ms=function(t,e){return Ka(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:qa(e.createTime),version:e.version};var e})},t.prototype.Ls=function(t,e){return Ka(t).put({bundleId:(n=e).id,createTime:Va(Iu(n.createTime)),version:n.version});var n},t.prototype.$s=function(t,e){return Qa(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:Ga(e.bundledQuery),readTime:qa(e.readTime)};var e})},t.prototype.Bs=function(t,e){return Qa(t).put(function(t){return{name:t.name,readTime:Va(Iu(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Ka(t){return Pa(t,Sa.store)}function Qa(t){return Pa(t,xa.store)}var Ja=function(){function t(){this.qs=new Xa}return t.prototype.Us=function(t,e){return this.qs.add(e),Xu.resolve()},t.prototype.Qs=function(t,e){return Xu.resolve(this.qs.getEntries(e))},t}(),Xa=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.et(),n=t.Z(),r=this.index[e]||new Gs(Ci.J),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.et(),n=t.Z(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Gs(Ci.J)).rt()},t}(),Wa=function(){function t(){this.Ks=new Xa}return t.prototype.Us=function(t,e){var n=this;if(!this.Ks.has(e)){var r=e.et(),i=e.Z();t.Vs(function(){n.Ks.add(e)});var o={collectionId:r,parent:ca(i)};return Ya(t).put(o)}return Xu.resolve()},t.prototype.Qs=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[pi(e),""],!1,!0);return Ya(t).os(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(la(o.parent))}return n})},t}();function Ya(t){return Pa(t,Ta.store)}var Za={Ws:!1,js:0,Gs:0,zs:0},$a=function(){function t(t,e,n){this.Hs=t,this.Js=e,this.Ys=n}return t.Xs=function(e){return new t(e,t.Zs,t.ti)},t}();function tc(t){return Object($r.b)(this,void 0,void 0,function(){return Object($r.e)(this,function(e){if(t.code!==vi.FAILED_PRECONDITION||t.message!==ua)throw t;return ni("LocalStore","Unexpectedly lost primary lease"),[2]})})}$a.Zs=10,$a.ti=1e3,$a.ei=new $a(41943040,$a.Zs,$a.ti),$a.ni=new $a(-1,0,0);var ec=function(){function t(t,e){this.si=t,this.ii=e,this.ri={}}return t.prototype.get=function(t){var e=this.si(t),n=this.ri[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.ii(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.si(t),r=this.ri[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.ii(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ri[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.si(t),n=this.ri[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.ii(n[r][0],t))return 1===n.length?delete this.ri[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Vi(this.ri,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.nt=function(){return qi(this.ri)},t}(),nc=function(){function t(){this.oi=new ec(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.ci=!1}return t.prototype.ai=function(t){var e=this.oi.get(t);return e?e.readTime:ki.min()},t.prototype.ui=function(t,e){this.hi(),this.oi.set(t.key,{li:t,readTime:e})},t.prototype._i=function(t,e){void 0===e&&(e=null),this.hi(),this.oi.set(t,{li:null,readTime:e})},t.prototype.fi=function(t,e){this.hi();var n=this.oi.get(e);return void 0!==n?Xu.resolve(n.li):this.di(t,e)},t.prototype.getEntries=function(t,e){return this.wi(t,e)},t.prototype.apply=function(t){return this.hi(),this.ci=!0,this.Ei(t)},t.prototype.hi=function(){},t}();function rc(t,e,n){var r=t.store(ya.store),i=t.store(ga.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.ls({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){ui(1===u)}));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=ga.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return Xu.$n(o).next(function(){return c})}function ic(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw si();e=t.noDocument}return JSON.stringify(e).length}var oc=function(){function t(t,e,n,r){this.userId=t,this.Kt=e,this.Ti=n,this.Ii=r,this.mi={}}return t.Ai=function(e,n,r,i){return ui(""!==e.uid),new t(e.A()?e.uid:"",n,r,i)},t.prototype.Ri=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return uc(t).ls({index:ya.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.Pi=function(t,e,n,r){var i=this,o=ac(t),s=uc(t);return s.add({}).next(function(u){ui("number"==typeof u);for(var a=new ka(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return ku(t.ks,e)}),i=n.mutations.map(function(e){return ku(t.ks,e)});return new ya(e,n.batchId,n.Ss.toMillis(),r,i)}(i.Kt,i.userId,a),h=[],f=new Gs(function(t,e){return fi(t.ot(),e.ot())}),l=0,p=r;l<p.length;l++){var d=p[l],v=ga.key(i.userId,d.key.path,u);f=f.add(d.key.path.Z()),h.push(s.put(c)),h.push(o.put(v,ga.PLACEHOLDER))}return f.forEach(function(e){h.push(i.Ti.Us(t,e))}),t.Vs(function(){i.mi[u]=a.keys()}),Xu.$n(h).next(function(){return a})})},t.prototype.yi=function(t,e){var n=this;return uc(t).get(e).next(function(t){return t?(ui(t.userId===n.userId),Fa(n.Kt,t)):null})},t.prototype.gi=function(t,e){var n=this;return this.mi[e]?Xu.resolve(this.mi[e]):this.yi(t,e).next(function(t){if(t){var r=t.keys();return n.mi[e]=r,r}return null})},t.prototype.Vi=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return uc(t).ls({index:ya.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(ui(e.batchId>=r),o=Fa(n.Kt,e)),i.done()}).next(function(){return o})},t.prototype.pi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return uc(t).ls({index:ya.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.bi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return uc(t).os(ya.userMutationsIndex,n).next(function(t){return t.map(function(t){return Fa(e.Kt,t)})})},t.prototype.vi=function(t,e){var n=this,r=ga.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return ac(t).ls({range:i},function(r,i,s){var u=r[0],a=r[2],c=la(r[1]);if(u===n.userId&&e.path.isEqual(c))return uc(t).get(a).next(function(t){if(!t)throw si();ui(t.userId===n.userId),o.push(Fa(n.Kt,t))});s.done()}).next(function(){return o})},t.prototype.Si=function(t,e){var n=this,r=new Gs(fi),i=[];return e.forEach(function(e){var o=ga.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=ac(t).ls({range:s},function(t,i,o){var s=t[0],u=t[2],a=la(t[1]);s===n.userId&&e.path.isEqual(a)?r=r.add(u):o.done()});i.push(u)}),Xu.$n(i).next(function(){return n.Di(t,r)})},t.prototype.Ci=function(t,e){var n=this,r=e.path,i=r.length+1,o=ga.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new Gs(fi);return ac(t).ls({range:s},function(t,e,o){var s=t[0],a=t[2],c=la(t[1]);s===n.userId&&r.st(c)?c.length===i&&(u=u.add(a)):o.done()}).next(function(){return n.Di(t,u)})},t.prototype.Di=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(uc(t).get(e).next(function(t){if(null===t)throw si();ui(t.userId===n.userId),r.push(Fa(n.Kt,t))}))}),Xu.$n(i).next(function(){return r})},t.prototype.xi=function(t,e){var n=this;return rc(t.bs,this.userId,e).next(function(r){return t.Vs(function(){n.Ni(e.batchId)}),Xu.forEach(r,function(e){return n.Ii.Fi(t,e)})})},t.prototype.Ni=function(t){delete this.mi[t]},t.prototype.Oi=function(t){var e=this;return this.Ri(t).next(function(n){if(!n)return Xu.resolve();var r=IDBKeyRange.lowerBound(ga.prefixForUser(e.userId)),i=[];return ac(t).ls({range:r},function(t,n,r){if(t[0]===e.userId){var o=la(t[1]);i.push(o)}else r.done()}).next(function(){ui(0===i.length)})})},t.prototype.ki=function(t,e){return sc(t,this.userId,e)},t.prototype.Mi=function(t){var e=this;return cc(t).get(this.userId).next(function(t){return t||new va(e.userId,-1,"")})},t}();function sc(t,e,n){var r=ga.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return ac(t).ls({range:o,hs:!0},function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()}).next(function(){return s})}function uc(t){return Pa(t,ya.store)}function ac(t){return Pa(t,ga.store)}function cc(t){return Pa(t,va.store)}var hc=function(){function t(t){this.Li=t}return t.prototype.next=function(){return this.Li+=2,this.Li},t.$i=function(){return new t(0)},t.Bi=function(){return new t(-1)},t}(),fc=function(){function t(t,e){this.Ii=t,this.Kt=e}return t.prototype.qi=function(t){var e=this;return this.Ui(t).next(function(n){var r=new hc(n.highestTargetId);return n.highestTargetId=r.next(),e.Qi(t,n).next(function(){return n.highestTargetId})})},t.prototype.Ki=function(t){return this.Ui(t).next(function(t){return ki.W(new Pi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.Wi=function(t){return this.Ui(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.ji=function(t,e,n){var r=this;return this.Ui(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.G()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Qi(t,i)})},t.prototype.Gi=function(t,e){var n=this;return this.zi(t,e).next(function(){return n.Ui(t).next(function(r){return r.targetCount+=1,n.Hi(e,r),n.Qi(t,r)})})},t.prototype.Ji=function(t,e){return this.zi(t,e)},t.prototype.Yi=function(t,e){var n=this;return this.Xi(t,e.targetId).next(function(){return lc(t).delete(e.targetId)}).next(function(){return n.Ui(t)}).next(function(e){return ui(e.targetCount>0),e.targetCount-=1,n.Qi(t,e)})},t.prototype.Zi=function(t,e,n){var r=this,i=0,o=[];return lc(t).ls(function(s,u){var a=Ba(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Yi(t,a)))}).next(function(){return Xu.$n(o)}).next(function(){return i})},t.prototype.mn=function(t,e){return lc(t).ls(function(t,n){var r=Ba(n);e(r)})},t.prototype.Ui=function(t){return pc(t).get(Oa.key).next(function(t){return ui(null!==t),t})},t.prototype.Qi=function(t,e){return pc(t).put(Oa.key,e)},t.prototype.zi=function(t,e){return lc(t).put(za(this.Kt,e))},t.prototype.Hi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.tr=function(t){return this.Ui(t).next(function(t){return t.targetCount})},t.prototype.er=function(t,e){var n=Io(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return lc(t).ls({range:r,index:_a.queryTargetsIndexName},function(t,n,r){var o=Ba(n);_o(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.nr=function(t,e,n){var r=this,i=[],o=dc(t);return e.forEach(function(e){var s=ca(e.path);i.push(o.put(new Ea(n,s))),i.push(r.Ii.sr(t,n,e))}),Xu.$n(i)},t.prototype.ir=function(t,e,n){var r=this,i=dc(t);return Xu.forEach(e,function(e){var o=ca(e.path);return Xu.$n([i.delete([n,o]),r.Ii.rr(t,n,e)])})},t.prototype.Xi=function(t,e){var n=dc(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.cr=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=dc(t),i=tu();return r.ls({range:n,hs:!0},function(t,e,n){var r=la(t[1]),o=new Mi(r);i=i.add(o)}).next(function(){return i})},t.prototype.ki=function(t,e){var n=ca(e.path),r=IDBKeyRange.bound([n],[pi(n)],!1,!0),i=0;return dc(t).ls({index:Ea.documentTargetsIndex,hs:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.Dn=function(t,e){return lc(t).get(e).next(function(t){return t?Ba(t):null})},t}();function lc(t){return Pa(t,_a.store)}function pc(t){return Pa(t,Oa.store)}function dc(t){return Pa(t,Ea.store)}function vc(t,e){var n=t[1],r=e[1],i=fi(t[0],e[0]);return 0===i?fi(n,r):i}var yc=function(){function t(t){this.ar=t,this.buffer=new Gs(vc),this.ur=0}return t.prototype.hr=function(){return++this.ur},t.prototype.lr=function(t){var e=[t,this.hr()];if(this.buffer.size<this.ar)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();vc(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),gc=function(){function t(t,e){this._r=t,this.fs=e,this.dr=!1,this.wr=null}return t.prototype.start=function(t){-1!==this._r.params.Hs&&this.Er(t)},t.prototype.stop=function(){this.wr&&(this.wr.cancel(),this.wr=null)},Object.defineProperty(t.prototype,"Tr",{get:function(){return null!==this.wr},enumerable:!1,configurable:!0}),t.prototype.Er=function(t){var e=this,n=this.dr?3e5:6e4;ni("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.wr=this.fs.Ir("lru_garbage_collection",n,function(){return Object($r.b)(e,void 0,void 0,function(){var e;return Object($r.e)(this,function(n){switch(n.label){case 0:this.wr=null,this.dr=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.mr(this._r)];case 2:return n.sent(),[3,7];case 3:return ta(e=n.sent())?(ni("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,tc(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Er(t)];case 8:return n.sent(),[2]}})})})},t}(),bc=function(){function t(t,e){this.Ar=t,this.params=e}return t.prototype.Rr=function(t,e){return this.Ar.Pr(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.yr=function(t,e){var n=this;if(0===e)return Xu.resolve(Ai.U);var r=new yc(e);return this.Ar.mn(t,function(t){return r.lr(t.sequenceNumber)}).next(function(){return n.Ar.gr(t,function(t){return r.lr(t)})}).next(function(){return r.maxValue})},t.prototype.Zi=function(t,e,n){return this.Ar.Zi(t,e,n)},t.prototype.Vr=function(t,e){return this.Ar.Vr(t,e)},t.prototype.pr=function(t,e){var n=this;return-1===this.params.Hs?(ni("LruGarbageCollector","Garbage collection skipped; disabled"),Xu.resolve(Za)):this.br(t).next(function(r){return r<n.params.Hs?(ni("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Hs),Za):n.vr(t,e)})},t.prototype.br=function(t){return this.Ar.br(t)},t.prototype.vr=function(t,e){var n,r,i,o,s,u,a,c=this,h=Date.now();return this.Rr(t,this.params.Js).next(function(e){return e>c.params.Ys?(ni("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.Ys+" from "+e),r=c.params.Ys):r=e,o=Date.now(),c.yr(t,r)}).next(function(r){return n=r,s=Date.now(),c.Zi(t,n,e)}).next(function(e){return i=e,u=Date.now(),c.Vr(t,n)}).next(function(t){return a=Date.now(),ei()<=X.a.DEBUG&&ni("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(a-u)+"ms\nTotal Duration: "+(a-h)+"ms"),Xu.resolve({Ws:!0,js:r,Gs:i,zs:t})})},t}(),mc=function(){function t(t,e){this.db=t,this._r=function(t,e){return new bc(t,e)}(this,e)}return t.prototype.Pr=function(t){var e=this.Sr(t);return this.db.Dr().tr(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.Sr=function(t){var e=0;return this.gr(t,function(t){e++}).next(function(){return e})},t.prototype.mn=function(t,e){return this.db.Dr().mn(t,e)},t.prototype.gr=function(t,e){return this.Cr(t,function(t,n){return e(n)})},t.prototype.sr=function(t,e,n){return wc(t,n)},t.prototype.rr=function(t,e,n){return wc(t,n)},t.prototype.Zi=function(t,e,n){return this.db.Dr().Zi(t,e,n)},t.prototype.Fi=function(t,e){return wc(t,e)},t.prototype.Nr=function(t,e){return function(t,e){var n=!1;return cc(t)._s(function(r){return sc(t,r,e).next(function(t){return t&&(n=!0),Xu.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.Vr=function(t,e){var n=this,r=this.db.Or().Fr(),i=[],o=0;return this.Cr(t,function(s,u){if(u<=e){var a=n.Nr(t,s).next(function(e){if(!e)return o++,r.fi(t,s).next(function(){return r._i(s),dc(t).delete([0,ca(s.path)])})});i.push(a)}}).next(function(){return Xu.$n(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.Lt(t.vs);return this.db.Dr().Ji(t,n)},t.prototype.kr=function(t,e){return wc(t,e)},t.prototype.Cr=function(t,e){var n,r=dc(t),i=Ai.U;return r.ls({index:Ea.documentTargetsIndex},function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==Ai.U&&e(new Mi(la(n)),i),i=s,n=o):i=Ai.U}).next(function(){i!==Ai.U&&e(new Mi(la(n)),i)})},t.prototype.br=function(t){return this.db.Or().Mr(t)},t}();function wc(t,e){return dc(t).put(function(t,e){return new Ea(0,ca(t.path),e)}(e,t.vs))}var Ic=function(){function t(t,e){this.Kt=t,this.Ti=e}return t.prototype.ui=function(t,e,n){return Oc(t).put(Tc(e),n)},t.prototype._i=function(t,e){var n=Oc(t),r=Tc(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.Lr(t,r)})},t.prototype.fi=function(t,e){var n=this;return Oc(t).get(Tc(e)).next(function(t){return n.$r(t)})},t.prototype.Br=function(t,e){var n=this;return Oc(t).get(Tc(e)).next(function(t){var e=n.$r(t);return e?{li:e,size:ic(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=Js();return this.qr(t,e,function(t,e){var i=n.$r(e);r=r.Ht(t,i)}).next(function(){return r})},t.prototype.Ur=function(t,e){var n=this,r=Js(),i=new Fs(Mi.J);return this.qr(t,e,function(t,e){var o=n.$r(e);o?(r=r.Ht(t,o),i=i.Ht(t,ic(e))):(r=r.Ht(t,null),i=i.Ht(t,0))}).next(function(){return{Qr:r,Kr:i}})},t.prototype.qr=function(t,e,n){if(e.nt())return Xu.resolve();var r=IDBKeyRange.bound(e.first().path.rt(),e.last().path.rt()),i=e.ee(),o=i.ce();return Oc(t).ls({range:r},function(t,e,r){for(var s=Mi.Tt(t);o&&Mi.J(o,s)<0;)n(o,null),o=i.ce();o&&o.isEqual(s)&&(n(o,e),o=i.ae()?i.ce():null),o?r.rs(o.path.rt()):r.done()}).next(function(){for(;o;)n(o,null),o=i.ae()?i.ce():null})},t.prototype.Wr=function(t,e,n){var r=this,i=Ws(),o=e.path.length+1,s={};if(n.isEqual(ki.min())){var u=e.path.rt();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.rt(),c=Ma(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=wa.collectionReadTimeIndex}return Oc(t).ls(s,function(t,n,s){if(t.length===o){var u=La(r.Kt,n);e.path.st(u.key.path)?u instanceof yo&&$o(e,u)&&(i=i.Ht(u.key,u)):s.done()}}).next(function(){return i})},t.prototype.Fr=function(t){return new _c(this,!!t&&t.jr)},t.prototype.Mr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Ec(t).get(Ia.key).next(function(t){return ui(!!t),t})},t.prototype.Lr=function(t,e){return Ec(t).put(Ia.key,e)},t.prototype.$r=function(t){if(t){var e=La(this.Kt,t);return e instanceof go&&e.version.isEqual(ki.min())?null:e}return null},t}(),_c=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Gr=e,r.jr=n,r.zr=new ec(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return Object($r.d)(e,t),e.prototype.Ei=function(t){var e=this,n=[],r=0,i=new Gs(function(t,e){return fi(t.ot(),e.ot())});return this.oi.forEach(function(o,s){var u=e.zr.get(o);if(s.li){var a=Ra(e.Gr.Kt,s.li,e.ai(o));i=i.add(o.path.Z());var c=ic(a);r+=c-u,n.push(e.Gr.ui(t,o,a))}else if(r-=u,e.jr){var h=Ra(e.Gr.Kt,new go(o,ki.min()),e.ai(o));n.push(e.Gr.ui(t,o,h))}else n.push(e.Gr._i(t,o))}),i.forEach(function(r){n.push(e.Gr.Ti.Us(t,r))}),n.push(this.Gr.updateMetadata(t,r)),Xu.$n(n)},e.prototype.di=function(t,e){var n=this;return this.Gr.Br(t,e).next(function(t){return null===t?(n.zr.set(e,0),null):(n.zr.set(e,t.size),t.li)})},e.prototype.wi=function(t,e){var n=this;return this.Gr.Ur(t,e).next(function(t){var e=t.Qr;return t.Kr.forEach(function(t,e){n.zr.set(t,e)}),e})},e}(nc);function Ec(t){return Pa(t,Ia.store)}function Oc(t){return Pa(t,wa.store)}function Tc(t){return t.path.rt()}var jc=function(){function t(t){this.Kt=t}return t.prototype.Yn=function(t,e,n,r){var i=this;ui(n<r&&n>=0&&r<=11);var o=new Wu("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(da.store)}(t),function(t){t.createObjectStore(va.store,{keyPath:va.keyPath}),t.createObjectStore(ya.store,{keyPath:ya.keyPath,autoIncrement:!0}).createIndex(ya.userMutationsIndex,ya.userMutationsKeyPath,{unique:!0}),t.createObjectStore(ga.store)}(t),Sc(t),function(t){t.createObjectStore(wa.store)}(t));var s=Xu.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Ea.store),t.deleteObjectStore(_a.store),t.deleteObjectStore(Oa.store)}(t),Sc(t)),s=s.next(function(){return function(t){var e=t.store(Oa.store),n=new Oa(0,0,ki.min().G(),0);return e.put(Oa.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(ya.store).os().next(function(n){t.deleteObjectStore(ya.store),t.createObjectStore(ya.store,{keyPath:ya.keyPath,autoIncrement:!0}).createIndex(ya.userMutationsIndex,ya.userMutationsKeyPath,{unique:!0});var r=e.store(ya.store),i=n.map(function(t){return r.put(t)});return Xu.$n(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(ja.store,{keyPath:ja.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.Hr(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(Ia.store)}(t),i.Jr(o)})),n<7&&r>=7&&(s=s.next(function(){return i.Yr(o)})),n<8&&r>=8&&(s=s.next(function(){return i.Xr(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(wa.store);e.createIndex(wa.readTimeIndex,wa.readTimeIndexPath,{unique:!1}),e.createIndex(wa.collectionReadTimeIndex,wa.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.Zr(o)})),n<11&&r>=11&&(s=s.next(function(){!function(t){t.createObjectStore(Sa.store,{keyPath:Sa.keyPath})}(t),function(t){t.createObjectStore(xa.store,{keyPath:xa.keyPath})}(t)})),s},t.prototype.Jr=function(t){var e=0;return t.store(wa.store).ls(function(t,n){e+=ic(n)}).next(function(){var n=new Ia(e);return t.store(Ia.store).put(Ia.key,n)})},t.prototype.Hr=function(t){var e=this,n=t.store(va.store),r=t.store(ya.store);return n.os().next(function(n){return Xu.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.os(ya.userMutationsIndex,i).next(function(r){return Xu.forEach(r,function(r){ui(r.userId===n.userId);var i=Fa(e.Kt,r);return rc(t,n.userId,i).next(function(){})})})})})},t.prototype.Yr=function(t){var e=t.store(Ea.store),n=t.store(wa.store);return t.store(Oa.store).get(Oa.key).next(function(t){var r=[];return n.ls(function(n,i){var o=new Ci(n),s=function(t){return[0,ca(t)]}(o);r.push(e.get(s).next(function(n){return n?Xu.resolve():function(n){return e.put(new Ea(0,ca(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return Xu.$n(r)})})},t.prototype.Xr=function(t,e){t.createObjectStore(Ta.store,{keyPath:Ta.keyPath});var n=e.store(Ta.store),r=new Xa,i=function(t){if(r.add(t)){var e=t.et(),i=t.Z();return n.put({collectionId:e,parent:ca(i)})}};return e.store(wa.store).ls({hs:!0},function(t,e){var n=new Ci(t);return i(n.Z())}).next(function(){return e.store(ga.store).ls({hs:!0},function(t,e){var n=la(t[1]);return i(n.Z())})})},t.prototype.Zr=function(t){var e=this,n=t.store(_a.store);return n.ls(function(t,r){var i=Ba(r),o=za(e.Kt,i);return n.put(o)})},t}();function Sc(t){t.createObjectStore(Ea.store,{keyPath:Ea.keyPath}).createIndex(Ea.documentTargetsIndex,Ea.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(_a.store,{keyPath:_a.keyPath}).createIndex(_a.queryTargetsIndexName,_a.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Oa.store)}var xc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Nc=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.eo=o,this.window=s,this.document=u,this.no=c,this.so=h,this.io=null,this.ro=!1,this.isPrimary=!1,this.networkEnabled=!0,this.oo=null,this.inForeground=!1,this.co=null,this.ao=null,this.uo=Number.NEGATIVE_INFINITY,this.ho=function(t){return Promise.resolve()},!t.Wn())throw new yi(vi.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Ii=new mc(this,i),this.lo=n+"main",this.Kt=new Ca(a),this._o=new Yu(this.lo,11,new jc(this.Kt)),this.fo=new fc(this.Ii,this.Kt),this.Ti=new Wa,this.wo=function(t,e){return new Ic(t,e)}(this.Kt,this.Ti),this.Eo=new Ha,this.window&&this.window.localStorage?this.To=this.window.localStorage:(this.To=null,!1===h&&ri("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.Io().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new yi(vi.FAILED_PRECONDITION,xc);return t.mo(),t.Ao(),t.Ro(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.fo.Wi(e)})}).then(function(e){t.io=new Ai(e,t.no)}).then(function(){t.ro=!0}).catch(function(e){return t._o&&t._o.close(),Promise.reject(e)})},t.prototype.Po=function(t){var e=this;return this.ho=function(n){return Object($r.b)(e,void 0,void 0,function(){return Object($r.e)(this,function(e){return this.Tr?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.yo=function(t){var e=this;this._o.Zn(function(n){return Object($r.b)(e,void 0,void 0,function(){return Object($r.e)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.Vo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.eo.ys(function(){return Object($r.b)(e,void 0,void 0,function(){return Object($r.e)(this,function(t){switch(t.label){case 0:return this.Tr?[4,this.Io()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.Io=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Pc(e).put(new ja(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.po(e).next(function(e){e||(t.isPrimary=!1,t.eo.bo(function(){return t.ho(!1)}))})}).next(function(){return t.vo(e)}).next(function(n){return t.isPrimary&&!n?t.So(e).next(function(){return!1}):!!n&&t.Do(e).next(function(){return!0})})}).catch(function(e){if(ta(e))return ni("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return ni("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.eo.bo(function(){return t.ho(e)}),t.isPrimary=e})},t.prototype.po=function(t){var e=this;return Ac(t).get(da.key).next(function(t){return Xu.resolve(e.Co(t))})},t.prototype.xo=function(t){return Pc(t).delete(this.clientId)},t.prototype.No=function(){return Object($r.b)(this,void 0,void 0,function(){var t,e,n,r=this;return Object($r.e)(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.Fo(this.uo,18e5)?[3,2]:(this.uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var e=Pa(t,ja.store);return e.os().next(function(t){var n=r.Oo(t,18e5),i=t.filter(function(t){return-1===n.indexOf(t)});return Xu.forEach(i,function(t){return e.delete(t.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:if(t=i.sent(),this.To)for(e=0,n=t;e<n.length;e++)this.To.removeItem(this.ko(n[e].clientId));i.label=2;case 2:return[2]}})})},t.prototype.Ro=function(){var t=this;this.ao=this.eo.Ir("client_metadata_refresh",4e3,function(){return t.Io().then(function(){return t.No()}).then(function(){return t.Ro()})})},t.prototype.Co=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.vo=function(t){var e=this;return this.so?Xu.resolve(!0):Ac(t).get(da.key).next(function(n){if(null!==n&&e.Fo(n.leaseTimestampMs,5e3)&&!e.Mo(n.ownerId)){if(e.Co(n)&&e.networkEnabled)return!0;if(!e.Co(n)){if(!n.allowTabSynchronization)throw new yi(vi.FAILED_PRECONDITION,xc);return!1}}return!(!e.networkEnabled||!e.inForeground)||Pc(t).os().next(function(t){return void 0===e.Oo(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&ni("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.Lo=function(){return Object($r.b)(this,void 0,void 0,function(){var t=this;return Object($r.e)(this,function(e){switch(e.label){case 0:return this.ro=!1,this.$o(),this.ao&&(this.ao.cancel(),this.ao=null),this.Bo(),this.qo(),[4,this._o.runTransaction("shutdown","readwrite",[da.store,ja.store],function(e){var n=new Aa(e,Ai.U);return t.So(n).next(function(){return t.xo(n)})})];case 1:return e.sent(),this._o.close(),this.Uo(),[2]}})})},t.prototype.Oo=function(t,e){var n=this;return t.filter(function(t){return n.Fo(t.updateTimeMs,e)&&!n.Mo(t.clientId)})},t.prototype.Qo=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return Pc(e).os().next(function(e){return t.Oo(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),t.prototype.Ko=function(t){return oc.Ai(t,this.Kt,this.Ti,this.Ii)},t.prototype.Dr=function(){return this.fo},t.prototype.Or=function(){return this.wo},t.prototype.Wo=function(){return this.Ti},t.prototype.jo=function(){return this.Eo},t.prototype.runTransaction=function(t,e,n){var r,i=this;return ni("IndexedDbPersistence","Starting transaction:",t),this._o.runTransaction(t,"readonly"===e?"readonly":"readwrite",Na,function(o){return r=new Aa(o,i.io?i.io.next():Ai.U),"readwrite-primary"===e?i.po(r).next(function(t){return!!t||i.vo(r)}).next(function(e){if(!e)throw ri("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.eo.bo(function(){return i.ho(!1)}),new yi(vi.FAILED_PRECONDITION,ua);return n(r)}).next(function(t){return i.Do(r).next(function(){return t})}):i.Go(r).next(function(){return n(r)})}).then(function(t){return r.ps(),t})},t.prototype.Go=function(t){var e=this;return Ac(t).get(da.key).next(function(t){if(null!==t&&e.Fo(t.leaseTimestampMs,5e3)&&!e.Mo(t.ownerId)&&!e.Co(t)&&!(e.so||e.allowTabSynchronization&&t.allowTabSynchronization))throw new yi(vi.FAILED_PRECONDITION,xc)})},t.prototype.Do=function(t){var e=new da(this.clientId,this.allowTabSynchronization,Date.now());return Ac(t).put(da.key,e)},t.Wn=function(){return Yu.Wn()},t.prototype.So=function(t){var e=this,n=Ac(t);return n.get(da.key).next(function(t){return e.Co(t)?(ni("IndexedDbPersistence","Releasing primary lease."),n.delete(da.key)):Xu.resolve()})},t.prototype.Fo=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(ri("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.mo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.co=function(){t.eo.ys(function(){return t.inForeground="visible"===t.document.visibilityState,t.Io()})},this.document.addEventListener("visibilitychange",this.co),this.inForeground="visible"===this.document.visibilityState)},t.prototype.Bo=function(){this.co&&(this.document.removeEventListener("visibilitychange",this.co),this.co=null)},t.prototype.Ao=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.oo=function(){e.$o(),e.eo.ys(function(){return e.Lo()})},this.window.addEventListener("unload",this.oo))},t.prototype.qo=function(){this.oo&&(this.window.removeEventListener("unload",this.oo),this.oo=null)},t.prototype.Mo=function(t){var e;try{var n=null!==(null===(e=this.To)||void 0===e?void 0:e.getItem(this.ko(t)));return ni("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return ri("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.$o=function(){if(this.To)try{this.To.setItem(this.ko(this.clientId),String(Date.now()))}catch(t){ri("Failed to set zombie client id.",t)}},t.prototype.Uo=function(){if(this.To)try{this.To.removeItem(this.ko(this.clientId))}catch(t){}},t.prototype.ko=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Ac(t){return Pa(t,da.store)}function Pc(t){return Pa(t,ja.store)}function kc(t,e){var n=t.projectId;return t.m||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Dc=function(t,e){this.progress=t,this.zo=e},Cc=function(){function t(t,e,n){this.wo=t,this.Ho=e,this.Ti=n}return t.prototype.Jo=function(t,e){var n=this;return this.Ho.vi(t,e).next(function(r){return n.Yo(t,e,r)})},t.prototype.Yo=function(t,e,n){return this.wo.fi(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].xs(e,t);return t})},t.prototype.Xo=function(t,e,n){var r=Js();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].xs(t,e);r=r.Ht(t,e)}),r},t.prototype.Zo=function(t,e){var n=this;return this.wo.getEntries(t,e).next(function(e){return n.tc(t,e)})},t.prototype.tc=function(t,e){var n=this;return this.Ho.Si(t,e).next(function(r){var i=n.Xo(t,e,r),o=Qs();return i.forEach(function(t,e){e||(e=new go(t,ki.min())),o=o.Ht(t,e)}),o})},t.prototype.Wr=function(t,e,n){return function(t){return Mi.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.ec(t,e.path):Ko(e)?this.nc(t,e,n):this.sc(t,e,n)},t.prototype.ec=function(t,e){return this.Jo(t,new Mi(e)).next(function(t){var e=Ws();return t instanceof yo&&(e=e.Ht(t.key,t)),e})},t.prototype.nc=function(t,e,n){var r=this,i=e.collectionGroup,o=Ws();return this.Ti.Qs(t,i).next(function(s){return Xu.forEach(s,function(s){var u=function(t,e){return new Vo(e,null,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.sc(t,u,n).next(function(t){t.forEach(function(t,e){o=o.Ht(t,e)})})}).next(function(){return o})})},t.prototype.sc=function(t,e,n){var r,i,o=this;return this.wo.Wr(t,e,n).next(function(n){return r=n,o.Ho.Ci(t,e)}).next(function(e){return o.ic(t,i=e,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=Os(a,r.get(c),0,o.Ss);r=h instanceof yo?r.Ht(c,h):r.remove(c)}})}).next(function(){return r.forEach(function(t,n){$o(e,n)||(r=r.remove(t))}),r})},t.prototype.ic=function(t,e,n){for(var r=tu(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ns&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.wo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof yo&&(c=c.Ht(t,e))}),c})},t}(),Lc=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.rc=n,this.oc=r}return t.cc=function(e,n){for(var r=tu(),i=tu(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Rc=function(){function t(){}return t.prototype.ac=function(t){this.uc=t},t.prototype.Wr=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.Nt.length||1===t.Nt.length&&t.Nt[0].field.ht())}(e)||n.isEqual(ki.min())?this.hc(t,e):this.uc.Zo(t,r).next(function(o){var s=i.lc(e,o);return(Bo(e)||zo(e))&&i._c(e.limitType,s,r,n)?i.hc(t,e):(ei()<=X.a.DEBUG&&ni("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Zo(e)),i.uc.Wr(t,e,n).next(function(t){return s.forEach(function(e){t=t.Ht(e.key,e)}),t}))})},t.prototype.lc=function(t,e){var n=new Gs(ts(t));return e.forEach(function(e,r){r instanceof yo&&$o(t,r)&&(n=n.add(r))}),n},t.prototype._c=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.u(r)>0)},t.prototype.hc=function(t,e){return ei()<=X.a.DEBUG&&ni("QueryEngine","Using full collection scan to execute query:",Zo(e)),this.uc.Wr(t,e,ki.min())},t}(),Mc=function(){function t(t,e,n,r){this.persistence=t,this.fc=e,this.Kt=r,this.dc=new Fs(fi),this.wc=new ec(function(t){return Io(t)},_o),this.Ec=ki.min(),this.Ho=t.Ko(n),this.Tc=t.Or(),this.fo=t.Dr(),this.Ic=new Cc(this.Tc,this.Ho,this.persistence.Wo()),this.Eo=t.jo(),this.fc.ac(this.Ic)}return t.prototype.mr=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.pr(n,e.dc)})},t}();function Uc(t,e,n,r){return new Mc(t,e,n,r)}function Vc(t,e){return Object($r.b)(this,void 0,void 0,function(){var n,r,i,o;return Object($r.e)(this,function(s){switch(s.label){case 0:return n=ai(t),r=n.Ho,i=n.Ic,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n.Ho.bi(t).next(function(s){return o=s,r=n.persistence.Ko(e),i=new Cc(n.Tc,r,n.persistence.Wo()),r.bi(t)}).next(function(e){for(var n=[],r=[],s=tu(),u=0,a=o;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++)s=s.add(f[h].key)}for(var l=0,p=e;l<p.length;l++){var d=p[l];r.push(d.batchId);for(var v=0,y=d.mutations;v<y.length;v++)s=s.add(y[v].key)}return i.Zo(t,s).next(function(t){return{mc:t,Ac:n,Rc:r}})})})];case 1:return o=s.sent(),[2,(n.Ho=r,n.Ic=i,n.fc.ac(n.Ic),o)]}})})}function qc(t,e){var n=ai(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.Tc.Fr({jr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=Xu.resolve();return o.forEach(function(t){s=s.next(function(){return r.fi(e,t)}).next(function(e){var o=e,s=n.Os.get(t);ui(null!==s),(!o||o.version.u(s)<0)&&(o=i.Ds(t,o,n))&&r.ui(o,n.Fs)})}),s.next(function(){return t.Ho.xi(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n.Ho.Oi(t)}).next(function(){return n.Ic.Zo(t,r)})})}function Fc(t){var e=ai(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.fo.Ki(t)})}function Bc(t,e){var n=ai(t),r=e.Mt,i=n.dc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.Tc.Fr({jr:!0});i=n.dc;var s=[];e.Oe.forEach(function(e,o){var u=i.get(o);if(u){s.push(n.fo.ir(t,e.Ke,o).next(function(){return n.fo.nr(t,e.Ue,o)}));var a=e.resumeToken;if(a.o()>0){var c=u.$t(a,r).Lt(t.vs);i=i.Ht(o,c),function(t,e,n){return ui(e.resumeToken.o()>0),0===t.resumeToken.o()||e.Mt.j()-t.Mt.j()>=3e8||n.Ue.size+n.Qe.size+n.Ke.size>0}(u,c,e)&&s.push(n.fo.Ji(t,c))}}});var u=Qs();if(e.Me.forEach(function(r,i){e.Le.has(r)&&s.push(n.persistence.Ii.kr(t,r))}),s.push(zc(t,o,e.Me,r,void 0).next(function(t){u=t})),!r.isEqual(ki.min())){var a=n.fo.Ki(t).next(function(e){return n.fo.ji(t,t.vs,r)});s.push(a)}return Xu.$n(s).next(function(){return o.apply(t)}).next(function(){return n.Ic.tc(t,u)})}).then(function(t){return n.dc=i,t})}function zc(t,e,n,r,i){var o=tu();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var o=Qs();return n.forEach(function(n,s){var u=t.get(n),a=(null==i?void 0:i.get(n))||r;s instanceof go&&s.version.isEqual(ki.min())?(e._i(n,a),o=o.Ht(n,s)):null==u||s.version.u(u.version)>0||0===s.version.u(u.version)&&u.hasPendingWrites?(e.ui(s,a),o=o.Ht(n,s)):ni("LocalStore","Ignoring outdated watch update for ",n,". Current version:",u.version," Watch version:",s.version)}),o})}function Gc(t,e){var n=ai(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Ho.Vi(t,e)})}function Hc(t,e){var n=ai(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.fo.er(t,e).next(function(i){return i?Xu.resolve(r=i):n.fo.qi(t).next(function(i){return r=new ns(e,i,0,t.vs),n.fo.Gi(t,r).next(function(){return r})})})}).then(function(t){var r=n.dc.get(t.targetId);return(null===r||t.Mt.u(r.Mt)>0)&&(n.dc=n.dc.Ht(t.targetId,t),n.wc.set(e,t.targetId)),t})}function Kc(t,e,n){return Object($r.b)(this,void 0,void 0,function(){var r,i,o,s;return Object($r.e)(this,function(u){switch(u.label){case 0:r=ai(t),i=r.dc.get(e),o=n?"readwrite":"readwrite-primary",u.label=1;case 1:return u.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.Ii.removeTarget(t,i)})];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:if(!ta(s=u.sent()))throw s;return ni("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.dc=r.dc.remove(e),r.wc.delete(i.target),[2]}})})}function Qc(t,e,n){var r=ai(t),i=ki.min(),o=tu();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=ai(t),i=r.wc.get(n);return void 0!==i?Xu.resolve(r.dc.get(i)):r.fo.er(e,n)}(r,t,Jo(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.fo.cr(t,e.targetId).next(function(t){o=t})}).next(function(){return r.fc.Wr(t,e,n?i:ki.min(),n?o:tu())}).next(function(t){return{documents:t,Pc:o}})})}function Jc(t,e){var n=ai(t),r=ai(n.fo),i=n.dc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Dn(t,e).next(function(t){return t?t.target:null})})}function Xc(t){var e=ai(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=ai(t),i=Qs(),o=Ma(n),s=Oc(e),u=IDBKeyRange.lowerBound(o,!0);return s.ls({index:wa.readTimeIndex,range:u},function(t,e){var n=La(r.Kt,e);i=i.Ht(n.key,n),o=e.readTime}).next(function(){return{zo:i,readTime:Ua(o)}})}(e.Tc,t,e.Ec)}).then(function(t){var n=t.zo;return e.Ec=t.readTime,n})}function Wc(t){return Object($r.b)(this,void 0,void 0,function(){var e;return Object($r.e)(this,function(n){return[2,(e=ai(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=Oc(t),n=ki.min();return e.ls({index:wa.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=Ua(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.Ec=t})]})})}function Yc(t,e,n,r){return Object($r.b)(this,void 0,void 0,function(){var i,o,s,u,a,c,h,f,l,p;return Object($r.e)(this,function(d){switch(d.label){case 0:for(i=ai(t),o=tu(),s=Qs(),u=Zs(),a=0,c=n;a<c.length;a++)f=e.yc((h=c[a]).metadata.name),h.document&&(o=o.add(f)),s=s.Ht(f,e.gc(h)),u=u.Ht(f,e.Vc(h.metadata.readTime));return l=i.Tc.Fr({jr:!0}),[4,Hc(i,function(t){return Jo(Fo(Ci.ct("__bundle__/docs/"+t)))}(r))];case 1:return p=d.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",function(t){return zc(t,l,s,ki.min(),u).next(function(e){return l.apply(t),e}).next(function(e){return i.fo.Xi(t,p.targetId).next(function(){return i.fo.nr(t,o,p.targetId)}).next(function(){return i.Ic.tc(t,e)})})})]}})})}function Zc(t,e,n){return void 0===n&&(n=tu()),Object($r.b)(this,void 0,void 0,function(){var r,i;return Object($r.e)(this,function(o){switch(o.label){case 0:return[4,Hc(t,Jo(Ga(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=ai(t)).persistence.runTransaction("Save named query","readwrite",function(t){var o=Iu(e.readTime);if(r.Mt.u(o)>=0)return i.Eo.Bs(t,e);var s=r.$t(di.h,o);return i.dc=i.dc.Ht(s.targetId,s),i.fo.Ji(t,s).next(function(){return i.fo.Xi(t,r.targetId)}).next(function(){return i.fo.nr(t,n,r.targetId)}).next(function(){return i.Eo.Bs(t,e)})})]}})})}var $c=function(){function t(t){this.Kt=t,this.bc=new Map,this.vc=new Map}return t.prototype.Ms=function(t,e){return Xu.resolve(this.bc.get(e))},t.prototype.Ls=function(t,e){var n;return this.bc.set(e.id,{id:(n=e).id,version:n.version,createTime:Iu(n.createTime)}),Xu.resolve()},t.prototype.$s=function(t,e){return Xu.resolve(this.vc.get(e))},t.prototype.Bs=function(t,e){return this.vc.set(e.name,function(t){return{name:t.name,query:Ga(t.bundledQuery),readTime:Iu(t.readTime)}}(e)),Xu.resolve()},t}(),th=function(){function t(){this.Sc=new Gs(eh.Dc),this.Cc=new Gs(eh.xc)}return t.prototype.nt=function(){return this.Sc.nt()},t.prototype.sr=function(t,e){var n=new eh(t,e);this.Sc=this.Sc.add(n),this.Cc=this.Cc.add(n)},t.prototype.Nc=function(t,e){var n=this;t.forEach(function(t){return n.sr(t,e)})},t.prototype.rr=function(t,e){this.Fc(new eh(t,e))},t.prototype.Oc=function(t,e){var n=this;t.forEach(function(t){return n.rr(t,e)})},t.prototype.kc=function(t){var e=this,n=new Mi(new Ci([])),r=new eh(n,t),i=new eh(n,t+1),o=[];return this.Cc.Ae([r,i],function(t){e.Fc(t),o.push(t.key)}),o},t.prototype.Mc=function(){var t=this;this.Sc.forEach(function(e){return t.Fc(e)})},t.prototype.Fc=function(t){this.Sc=this.Sc.delete(t),this.Cc=this.Cc.delete(t)},t.prototype.Lc=function(t){var e=new Mi(new Ci([])),n=new eh(e,t),r=new eh(e,t+1),i=tu();return this.Cc.Ae([n,r],function(t){i=i.add(t.key)}),i},t.prototype.ki=function(t){var e=new eh(t,0),n=this.Sc.Pe(e);return null!==n&&t.isEqual(n.key)},t}(),eh=function(){function t(t,e){this.key=t,this.$c=e}return t.Dc=function(t,e){return Mi.J(t.key,e.key)||fi(t.$c,e.$c)},t.xc=function(t,e){return fi(t.$c,e.$c)||Mi.J(t.key,e.key)},t}(),nh=function(){function t(t,e){this.Ti=t,this.Ii=e,this.Ho=[],this.Bc=1,this.qc=new Gs(eh.Dc)}return t.prototype.Ri=function(t){return Xu.resolve(0===this.Ho.length)},t.prototype.Pi=function(t,e,n,r){var i=this.Bc;this.Bc++;var o=new ka(i,e,n,r);this.Ho.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.qc=this.qc.add(new eh(a.key,i)),this.Ti.Us(t,a.key.path.Z())}return Xu.resolve(o)},t.prototype.yi=function(t,e){return Xu.resolve(this.Uc(e))},t.prototype.Vi=function(t,e){var n=this.Qc(e+1),r=n<0?0:n;return Xu.resolve(this.Ho.length>r?this.Ho[r]:null)},t.prototype.pi=function(){return Xu.resolve(0===this.Ho.length?-1:this.Bc-1)},t.prototype.bi=function(t){return Xu.resolve(this.Ho.slice())},t.prototype.vi=function(t,e){var n=this,r=new eh(e,0),i=new eh(e,Number.POSITIVE_INFINITY),o=[];return this.qc.Ae([r,i],function(t){var e=n.Uc(t.$c);o.push(e)}),Xu.resolve(o)},t.prototype.Si=function(t,e){var n=this,r=new Gs(fi);return e.forEach(function(t){var e=new eh(t,0),i=new eh(t,Number.POSITIVE_INFINITY);n.qc.Ae([e,i],function(t){r=r.add(t.$c)})}),Xu.resolve(this.Kc(r))},t.prototype.Ci=function(t,e){var n=e.path,r=n.length+1,i=n;Mi.Et(i)||(i=i.child(""));var o=new eh(new Mi(i),0),s=new Gs(fi);return this.qc.Re(function(t){var e=t.key.path;return!!n.st(e)&&(e.length===r&&(s=s.add(t.$c)),!0)},o),Xu.resolve(this.Kc(s))},t.prototype.Kc=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.Uc(t);null!==r&&n.push(r)}),n},t.prototype.xi=function(t,e){var n=this;ui(0===this.Wc(e.batchId,"removed")),this.Ho.shift();var r=this.qc;return Xu.forEach(e.mutations,function(i){var o=new eh(i.key,e.batchId);return r=r.delete(o),n.Ii.Fi(t,i.key)}).next(function(){n.qc=r})},t.prototype.Ni=function(t){},t.prototype.ki=function(t,e){var n=new eh(e,0),r=this.qc.Pe(n);return Xu.resolve(e.isEqual(r&&r.key))},t.prototype.Oi=function(t){return Xu.resolve()},t.prototype.Wc=function(t,e){return this.Qc(t)},t.prototype.Qc=function(t){return 0===this.Ho.length?0:t-this.Ho[0].batchId},t.prototype.Uc=function(t){var e=this.Qc(t);return e<0||e>=this.Ho.length?null:this.Ho[e]},t}(),rh=function(){function t(t,e){this.Ti=t,this.jc=e,this.docs=new Fs(Mi.J),this.size=0}return t.prototype.ui=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.jc(e);return this.docs=this.docs.Ht(r,{li:e,size:s,readTime:n}),this.size+=s-o,this.Ti.Us(t,r.path.Z())},t.prototype._i=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.fi=function(t,e){var n=this.docs.get(e);return Xu.resolve(n?n.li:null)},t.prototype.getEntries=function(t,e){var n=this,r=Js();return e.forEach(function(t){var e=n.docs.get(t);r=r.Ht(t,e?e.li:null)}),Xu.resolve(r)},t.prototype.Wr=function(t,e,n){for(var r=Ws(),i=new Mi(e.path.child("")),o=this.docs.ne(i);o.ae();){var s=o.ce(),u=s.value,a=u.li,c=u.readTime;if(!e.path.st(s.key.path))break;c.u(n)<=0||a instanceof yo&&$o(e,a)&&(r=r.Ht(a.key,a))}return Xu.resolve(r)},t.prototype.Gc=function(t,e){return Xu.forEach(this.docs,function(t){return e(t)})},t.prototype.Fr=function(t){return new ih(this)},t.prototype.Mr=function(t){return Xu.resolve(this.size)},t}(),ih=function(t){function e(e){var n=this;return(n=t.call(this)||this).Gr=e,n}return Object($r.d)(e,t),e.prototype.Ei=function(t){var e=this,n=[];return this.oi.forEach(function(r,i){i&&i.li?n.push(e.Gr.ui(t,i.li,e.ai(r))):e.Gr._i(r)}),Xu.$n(n)},e.prototype.di=function(t,e){return this.Gr.fi(t,e)},e.prototype.wi=function(t,e){return this.Gr.getEntries(t,e)},e}(nc),oh=function(){function t(t){this.persistence=t,this.zc=new ec(function(t){return Io(t)},_o),this.lastRemoteSnapshotVersion=ki.min(),this.highestTargetId=0,this.Hc=0,this.Jc=new th,this.targetCount=0,this.Yc=hc.$i()}return t.prototype.mn=function(t,e){return this.zc.forEach(function(t,n){return e(n)}),Xu.resolve()},t.prototype.Ki=function(t){return Xu.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Wi=function(t){return Xu.resolve(this.Hc)},t.prototype.qi=function(t){return this.highestTargetId=this.Yc.next(),Xu.resolve(this.highestTargetId)},t.prototype.ji=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hc&&(this.Hc=e),Xu.resolve()},t.prototype.zi=function(t){this.zc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yc=new hc(e),this.highestTargetId=e),t.sequenceNumber>this.Hc&&(this.Hc=t.sequenceNumber)},t.prototype.Gi=function(t,e){return this.zi(e),this.targetCount+=1,Xu.resolve()},t.prototype.Ji=function(t,e){return this.zi(e),Xu.resolve()},t.prototype.Yi=function(t,e){return this.zc.delete(e.target),this.Jc.kc(e.targetId),this.targetCount-=1,Xu.resolve()},t.prototype.Zi=function(t,e,n){var r=this,i=0,o=[];return this.zc.forEach(function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.zc.delete(s),o.push(r.Xi(t,u.targetId)),i++)}),Xu.$n(o).next(function(){return i})},t.prototype.tr=function(t){return Xu.resolve(this.targetCount)},t.prototype.er=function(t,e){var n=this.zc.get(e)||null;return Xu.resolve(n)},t.prototype.nr=function(t,e,n){return this.Jc.Nc(e,n),Xu.resolve()},t.prototype.ir=function(t,e,n){this.Jc.Oc(e,n);var r=this.persistence.Ii,i=[];return r&&e.forEach(function(e){i.push(r.Fi(t,e))}),Xu.$n(i)},t.prototype.Xi=function(t,e){return this.Jc.kc(e),Xu.resolve()},t.prototype.cr=function(t,e){var n=this.Jc.Lc(e);return Xu.resolve(n)},t.prototype.ki=function(t,e){return Xu.resolve(this.Jc.ki(e))},t}(),sh=function(){function t(t,e){var n=this;this.Xc={},this.io=new Ai(0),this.ro=!1,this.ro=!0,this.Ii=t(this),this.fo=new oh(this),this.Ti=new Ja,this.wo=function(t,e){return new rh(t,function(t){return n.Ii.Zc(t)})}(this.Ti),this.Kt=new Ca(e),this.Eo=new $c(this.Kt)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Lo=function(){return this.ro=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),t.prototype.yo=function(){},t.prototype.Vo=function(){},t.prototype.Wo=function(){return this.Ti},t.prototype.Ko=function(t){var e=this.Xc[t.R()];return e||(e=new nh(this.Ti,this.Ii),this.Xc[t.R()]=e),e},t.prototype.Dr=function(){return this.fo},t.prototype.Or=function(){return this.wo},t.prototype.jo=function(){return this.Eo},t.prototype.runTransaction=function(t,e,n){var r=this;ni("MemoryPersistence","Starting transaction:",t);var i=new uh(this.io.next());return this.Ii.ta(),n(i).next(function(t){return r.Ii.ea(i).next(function(){return t})}).Mn().then(function(t){return i.ps(),t})},t.prototype.na=function(t,e){return Xu.Bn(Object.values(this.Xc).map(function(n){return function(){return n.ki(t,e)}}))},t}(),uh=function(t){function e(e){var n=this;return(n=t.call(this)||this).vs=e,n}return Object($r.d)(e,t),e}(aa),ah=function(){function t(t){this.persistence=t,this.sa=new th,this.ia=null}return t.ra=function(e){return new t(e)},Object.defineProperty(t.prototype,"oa",{get:function(){if(this.ia)return this.ia;throw si()},enumerable:!1,configurable:!0}),t.prototype.sr=function(t,e,n){return this.sa.sr(n,e),this.oa.delete(n.toString()),Xu.resolve()},t.prototype.rr=function(t,e,n){return this.sa.rr(n,e),this.oa.add(n.toString()),Xu.resolve()},t.prototype.Fi=function(t,e){return this.oa.add(e.toString()),Xu.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.sa.kc(e.targetId).forEach(function(t){return n.oa.add(t.toString())});var r=this.persistence.Dr();return r.cr(t,e.targetId).next(function(t){t.forEach(function(t){return n.oa.add(t.toString())})}).next(function(){return r.Yi(t,e)})},t.prototype.ta=function(){this.ia=new Set},t.prototype.ea=function(t){var e=this,n=this.persistence.Or().Fr();return Xu.forEach(this.oa,function(r){var i=Mi.ft(r);return e.ca(t,i).next(function(t){t||n._i(i)})}).next(function(){return e.ia=null,n.apply(t)})},t.prototype.kr=function(t,e){var n=this;return this.ca(t,e).next(function(t){t?n.oa.delete(e.toString()):n.oa.add(e.toString())})},t.prototype.Zc=function(t){return 0},t.prototype.ca=function(t,e){var n=this;return Xu.Bn([function(){return Xu.resolve(n.sa.ki(e))},function(){return n.persistence.Dr().ki(t,e)},function(){return n.persistence.na(t,e)}])},t}();function ch(t,e){return"firestore_clients_"+t+"_"+e}function hh(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.A()&&(r+="_"+e.uid),r}function fh(t,e){return"firestore_targets_"+t+"_"+e}var lh=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.aa=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new yi(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(ri("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),ph=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.aa=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new yi(r.error.code,r.error.message)),i?new t(e,r.state,o):(ri("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),dh=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.aa=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=nu(),s=0;i&&s<r.activeTargetIds.length;++s)i=Yi(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(ri("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),vh=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.aa=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(ri("SharedClientState","Failed to parse online state: "+e),null)},t}(),yh=function(){function t(){this.activeTargetIds=nu()}return t.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.la=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ua=function(){var t={activeTargetIds:this.activeTargetIds.rt(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),gh=function(){function t(t,e,n,r,i){this.window=t,this.eo=e,this.persistenceKey=n,this._a=r,this.fa=null,this.da=null,this.L=null,this.wa=this.Ea.bind(this),this.Ta=new Fs(fi),this.Tr=!1,this.Ia=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ma=ch(this.persistenceKey,this._a),this.Aa=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Ta=this.Ta.Ht(this._a,new yh),this.Ra=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Pa=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.ya=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.ga=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Va=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.wa)}return t.Wn=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object($r.b)(this,void 0,void 0,function(){var t,e,n,r,i,o,s,u,a,c,h=this;return Object($r.e)(this,function(f){switch(f.label){case 0:return[4,this.fa.Qo()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this._a&&(i=this.getItem(ch(this.persistenceKey,r)))&&(o=dh.aa(r,i))&&(this.Ta=this.Ta.Ht(o.clientId,o));for(this.pa(),(s=this.storage.getItem(this.ga))&&(u=this.ba(s))&&this.va(u),a=0,c=this.Ia;a<c.length;a++)this.Ea(c[a]);return this.Ia=[],this.window.addEventListener("unload",function(){return h.Lo()}),this.Tr=!0,[2]}})})},t.prototype.q=function(t){this.setItem(this.Aa,JSON.stringify(t))},t.prototype.Sa=function(){return this.Da(this.Ta)},t.prototype.Ca=function(t){var e=!1;return this.Ta.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.xa=function(t){this.Na(t,"pending")},t.prototype.Fa=function(t,e,n){this.Na(t,e,n),this.Oa(t)},t.prototype.ka=function(t){var e="not-current";if(this.Ca(t)){var n=this.storage.getItem(fh(this.persistenceKey,t));if(n){var r=ph.aa(t,n);r&&(e=r.state)}}return this.Ma.ha(t),this.pa(),e},t.prototype.La=function(t){this.Ma.la(t),this.pa()},t.prototype.$a=function(t){return this.Ma.activeTargetIds.has(t)},t.prototype.Ba=function(t){this.removeItem(fh(this.persistenceKey,t))},t.prototype.qa=function(t,e,n){this.Ua(t,e,n)},t.prototype.Qa=function(t,e,n){var r=this;e.forEach(function(t){r.Oa(t)}),this.currentUser=t,n.forEach(function(t){r.xa(t)})},t.prototype.Ka=function(t){this.Wa(t)},t.prototype.ja=function(){this.Ga()},t.prototype.Lo=function(){this.Tr&&(this.window.removeEventListener("storage",this.wa),this.removeItem(this.ma),this.Tr=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return ni("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){ni("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){ni("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Ea=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(ni("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ma)return void ri("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.eo.bo(function(){return Object($r.b)(e,void 0,void 0,function(){var t,e,r,i,o,s;return Object($r.e)(this,function(u){if(this.Tr){if(null!==n.key)if(this.Ra.test(n.key)){if(null==n.newValue)return t=this.za(n.key),[2,this.Ha(t,null)];if(e=this.Ja(n.key,n.newValue))return[2,this.Ha(e.clientId,e)]}else if(this.Pa.test(n.key)){if(null!==n.newValue&&(r=this.Ya(n.key,n.newValue)))return[2,this.Xa(r)]}else if(this.ya.test(n.key)){if(null!==n.newValue&&(i=this.Za(n.key,n.newValue)))return[2,this.tu(i)]}else if(n.key===this.ga){if(null!==n.newValue&&(o=this.ba(n.newValue)))return[2,this.va(o)]}else if(n.key===this.Aa)(s=function(t){var e=Ai.U;if(null!=t)try{var n=JSON.parse(t);ui("number"==typeof n),e=n}catch(t){ri("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Ai.U&&this.L(s);else if(n.key===this.Va)return[2,this.fa.eu()]}else this.Ia.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"Ma",{get:function(){return this.Ta.get(this._a)},enumerable:!1,configurable:!0}),t.prototype.pa=function(){this.setItem(this.ma,this.Ma.ua())},t.prototype.Na=function(t,e,n){var r=new lh(this.currentUser,t,e,n),i=hh(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ua())},t.prototype.Oa=function(t){var e=hh(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Wa=function(t){this.storage.setItem(this.ga,JSON.stringify({clientId:this._a,onlineState:t}))},t.prototype.Ua=function(t,e,n){var r=fh(this.persistenceKey,t),i=new ph(t,e,n);this.setItem(r,i.ua())},t.prototype.Ga=function(){this.setItem(this.Va,"value-not-used")},t.prototype.za=function(t){var e=this.Ra.exec(t);return e?e[1]:null},t.prototype.Ja=function(t,e){var n=this.za(t);return dh.aa(n,e)},t.prototype.Ya=function(t,e){var n=this.Pa.exec(t),r=Number(n[1]);return lh.aa(new Oi(void 0!==n[2]?n[2]:null),r,e)},t.prototype.Za=function(t,e){var n=this.ya.exec(t),r=Number(n[1]);return ph.aa(r,e)},t.prototype.ba=function(t){return vh.aa(t)},t.prototype.Xa=function(t){return Object($r.b)(this,void 0,void 0,function(){return Object($r.e)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.fa.nu(t.batchId,t.state,t.error)]:(ni("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.tu=function(t){return this.fa.su(t.targetId,t.state,t.error)},t.prototype.Ha=function(t,e){var n=this,r=e?this.Ta.Ht(t,e):this.Ta.remove(t),i=this.Da(this.Ta),o=this.Da(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fa.iu(s,u).then(function(){n.Ta=r})},t.prototype.va=function(t){this.Ta.get(t.clientId)&&this.da(t.onlineState)},t.prototype.Da=function(t){var e=nu();return t.forEach(function(t,n){e=e.ye(n.activeTargetIds)}),e},t}(),bh=function(){function t(){this.ru=new yh,this.ou={},this.da=null,this.L=null}return t.prototype.xa=function(t){},t.prototype.Fa=function(t,e,n){},t.prototype.ka=function(t){return this.ru.ha(t),this.ou[t]||"not-current"},t.prototype.qa=function(t,e,n){this.ou[t]=e},t.prototype.La=function(t){this.ru.la(t)},t.prototype.$a=function(t){return this.ru.activeTargetIds.has(t)},t.prototype.Ba=function(t){delete this.ou[t]},t.prototype.Sa=function(){return this.ru.activeTargetIds},t.prototype.Ca=function(t){return this.ru.activeTargetIds.has(t)},t.prototype.start=function(){return this.ru=new yh,Promise.resolve()},t.prototype.Qa=function(t,e,n){},t.prototype.Ka=function(t){},t.prototype.Lo=function(){},t.prototype.q=function(t){},t.prototype.ja=function(){},t}(),mh=function(){function t(){}return t.prototype.cu=function(t){},t.prototype.Lo=function(){},t}(),wh=function(){function t(){var t=this;this.au=function(){return t.uu()},this.hu=function(){return t.lu()},this._u=[],this.fu()}return t.prototype.cu=function(t){this._u.push(t)},t.prototype.Lo=function(){window.removeEventListener("online",this.au),window.removeEventListener("offline",this.hu)},t.prototype.fu=function(){window.addEventListener("online",this.au),window.addEventListener("offline",this.hu)},t.prototype.uu=function(){ni("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(0)},t.prototype.lu=function(){ni("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(1)},t.Wn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Ih={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},_h=function(){function t(t){this.du=t.du,this.wu=t.wu}return t.prototype.Eu=function(t){this.Tu=t},t.prototype.Iu=function(t){this.mu=t},t.prototype.onMessage=function(t){this.Au=t},t.prototype.close=function(){this.wu()},t.prototype.send=function(t){this.du(t)},t.prototype.Ru=function(){this.Tu()},t.prototype.Pu=function(t){this.mu(t)},t.prototype.yu=function(t){this.Au(t)},t}(),Eh=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.I=e.I,n}return Object($r.d)(e,t),e.prototype.Du=function(t,e,n,r){return new Promise(function(i,o){var s=new Zr;s.listenOnce(Xr.COMPLETE,function(){try{switch(s.getLastErrorCode()){case Jr.NO_ERROR:var e=s.getResponseJson();ni("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Jr.TIMEOUT:ni("Connection",'RPC "'+t+'" timed out'),o(new yi(vi.DEADLINE_EXCEEDED,"Request time out"));break;case Jr.HTTP_ERROR:var n=s.getStatus();if(ni("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(vi).indexOf(e)>=0?e:vi.UNKNOWN}(r.status);o(new yi(u,r.message))}else o(new yi(vi.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new yi(vi.UNAVAILABLE,"Connection failed."));break;default:si()}}finally{ni("Connection",'RPC "'+t+'" completed.')}});var u=JSON.stringify(r);s.send(e,"POST",u,n,15)})},e.prototype.xu=function(t,e){var n=[this.Vu,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new zr,i=He(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.I};this.Su(o.initMessageHeaders,e),Object(W.t)()||Object(W.w)()||Object(W.q)()||Object(W.s)()||Object(W.x)()||Object(W.p)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");ni("Connection","Creating WebChannel: "+s,o);var u=r.createWebChannel(s,o),a=!1,c=!1,h=new _h({du:function(t){c?ni("Connection","Not sending because WebChannel is closed:",t):(a||(ni("Connection","Opening WebChannel transport."),u.open(),a=!0),ni("Connection","WebChannel sending:",t),u.send(t))},wu:function(){return u.close()}}),f=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return f(u,Yr.EventType.OPEN,function(){c||ni("Connection","WebChannel transport opened.")}),f(u,Yr.EventType.CLOSE,function(){c||(c=!0,ni("Connection","WebChannel transport closed"),h.Pu())}),f(u,Yr.EventType.ERROR,function(t){c||(c=!0,ii("Connection","WebChannel transport errored:",t),h.Pu(new yi(vi.UNAVAILABLE,"The operation could not be completed")))}),f(u,Yr.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];ui(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){ni("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=Cs[t];if(void 0!==e)return qs(e)}(i),s=r.message;void 0===o&&(o=vi.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.Pu(new yi(o,s)),u.close()}else ni("Connection","WebChannel received:",n),h.yu(n)}}),f(i,Wr.STAT_EVENT,function(t){10===t.stat?ni("Connection","Detected buffering proxy"):11===t.stat&&ni("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Ru()},0),h},e}(function(){function t(t){this.gu=t,this.T=t.T,this.Vu=(t.ssl?"https":"http")+"://"+t.host,this.pu="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}return t.prototype.bu=function(t,e,n,r){var i=this.vu(t,e);ni("RestConnection","Sending: ",i,n);var o={};return this.Su(o,r),this.Du(t,i,o,n).then(function(t){return ni("RestConnection","Received: ",t),t},function(e){throw ii("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.Cu=function(t,e,n,r){return this.bu(t,e,n,r)},t.prototype.Su=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.4",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},t.prototype.vu=function(t,e){return this.Vu+"/v1/"+e+":"+Ih[t]},t}());function Oh(){return"undefined"!=typeof window?window:null}function Th(){return"undefined"!=typeof document?document:null}function jh(t){return new gu(t,!0)}var Sh=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.eo=t,this.ds=e,this.Nu=n,this.Fu=r,this.Ou=i,this.ku=0,this.Mu=null,this.Lu=Date.now(),this.reset()}return t.prototype.reset=function(){this.ku=0},t.prototype.$u=function(){this.ku=this.Ou},t.prototype.Bu=function(t){var e=this;this.cancel();var n=Math.floor(this.ku+this.qu()),r=Math.max(0,Date.now()-this.Lu),i=Math.max(0,n-r);i>0&&ni("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ku+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Mu=this.eo.Ir(this.ds,i,function(){return e.Lu=Date.now(),t()}),this.ku*=this.Fu,this.ku<this.Nu&&(this.ku=this.Nu),this.ku>this.Ou&&(this.ku=this.Ou)},t.prototype.Uu=function(){null!==this.Mu&&(this.Mu.Ps(),this.Mu=null)},t.prototype.cancel=function(){null!==this.Mu&&(this.Mu.cancel(),this.Mu=null)},t.prototype.qu=function(){return(Math.random()-.5)*this.ku},t}(),xh=function(){function t(t,e,n,r,i,o){this.eo=t,this.Qu=n,this.Ku=r,this.Wu=i,this.listener=o,this.state=0,this.ju=0,this.Gu=null,this.stream=null,this.zu=new Sh(t,e)}return t.prototype.Hu=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.Ju=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Yu()},t.prototype.stop=function(){return Object($r.b)(this,void 0,void 0,function(){return Object($r.e)(this,function(t){switch(t.label){case 0:return this.Hu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.Xu=function(){this.state=0,this.zu.reset()},t.prototype.Zu=function(){var t=this;this.Ju()&&null===this.Gu&&(this.Gu=this.eo.Ir(this.Qu,6e4,function(){return t.th()}))},t.prototype.eh=function(t){this.nh(),this.stream.send(t)},t.prototype.th=function(){return Object($r.b)(this,void 0,void 0,function(){return Object($r.e)(this,function(t){return this.Ju()?[2,this.close(0)]:[2]})})},t.prototype.nh=function(){this.Gu&&(this.Gu.cancel(),this.Gu=null)},t.prototype.close=function(t,e){return Object($r.b)(this,void 0,void 0,function(){return Object($r.e)(this,function(n){switch(n.label){case 0:return this.nh(),this.zu.cancel(),this.ju++,3!==t?this.zu.reset():e&&e.code===vi.RESOURCE_EXHAUSTED?(ri(e.toString()),ri("Using maximum backoff delay to prevent overloading the backend."),this.zu.$u()):e&&e.code===vi.UNAUTHENTICATED&&this.Wu.v(),null!==this.stream&&(this.sh(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Iu(e)];case 1:return n.sent(),[2]}})})},t.prototype.sh=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.ih(this.ju),n=this.ju;this.Wu.getToken().then(function(e){t.ju===n&&t.rh(e)},function(n){e(function(){var e=new yi(vi.UNKNOWN,"Fetching auth token failed: "+n.message);return t.oh(e)})})},t.prototype.rh=function(t){var e=this,n=this.ih(this.ju);this.stream=this.ah(t),this.stream.Eu(function(){n(function(){return e.state=2,e.listener.Eu()})}),this.stream.Iu(function(t){n(function(){return e.oh(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.Yu=function(){var t=this;this.state=4,this.zu.Bu(function(){return Object($r.b)(t,void 0,void 0,function(){return Object($r.e)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.oh=function(t){return ni("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.ih=function(t){var e=this;return function(n){e.eo.ys(function(){return e.ju===t?n():(ni("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),Nh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).Kt=i,s}return Object($r.d)(e,t),e.prototype.ah=function(t){return this.Ku.xu("Listen",t)},e.prototype.onMessage=function(t){this.zu.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:si()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.qt?(ui(void 0===e||"string"==typeof e),di.fromBase64String(e||"")):(ui(void 0===e||e instanceof Uint8Array),di.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(u=e.targetChange.cause)&&function(t){var e=void 0===t.code?vi.UNKNOWN:qs(t.code);return new yi(e,t.message||"")}(u);n=new hu(r,i,o,s||null)}else if("documentChange"in e){i=Tu(t,(r=e.documentChange).document.name),o=Iu(r.document.updateTime);var u=new fo({mapValue:{fields:r.document.fields}}),a=(s=new yo(i,o,u,{}),r.targetIds||[]);n=new au(a,r.removedTargetIds||[],s.key,s)}else if("documentDelete"in e)i=Tu(t,(r=e.documentDelete).document),o=r.readTime?Iu(r.readTime):ki.min(),u=new go(i,o),n=new au([],s=r.removedTargetIds||[],u.key,u);else if("documentRemove"in e)i=Tu(t,(r=e.documentRemove).document),n=new au([],o=r.removedTargetIds||[],i,null);else{if(!("filter"in e))return si();var c=e.filter;i=new Us(r=c.count||0),n=new cu(o=c.targetId,i)}return n}(this.Kt,t),n=function(t){if(!("targetChange"in t))return ki.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?ki.min():e.readTime?Iu(e.readTime):ki.min()}(t);return this.listener.uh(e,n)},e.prototype.hh=function(t){var e={};e.database=xu(this.Kt),e.addTarget=function(t,e){var n,r=e.target;return(n=Eo(r)?{documents:Cu(t,r)}:{query:Lu(t,r)}).targetId=e.targetId,e.resumeToken.o()>0?n.resumeToken=mu(t,e.resumeToken):e.Mt.u(ki.min())>0&&(n.readTime=bu(t,e.Mt.G())),n}(this.Kt,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return si()}}(0,e.kt);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.eh(e)},e.prototype.lh=function(t){var e={};e.database=xu(this.Kt),e.removeTarget=t,this.eh(e)},e}(xh),Ah=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).Kt=i,s._h=!1,s}return Object($r.d)(e,t),Object.defineProperty(e.prototype,"fh",{get:function(){return this._h},enumerable:!1,configurable:!0}),e.prototype.start=function(){this._h=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.sh=function(){this._h&&this.dh([])},e.prototype.ah=function(t){return this.Ku.xu("Write",t)},e.prototype.onMessage=function(t){if(ui(!!t.streamToken),this.lastStreamToken=t.streamToken,this._h){this.zu.reset();var e=function(t,e){return t&&t.length>0?(ui(void 0!==e),t.map(function(t){return function(t,e){var n=Iu(t.updateTime?t.updateTime:e);n.isEqual(ki.min())&&(n=Iu(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new ms(n,r)}(t,e)})):[]}(t.writeResults,t.commitTime),n=Iu(t.commitTime);return this.listener.wh(n,e)}return ui(!t.writeResults||0===t.writeResults.length),this._h=!0,this.listener.Eh()},e.prototype.Th=function(){var t={};t.database=xu(this.Kt),this.eh(t)},e.prototype.dh=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return ku(e.Kt,t)})};this.eh(n)},e}(xh),Ph=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Ku=n,i.Kt=r,i.Ih=!1,i}return Object($r.d)(e,t),e.prototype.mh=function(){if(this.Ih)throw new yi(vi.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.bu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then(function(i){return r.Ku.bu(t,e,n,i)}).catch(function(t){throw t.code===vi.UNAUTHENTICATED&&r.credentials.v(),t})},e.prototype.Cu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then(function(i){return r.Ku.Cu(t,e,n,i)}).catch(function(t){throw t.code===vi.UNAUTHENTICATED&&r.credentials.v(),t})},e.prototype.terminate=function(){this.Ih=!1},e}(function(){}),kh=function(){function t(t,e){this.fs=t,this.da=e,this.state="Unknown",this.Ah=0,this.Rh=null,this.Ph=!0}return t.prototype.yh=function(){var t=this;0===this.Ah&&(this.gh("Unknown"),this.Rh=this.fs.Ir("online_state_timeout",1e4,function(){return t.Rh=null,t.Vh("Backend didn't respond within 10 seconds."),t.gh("Offline"),Promise.resolve()}))},t.prototype.ph=function(t){"Online"===this.state?this.gh("Unknown"):(this.Ah++,this.Ah>=1&&(this.bh(),this.Vh("Connection failed 1 times. Most recent error: "+t.toString()),this.gh("Offline")))},t.prototype.set=function(t){this.bh(),this.Ah=0,"Online"===t&&(this.Ph=!1),this.gh(t)},t.prototype.gh=function(t){t!==this.state&&(this.state=t,this.da(t))},t.prototype.Vh=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ph?(ri(e),this.Ph=!1):ni("OnlineStateTracker",e)},t.prototype.bh=function(){null!==this.Rh&&(this.Rh.cancel(),this.Rh=null)},t}(),Dh=function(t,e,n,r,i){var o=this;this.Sh=t,this.Dh=e,this.fs=n,this.Ch={},this.xh=[],this.Nh=new Map,this.Fh=new Set,this.Oh=[],this.kh=i,this.kh.cu(function(t){n.ys(function(){return Object($r.b)(o,void 0,void 0,function(){return Object($r.e)(this,function(t){switch(t.label){case 0:return Bh(this)?(ni("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object($r.b)(this,void 0,void 0,function(){var e;return Object($r.e)(this,function(n){switch(n.label){case 0:return(e=ai(t)).Fh.add(4),[4,Lh(e)];case 1:return n.sent(),e.Mh.set("Unknown"),e.Fh.delete(4),[4,Ch(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Mh=new kh(n,r)};function Ch(t){return Object($r.b)(this,void 0,void 0,function(){var e,n;return Object($r.e)(this,function(r){switch(r.label){case 0:if(!Bh(t))return[3,4];e=0,n=t.Oh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Lh(t){return Object($r.b)(this,void 0,void 0,function(){var e,n;return Object($r.e)(this,function(r){switch(r.label){case 0:e=0,n=t.Oh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Rh(t,e){var n=ai(t);n.Nh.has(e.targetId)||(n.Nh.set(e.targetId,e),Fh(n)?qh(n):rf(n).Ju()&&Uh(n,e))}function Mh(t,e){var n=ai(t),r=rf(n);n.Nh.delete(e),r.Ju()&&Vh(n,e),0===n.Nh.size&&(r.Ju()?r.Zu():Bh(n)&&n.Mh.set("Unknown"))}function Uh(t,e){t.Lh.cn(e.targetId),rf(t).hh(e)}function Vh(t,e){t.Lh.cn(e),rf(t).lh(e)}function qh(t){t.Lh=new lu({Sn:function(e){return t.Ch.Sn(e)},Dn:function(e){return t.Nh.get(e)||null}}),rf(t).start(),t.Mh.yh()}function Fh(t){return Bh(t)&&!rf(t).Hu()&&t.Nh.size>0}function Bh(t){return 0===ai(t).Fh.size}function zh(t){t.Lh=void 0}function Gh(t){return Object($r.b)(this,void 0,void 0,function(){return Object($r.e)(this,function(e){return t.Nh.forEach(function(e,n){Uh(t,e)}),[2]})})}function Hh(t,e){return Object($r.b)(this,void 0,void 0,function(){return Object($r.e)(this,function(n){return zh(t),Fh(t)?(t.Mh.ph(e),qh(t)):t.Mh.set("Unknown"),[2]})})}function Kh(t,e,n){return Object($r.b)(this,void 0,void 0,function(){var r,i,o;return Object($r.e)(this,function(s){switch(s.label){case 0:if(t.Mh.set("Online"),!(e instanceof hu&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object($r.b)(this,void 0,void 0,function(){var n,r,i,o;return Object($r.e)(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.Nh.has(o=i[r])?[4,t.Ch.$h(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.Nh.delete(o),t.Lh.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),ni("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,Qh(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof au?t.Lh.wn(e):e instanceof cu?t.Lh.yn(e):t.Lh.In(e),n.isEqual(ki.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,Fc(t.Sh)];case 8:return i=s.sent(),n.u(i)>=0?[4,function(t,e){var n=t.Lh.pn(e);return n.Oe.forEach(function(n,r){if(n.resumeToken.o()>0){var i=t.Nh.get(r);i&&t.Nh.set(r,i.$t(n.resumeToken,e))}}),n.ke.forEach(function(e){var n=t.Nh.get(e);if(n){t.Nh.set(e,n.$t(di.h,n.Mt)),Vh(t,e);var r=new ns(n.target,e,1,n.sequenceNumber);Uh(t,r)}}),t.Ch.Bh(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return ni("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,Qh(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function Qh(t,e,n){return Object($r.b)(this,void 0,void 0,function(){var r=this;return Object($r.e)(this,function(i){switch(i.label){case 0:if(!ta(e))throw e;return t.Fh.add(1),[4,Lh(t)];case 1:return i.sent(),t.Mh.set("Offline"),n||(n=function(){return Fc(t.Sh)}),t.fs.bo(function(){return Object($r.b)(r,void 0,void 0,function(){return Object($r.e)(this,function(e){switch(e.label){case 0:return ni("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Fh.delete(1),[4,Ch(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function Jh(t,e){return e().catch(function(n){return Qh(t,n,e)})}function Xh(t){return Object($r.b)(this,void 0,void 0,function(){var e,n,r,i,o;return Object($r.e)(this,function(s){switch(s.label){case 0:e=ai(t),n=of(e),r=e.xh.length>0?e.xh[e.xh.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return Bh(t)&&t.xh.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,Gc(e.Sh,r)];case 3:return null===(i=s.sent())?(0===e.xh.length&&n.Zu(),[3,7]):(r=i.batchId,function(t,e){t.xh.push(e);var n=of(t);n.Ju()&&n.fh&&n.dh(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,Qh(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return Wh(e)&&Yh(e),[2]}})})}function Wh(t){return Bh(t)&&!of(t).Hu()&&t.xh.length>0}function Yh(t){of(t).start()}function Zh(t){return Object($r.b)(this,void 0,void 0,function(){return Object($r.e)(this,function(e){return of(t).Th(),[2]})})}function $h(t){return Object($r.b)(this,void 0,void 0,function(){var e,n,r;return Object($r.e)(this,function(i){for(e=of(t),n=0,r=t.xh;n<r.length;n++)e.dh(r[n].mutations);return[2]})})}function tf(t,e,n){return Object($r.b)(this,void 0,void 0,function(){var r,i;return Object($r.e)(this,function(o){switch(o.label){case 0:return r=t.xh.shift(),i=Da.from(r,e,n),[4,Jh(t,function(){return t.Ch.qh(i)})];case 1:return o.sent(),[4,Xh(t)];case 2:return o.sent(),[2]}})})}function ef(t,e){return Object($r.b)(this,void 0,void 0,function(){return Object($r.e)(this,function(n){switch(n.label){case 0:return e&&of(t).fh?[4,function(t,e){return Object($r.b)(this,void 0,void 0,function(){var n,r;return Object($r.e)(this,function(i){switch(i.label){case 0:return Vs(r=e.code)&&r!==vi.ABORTED?(n=t.xh.shift(),of(t).Xu(),[4,Jh(t,function(){return t.Ch.Uh(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,Xh(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Wh(t)&&Yh(t),[2]}})})}function nf(t,e){return Object($r.b)(this,void 0,void 0,function(){var n;return Object($r.e)(this,function(r){switch(r.label){case 0:return n=ai(t),e?(n.Fh.delete(2),[4,Ch(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Fh.add(2),[4,Lh(n)]);case 3:r.sent(),n.Mh.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function rf(t){var e=this;return t.Qh||(t.Qh=function(t,e,n){var r=ai(t);return r.mh(),new Nh(e,r.Ku,r.credentials,r.Kt,n)}(t.Dh,t.fs,{Eu:Gh.bind(null,t),Iu:Hh.bind(null,t),uh:Kh.bind(null,t)}),t.Oh.push(function(n){return Object($r.b)(e,void 0,void 0,function(){return Object($r.e)(this,function(e){switch(e.label){case 0:return n?(t.Qh.Xu(),Fh(t)?qh(t):t.Mh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Qh.stop()];case 2:e.sent(),zh(t),e.label=3;case 3:return[2]}})})})),t.Qh}function of(t){var e=this;return t.Kh||(t.Kh=function(t,e,n){var r=ai(t);return r.mh(),new Ah(e,r.Ku,r.credentials,r.Kt,n)}(t.Dh,t.fs,{Eu:Zh.bind(null,t),Iu:ef.bind(null,t),Eh:$h.bind(null,t),wh:tf.bind(null,t)}),t.Oh.push(function(n){return Object($r.b)(e,void 0,void 0,function(){return Object($r.e)(this,function(e){switch(e.label){case 0:return n?(t.Kh.Xu(),[4,Xh(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kh.stop()];case 3:e.sent(),t.xh.length>0&&(ni("RemoteStore","Stopping write stream with "+t.xh.length+" pending writes"),t.xh=[]),e.label=4;case 4:return[2]}})})})),t.Kh}var sf=function(){this.Wh=void 0,this.listeners=[]},uf=function(){this.queries=new ec(function(t){return Yo(t)},Wo),this.onlineState="Unknown",this.jh=new Set};function af(t,e){return Object($r.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return Object($r.e)(this,function(c){switch(c.label){case 0:if(n=ai(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new sf),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.Gh(r)];case 2:return s.Wh=c.sent(),[3,4];case 3:return u=c.sent(),a=sa(u,"Initialization of query '"+Zo(e.query)+"' failed"),[2,void e.onError(a)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zh(n.onlineState),o.Wh&&e.Hh(o.Wh)&&lf(n),[2]}})})}function cf(t,e){return Object($r.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object($r.e)(this,function(u){return n=ai(t),i=!1,(o=n.queries.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.Jh(r))]:[2]})})}function hf(t,e){for(var n=ai(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=n.queries.get(s.query);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Hh(s)&&(r=!0);u.Wh=s}}r&&lf(n)}function ff(t,e,n){var r=ai(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function lf(t){t.jh.forEach(function(t){t.next()})}var pf=function(){function t(t,e,n){this.query=t,this.Yh=e,this.Xh=!1,this.Zh=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new ou(t.query,t.docs,t.De,e,t.Ce,t.fromCache,t.xe,!0)}var o=!1;return this.Xh?this.tl(t)&&(this.Yh.next(t),o=!0):this.el(t,this.onlineState)&&(this.nl(t),o=!0),this.Zh=t,o},t.prototype.onError=function(t){this.Yh.error(t)},t.prototype.zh=function(t){this.onlineState=t;var e=!1;return this.Zh&&!this.Xh&&this.el(this.Zh,t)&&(this.nl(this.Zh),e=!0),e},t.prototype.el=function(t,e){return!t.fromCache||!(this.options.sl&&"Offline"!==e||t.docs.nt()&&"Offline"!==e)},t.prototype.tl=function(t){return t.docChanges.length>0||!!(t.xe||this.Zh&&this.Zh.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.nl=function(t){t=ou.Fe(t.query,t.docs,t.Ce,t.fromCache),this.Xh=!0,this.Yh.next(t)},t}(),df=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.il=function(){return"metadata"in this.payload},t}(),vf=function(){function t(t){this.Kt=t}return t.prototype.yc=function(t){return Tu(this.Kt,t)},t.prototype.gc=function(t){return t.metadata.exists?Pu(this.Kt,t.document,!1):new go(this.yc(t.metadata.name),this.Vc(t.metadata.readTime))},t.prototype.Vc=function(t){return Iu(t)},t}();!function(){function t(t,e,n){this.rl=t,this.Sh=e,this.Kt=n,this.queries=[],this.documents=[],this.progress=function(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(t)}t.prototype.ol=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.cl=function(t){for(var e=new Map,n=new vf(this.Kt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.yc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||tu()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return Object($r.b)(this,void 0,void 0,function(){var t,e,n,r,i;return Object($r.e)(this,function(o){switch(o.label){case 0:return[4,Yc(this.Sh,new vf(this.Kt),this.documents,this.rl.id)];case 1:t=o.sent(),e=this.cl(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?[4,Zc(this.Sh,i=r[n],e.get(i.name))]:[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Dc(Object.assign({},this.progress),t))]}})})}}();var yf=function(t){this.key=t},gf=function(t){this.key=t},bf=function(){function t(t,e){this.query=t,this.al=e,this.ul=null,this.qe=!1,this.hl=tu(),this.Ce=tu(),this.ll=ts(t),this._l=new ru(this.ll)}return Object.defineProperty(t.prototype,"fl",{get:function(){return this.al},enumerable:!1,configurable:!0}),t.prototype.dl=function(t,e){var n=this,r=e?e.wl:new iu,i=e?e._l:this._l,o=e?e.Ce:this.Ce,s=i,u=!1,a=Bo(this.query)&&i.size===this.query.limit?i.last():null,c=zo(this.query)&&i.size===this.query.limit?i.first():null;if(t.Zt(function(t,e){var h=i.get(t),f=e instanceof yo?e:null;f&&(f=$o(n.query,f)?f:null);var l=!!h&&n.Ce.has(h.key),p=!!f&&(f.bt||n.Ce.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.El(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.ll(f,a)>0||c&&n.ll(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),Bo(this.query)||zo(this.query))for(;s.size>this.query.limit;){var h=Bo(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{_l:s,wl:r,_c:u,Ce:o}},t.prototype.El=function(t,e){return t.bt&&e.hasCommittedMutations&&!e.bt},t.prototype.Ei=function(t,e,n){var r=this,i=this._l;this._l=t._l,this.Ce=t.Ce;var o=t.wl.Se();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return si()}};return n(t)-n(e)}(t.type,e.type)||r.ll(t.doc,e.doc)}),this.Tl(n);var s=e?this.Il():[],u=0===this.hl.size&&this.qe?1:0,a=u!==this.ul;return this.ul=u,0!==o.length||a?{snapshot:new ou(this.query,t._l,i,o,t.Ce,0===u,a,!1),ml:s}:{ml:s}},t.prototype.zh=function(t){return this.qe&&"Offline"===t?(this.qe=!1,this.Ei({_l:this._l,wl:new iu,Ce:this.Ce,_c:!1},!1)):{ml:[]}},t.prototype.Al=function(t){return!this.al.has(t)&&!!this._l.has(t)&&!this._l.get(t).bt},t.prototype.Tl=function(t){var e=this;t&&(t.Ue.forEach(function(t){return e.al=e.al.add(t)}),t.Qe.forEach(function(t){}),t.Ke.forEach(function(t){return e.al=e.al.delete(t)}),this.qe=t.qe)},t.prototype.Il=function(){var t=this;if(!this.qe)return[];var e=this.hl;this.hl=tu(),this._l.forEach(function(e){t.Al(e.key)&&(t.hl=t.hl.add(e.key))});var n=[];return e.forEach(function(e){t.hl.has(e)||n.push(new gf(e))}),this.hl.forEach(function(t){e.has(t)||n.push(new yf(t))}),n},t.prototype.Rl=function(t){this.al=t.Pc,this.hl=tu();var e=this.dl(t.documents);return this.Ei(e,!0)},t.prototype.Pl=function(){return ou.Fe(this.query,this._l,this.Ce,0===this.ul)},t}(),mf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},wf=function(t){this.key=t,this.yl=!1},If=function(){function t(t,e,n,r,i,o){this.Sh=t,this.gl=e,this.Vl=n,this.pl=r,this.currentUser=i,this.bl=o,this.vl={},this.Sl=new ec(function(t){return Yo(t)},Wo),this.Dl=new Map,this.Cl=[],this.xl=new Fs(Mi.J),this.Nl=new Map,this.Fl=new th,this.Ol={},this.kl=new Map,this.Ml=hc.Bi(),this.onlineState="Unknown",this.Ll=void 0}return Object.defineProperty(t.prototype,"$l",{get:function(){return!0===this.Ll},enumerable:!1,configurable:!0}),t}();function _f(t,e){return Object($r.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object($r.e)(this,function(u){switch(u.label){case 0:return n=Yf(t),(i=n.Sl.get(e))?(n.pl.ka(i.targetId),r=i.view.Pl(),[3,4]):[3,1];case 1:return[4,Hc(n.Sh,Jo(e))];case 2:return o=u.sent(),s=n.pl.ka(o.targetId),[4,Ef(n,e,o.targetId,"current"===s)];case 3:r=u.sent(),n.$l&&Rh(n.gl,o),u.label=4;case 4:return[2,r]}})})}function Ef(t,e,n,r){return Object($r.b)(this,void 0,void 0,function(){var i,o,s,u,a,c;return Object($r.e)(this,function(h){switch(h.label){case 0:return t.Bl=function(e,n,r){return function(t,e,n,r){return Object($r.b)(this,void 0,void 0,function(){var i,o,s;return Object($r.e)(this,function(u){switch(u.label){case 0:return(i=e.view.dl(n))._c?[4,Qc(t.Sh,e.query,!1).then(function(t){return e.view.dl(t.documents,i)})]:[3,2];case 1:i=u.sent(),u.label=2;case 2:return o=r&&r.Oe.get(e.targetId),s=e.view.Ei(i,t.$l,o),[2,(Rf(t,e.targetId,s.ml),s.snapshot)]}})})}(t,e,n,r)},[4,Qc(t.Sh,e,!0)];case 1:return i=h.sent(),o=new bf(e,i.Pc),s=o.dl(i.documents),u=uu.Be(n,r&&"Offline"!==t.onlineState),a=o.Ei(s,t.$l,u),Rf(t,n,a.ml),c=new mf(e,n,o),[2,(t.Sl.set(e,c),t.Dl.has(n)?t.Dl.get(n).push(e):t.Dl.set(n,[e]),a.snapshot)]}})})}function Of(t,e){return Object($r.b)(this,void 0,void 0,function(){var n,r,i;return Object($r.e)(this,function(o){switch(o.label){case 0:return n=ai(t),r=n.Sl.get(e),(i=n.Dl.get(r.targetId)).length>1?[2,(n.Dl.set(r.targetId,i.filter(function(t){return!Wo(t,e)})),void n.Sl.delete(e))]:n.$l?(n.pl.La(r.targetId),n.pl.Ca(r.targetId)?[3,2]:[4,Kc(n.Sh,r.targetId,!1).then(function(){n.pl.Ba(r.targetId),Mh(n.gl,r.targetId),Cf(n,r.targetId)}).catch(tc)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Cf(n,r.targetId),[4,Kc(n.Sh,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function Tf(t,e,n){return Object($r.b)(this,void 0,void 0,function(){var r,i,o,s;return Object($r.e)(this,function(u){switch(u.label){case 0:r=Zf(t),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,function(t,e){var n,r=ai(t),i=Pi.now(),o=e.reduce(function(t,e){return t.add(e.key)},tu());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Ic.Zo(t,o).next(function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=Ts(c,n.get(c.key));null!=h&&s.push(new Ns(c.key,h,po(h.proto.mapValue),ws.exists(!0)))}return r.Ho.Pi(t,i,s,e)})}).then(function(t){var e=t.Ns(n);return{batchId:t.batchId,oi:e}})}(r.Sh,e)];case 2:return i=u.sent(),r.pl.xa(i.batchId),function(t,e,n){var r=t.Ol[t.currentUser.R()];r||(r=new Fs(fi)),r=r.Ht(e,n),t.Ol[t.currentUser.R()]=r}(r,i.batchId,n),[4,Vf(r,i.oi)];case 3:return u.sent(),[4,Xh(r.gl)];case 4:return u.sent(),[3,6];case 5:return o=u.sent(),s=sa(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function jf(t,e){return Object($r.b)(this,void 0,void 0,function(){var n,r;return Object($r.e)(this,function(i){switch(i.label){case 0:n=ai(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Bc(n.Sh,e)];case 2:return r=i.sent(),e.Oe.forEach(function(t,e){var r=n.Nl.get(e);r&&(ui(t.Ue.size+t.Qe.size+t.Ke.size<=1),t.Ue.size>0?r.yl=!0:t.Qe.size>0?ui(r.yl):t.Ke.size>0&&(ui(r.yl),r.yl=!1))}),[4,Vf(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,tc(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function Sf(t,e,n){var r=ai(t);if(r.$l&&0===n||!r.$l&&1===n){var i=[];r.Sl.forEach(function(t,n){var r=n.view.zh(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=ai(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zh(e)&&(r=!0)}),r&&lf(n)}(r.Vl,e),i.length&&r.vl.uh(i),r.onlineState=e,r.$l&&r.pl.Ka(e)}}function xf(t,e,n){return Object($r.b)(this,void 0,void 0,function(){var r,i,o,s,u,a;return Object($r.e)(this,function(c){switch(c.label){case 0:return(r=ai(t)).pl.qa(e,"rejected",n),i=r.Nl.get(e),(o=i&&i.key)?(s=(s=new Fs(Mi.J)).Ht(o,new go(o,ki.min())),u=tu().add(o),a=new su(ki.min(),new Map,new Gs(fi),s,u),[4,jf(r,a)]):[3,2];case 1:return c.sent(),r.xl=r.xl.remove(o),r.Nl.delete(e),Uf(r),[3,4];case 2:return[4,Kc(r.Sh,e,!1).then(function(){return Cf(r,e,n)}).catch(tc)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function Nf(t,e){return Object($r.b)(this,void 0,void 0,function(){var n,r,i;return Object($r.e)(this,function(o){switch(o.label){case 0:n=ai(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,qc(n.Sh,e)];case 2:return i=o.sent(),Df(n,r,null),kf(n,r),n.pl.Fa(r,"acknowledged"),[4,Vf(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,tc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Af(t,e,n){return Object($r.b)(this,void 0,void 0,function(){var r,i;return Object($r.e)(this,function(o){switch(o.label){case 0:r=ai(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=ai(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n.Ho.yi(t,e).next(function(e){return ui(null!==e),r=e.keys(),n.Ho.xi(t,e)}).next(function(){return n.Ho.Oi(t)}).next(function(){return n.Ic.Zo(t,r)})})}(r.Sh,e)];case 2:return i=o.sent(),Df(r,e,n),kf(r,e),r.pl.Fa(e,"rejected",n),[4,Vf(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,tc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Pf(t,e){return Object($r.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object($r.e)(this,function(u){switch(u.label){case 0:Bh((n=ai(t)).gl)||ni("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,function(t){var e=ai(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Ho.pi(t)})}(n.Sh)];case 2:return-1===(r=u.sent())?[2,void e.resolve()]:((i=n.kl.get(r)||[]).push(e),n.kl.set(r,i),[3,4]);case 3:return o=u.sent(),s=sa(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}})})}function kf(t,e){(t.kl.get(e)||[]).forEach(function(t){t.resolve()}),t.kl.delete(e)}function Df(t,e,n){var r=ai(t),i=r.Ol[r.currentUser.R()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Ol[r.currentUser.R()]=i}}function Cf(t,e,n){void 0===n&&(n=null),t.pl.La(e);for(var r=0,i=t.Dl.get(e);r<i.length;r++){var o=i[r];t.Sl.delete(o),n&&t.vl.ql(o,n)}t.Dl.delete(e),t.$l&&t.Fl.kc(e).forEach(function(e){t.Fl.ki(e)||Lf(t,e)})}function Lf(t,e){var n=t.xl.get(e);null!==n&&(Mh(t.gl,n),t.xl=t.xl.remove(e),t.Nl.delete(n),Uf(t))}function Rf(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof yf?(t.Fl.sr(o.key,e),Mf(t,o)):o instanceof gf?(ni("SyncEngine","Document no longer in limbo: "+o.key),t.Fl.rr(o.key,e),t.Fl.ki(o.key)||Lf(t,o.key)):si()}}function Mf(t,e){var n=e.key;t.xl.get(n)||(ni("SyncEngine","New document in limbo: "+n),t.Cl.push(n),Uf(t))}function Uf(t){for(;t.Cl.length>0&&t.xl.size<t.bl;){var e=t.Cl.shift(),n=t.Ml.next();t.Nl.set(n,new wf(e)),t.xl=t.xl.Ht(e,n),Rh(t.gl,new ns(Jo(Fo(e.path)),n,2,Ai.U))}}function Vf(t,e,n){return Object($r.b)(this,void 0,void 0,function(){var r,i,o,s;return Object($r.e)(this,function(u){switch(u.label){case 0:return r=ai(t),i=[],o=[],s=[],r.Sl.nt()?[3,3]:(r.Sl.forEach(function(t,u){s.push(r.Bl(u,e,n).then(function(t){if(t){r.$l&&r.pl.qa(u.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Lc.cc(u.targetId,t);o.push(e)}}))}),[4,Promise.all(s)]);case 1:return u.sent(),r.vl.uh(i),[4,function(t,e){return Object($r.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c;return Object($r.e)(this,function(h){switch(h.label){case 0:n=ai(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return Xu.forEach(e,function(e){return Xu.forEach(e.rc,function(r){return n.persistence.Ii.sr(t,e.targetId,r)}).next(function(){return Xu.forEach(e.oc,function(r){return n.persistence.Ii.rr(t,e.targetId,r)})})})})];case 2:return h.sent(),[3,4];case 3:if(!ta(r=h.sent()))throw r;return ni("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)u=(s=o[i]).targetId,s.fromCache||(a=n.dc.get(u),c=a.Bt(a.Mt),n.dc=n.dc.Ht(u,c));return[2]}})})}(r.Sh,o)];case 2:u.sent(),u.label=3;case 3:return[2]}})})}function qf(t,e){return Object($r.b)(this,void 0,void 0,function(){var n,r;return Object($r.e)(this,function(i){switch(i.label){case 0:return(n=ai(t)).currentUser.isEqual(e)?[3,3]:(ni("SyncEngine","User change. New user:",e.R()),[4,Vc(n.Sh,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.kl.forEach(function(t){t.forEach(function(t){t.reject(new yi(vi.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.kl.clear()}(n),n.pl.Qa(e,r.Ac,r.Rc),[4,Vf(n,r.mc)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function Ff(t,e){var n=ai(t),r=n.Nl.get(e);if(r&&r.yl)return tu().add(r.key);var i=tu(),o=n.Dl.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=n.Sl.get(u[s]);i=i.ye(a.view.fl)}return i}function Bf(t,e){return Object($r.b)(this,void 0,void 0,function(){var n,r,i;return Object($r.e)(this,function(o){switch(o.label){case 0:return[4,Qc((n=ai(t)).Sh,e.query,!0)];case 1:return r=o.sent(),i=e.view.Rl(r),[2,(n.$l&&Rf(n,e.targetId,i.ml),i)]}})})}function zf(t){return Object($r.b)(this,void 0,void 0,function(){var e;return Object($r.e)(this,function(n){return[2,Xc((e=ai(t)).Sh).then(function(t){return Vf(e,t)})]})})}function Gf(t,e,n,r){return Object($r.b)(this,void 0,void 0,function(){var i,o;return Object($r.e)(this,function(s){switch(s.label){case 0:return[4,function(t,e){var n=ai(t),r=ai(n.Ho);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.gi(t,e).next(function(e){return e?n.Ic.Zo(t,e):Xu.resolve(null)})})}((i=ai(t)).Sh,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,Xh(i.gl)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Df(i,e,r||null),kf(i,e),function(t,e){ai(ai(t).Ho).Ni(e)}(i.Sh,e)):si(),s.label=4;case 4:return[4,Vf(i,o)];case 5:return s.sent(),[3,7];case 6:ni("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}function Hf(t,e){return Object($r.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return Object($r.e)(this,function(c){switch(c.label){case 0:return Yf(n=ai(t)),Zf(n),!0!==e||!0===n.Ll?[3,3]:(r=n.pl.Sa(),[4,Kf(n,r.rt())]);case 1:return i=c.sent(),n.Ll=!0,[4,nf(n.gl,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)Rh(n.gl,s[o]);return[3,7];case 3:return!1!==e||!1===n.Ll?[3,7]:(u=[],a=Promise.resolve(),n.Dl.forEach(function(t,e){n.pl.$a(e)?u.push(e):a=a.then(function(){return Cf(n,e),Kc(n.Sh,e,!0)}),Mh(n.gl,e)}),[4,a]);case 4:return c.sent(),[4,Kf(n,u)];case 5:return c.sent(),function(t){var e=ai(t);e.Nl.forEach(function(t,n){Mh(e.gl,n)}),e.Fl.Mc(),e.Nl=new Map,e.xl=new Fs(Mi.J)}(n),n.Ll=!1,[4,nf(n.gl,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})}function Kf(t,e,n){return Object($r.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c,h,f,l,p,d;return Object($r.e)(this,function(v){switch(v.label){case 0:n=ai(t),r=[],i=[],o=0,s=e,v.label=1;case 1:return o<s.length?(a=void 0,(c=n.Dl.get(u=s[o]))&&0!==c.length?[4,Hc(n.Sh,Jo(c[0]))]:[3,7]):[3,13];case 2:a=v.sent(),h=0,f=c,v.label=3;case 3:return h<f.length?(l=n.Sl.get(f[h]),[4,Bf(n,l)]):[3,6];case 4:(p=v.sent()).snapshot&&i.push(p.snapshot),v.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,Jc(n.Sh,u)];case 8:return d=v.sent(),[4,Hc(n.Sh,d)];case 9:return a=v.sent(),[4,Ef(n,Qf(d),u,!1)];case 10:v.sent(),v.label=11;case 11:r.push(a),v.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vl.uh(i),r)]}})})}function Qf(t){return qo(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Jf(t){var e=ai(t);return ai(ai(e.Sh).persistence).Qo()}function Xf(t,e,n,r){return Object($r.b)(this,void 0,void 0,function(){var i,o,s;return Object($r.e)(this,function(u){switch(u.label){case 0:return(i=ai(t)).Ll?(ni("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Dl.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Xc(i.Sh)];case 3:return o=u.sent(),s=su.$e(e,"current"===n),[4,Vf(i,o,s)];case 4:return u.sent(),[3,8];case 5:return[4,Kc(i.Sh,e,!0)];case 6:return u.sent(),Cf(i,e,r),[3,8];case 7:si(),u.label=8;case 8:return[2]}})})}function Wf(t,e,n){return Object($r.b)(this,void 0,void 0,function(){var r,i,o,s,u,a,c,h,f;return Object($r.e)(this,function(l){switch(l.label){case 0:if(!(r=Yf(t)).Ll)return[3,10];i=0,o=e,l.label=1;case 1:return i<o.length?r.Dl.has(s=o[i])?(ni("SyncEngine","Adding an already active target "+s),[3,5]):[4,Jc(r.Sh,s)]:[3,6];case 2:return u=l.sent(),[4,Hc(r.Sh,u)];case 3:return a=l.sent(),[4,Ef(r,Qf(u),a.targetId,!1)];case 4:l.sent(),Rh(r.gl,a),l.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object($r.e)(this,function(e){switch(e.label){case 0:return r.Dl.has(t)?[4,Kc(r.Sh,t,!1).then(function(){Mh(r.gl,t),Cf(r,t)}).catch(tc)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=0,f=n,l.label=7;case 7:return h<f.length?[5,c(f[h])]:[3,10];case 8:l.sent(),l.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function Yf(t){var e=ai(t);return e.gl.Ch.Bh=jf.bind(null,e),e.gl.Ch.Sn=Ff.bind(null,e),e.gl.Ch.$h=xf.bind(null,e),e.vl.uh=hf.bind(null,e.Vl),e.vl.ql=ff.bind(null,e.Vl),e}function Zf(t){var e=ai(t);return e.gl.Ch.qh=Nf.bind(null,e),e.gl.Ch.Uh=Af.bind(null,e),e}var $f=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object($r.b)(this,void 0,void 0,function(){return Object($r.e)(this,function(e){switch(e.label){case 0:return this.Kt=jh(t.gu.T),this.pl=this.jl(t),this.persistence=this.Gl(t),[4,this.persistence.start()];case 1:return e.sent(),this.zl=this.Hl(t),this.Sh=this.Jl(t),[2]}})})},t.prototype.Hl=function(t){return null},t.prototype.Jl=function(t){return Uc(this.persistence,new Rc,t.Yl,this.Kt)},t.prototype.Gl=function(t){return new sh(ah.ra,this.Kt)},t.prototype.jl=function(t){return new bh},t.prototype.terminate=function(){return Object($r.b)(this,void 0,void 0,function(){return Object($r.e)(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.pl.Lo()];case 1:return t.sent(),[4,this.persistence.Lo()];case 2:return t.sent(),[2]}})})},t}(),tl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object($r.d)(e,t),e.prototype.initialize=function(e){return Object($r.b)(this,void 0,void 0,function(){return Object($r.e)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,Wc(this.Sh)];case 2:return n.sent(),[4,this.Xl.initialize(this,e)];case 3:return n.sent(),[4,Zf(this.Xl.fa)];case 4:return n.sent(),[4,Xh(this.Xl.gl)];case 5:return n.sent(),[2]}})})},e.prototype.Jl=function(t){return Uc(this.persistence,new Rc,t.Yl,this.Kt)},e.prototype.Hl=function(t){return new gc(this.persistence.Ii._r,t.fs)},e.prototype.Gl=function(t){var e=kc(t.gu.T,t.gu.persistenceKey),n=void 0!==this.cacheSizeBytes?$a.Xs(this.cacheSizeBytes):$a.ei;return new Nc(this.synchronizeTabs,e,t.clientId,n,t.fs,Oh(),Th(),this.Kt,this.pl,!!this.forceOwnership)},e.prototype.jl=function(t){return new bh},e}($f),el=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Xl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object($r.d)(e,t),e.prototype.initialize=function(e){return Object($r.b)(this,void 0,void 0,function(){var n,r=this;return Object($r.e)(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Xl.fa,this.pl instanceof gh?(this.pl.fa={nu:Gf.bind(null,n),su:Xf.bind(null,n),iu:Wf.bind(null,n),Qo:Jf.bind(null,n),eu:zf.bind(null,n)},[4,this.pl.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.Po(function(t){return Object($r.b)(r,void 0,void 0,function(){return Object($r.e)(this,function(e){switch(e.label){case 0:return[4,Hf(this.Xl.fa,t)];case 1:return e.sent(),this.zl&&(t&&!this.zl.Tr?this.zl.start(this.Sh):t||this.zl.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.jl=function(t){var e=Oh();if(!gh.Wn(e))throw new yi(vi.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=kc(t.gu.T,t.gu.persistenceKey);return new gh(e,t.fs,n,t.clientId,t.Yl)},e}(tl),nl=function(){function t(){}return t.prototype.initialize=function(t,e){return Object($r.b)(this,void 0,void 0,function(){var n=this;return Object($r.e)(this,function(r){switch(r.label){case 0:return this.Sh?[3,2]:(this.Sh=t.Sh,this.pl=t.pl,this.Dh=this.Zl(e),this.gl=this.t_(e),this.Vl=this.e_(e),this.fa=this.n_(e,!t.synchronizeTabs),this.pl.da=function(t){return Sf(n.fa,t,1)},this.gl.Ch.s_=qf.bind(null,this.fa),[4,nf(this.gl,this.fa.$l)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.e_=function(t){return new uf},t.prototype.Zl=function(t){var e=jh(t.gu.T),n=new Eh(t.gu);return function(t,e,n){return new Ph(t,e,n)}(t.credentials,n,e)},t.prototype.t_=function(t){var e,n,r,i,o,s=this;return e=this.Sh,n=this.Dh,r=t.fs,i=function(t){return Sf(s.fa,t,0)},o=wh.Wn()?new wh:new mh,new Dh(e,n,r,i,o)},t.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){var u=new If(t,e,n,r,i,o);return s&&(u.Ll=!0),u}(this.Sh,this.gl,this.Vl,this.pl,t.Yl,t.bl,e)},t.prototype.terminate=function(){return function(t){return Object($r.b)(this,void 0,void 0,function(){var e;return Object($r.e)(this,function(n){switch(n.label){case 0:return e=ai(t),ni("RemoteStore","RemoteStore shutting down."),e.Fh.add(5),[4,Lh(e)];case 1:return n.sent(),e.kh.Lo(),e.Mh.set("Unknown"),[2]}})})}(this.gl)},t}(),rl=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.r_=function(){this.muted=!0},t.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),il=(function(){function t(t,e){var n=this;this.o_=t,this.Kt=e,this.metadata=new Ju,this.buffer=new Uint8Array,this.c_=new TextDecoder("utf-8"),this.a_().then(function(t){t&&t.il()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}t.prototype.close=function(){return this.o_.cancel()},t.prototype.getMetadata=function(){return Object($r.b)(this,void 0,void 0,function(){return Object($r.e)(this,function(t){return[2,this.metadata.promise]})})},t.prototype.Kl=function(){return Object($r.b)(this,void 0,void 0,function(){return Object($r.e)(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.a_())]}})})},t.prototype.a_=function(){return Object($r.b)(this,void 0,void 0,function(){var t,e,n,r;return Object($r.e)(this,function(i){switch(i.label){case 0:return[4,this.u_()];case 1:return null===(t=i.sent())?[2,null]:(e=this.c_.decode(t),n=Number(e),isNaN(n)&&this.h_("length string ("+e+") is not valid number"),[4,this.l_(n)]);case 2:return r=i.sent(),[2,new df(JSON.parse(r),t.length+n)]}})})},t.prototype.__=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},t.prototype.u_=function(){return Object($r.b)(this,void 0,void 0,function(){var t,e;return Object($r.e)(this,function(n){switch(n.label){case 0:return this.__()<0?[4,this.f_()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.__())<0&&this.h_("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}})})},t.prototype.l_=function(t){return Object($r.b)(this,void 0,void 0,function(){var e;return Object($r.e)(this,function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.f_()]:[3,3];case 1:n.sent()&&this.h_("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.c_.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}})})},t.prototype.h_=function(t){throw this.o_.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.f_=function(){return Object($r.b)(this,void 0,void 0,function(){var t,e;return Object($r.e)(this,function(n){switch(n.label){case 0:return[4,this.o_.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}})})}}(),function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new yi(vi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.d_=new Ri(t)}return t.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},t}()),ol=function(t){this._methodName=t};function sl(t,e,n){if(!n)throw new yi(vi.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function ul(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new yi(vi.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function al(t,e,n,r){if(!0===e&&!0===r)throw new yi(vi.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function cl(t){if(!Mi.Et(t))throw new yi(vi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function hl(t){if(Mi.Et(t))throw new yi(vi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function fl(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":si()}function ll(t,e){if("_delegate"in t&&(t=t._),!(t instanceof e)){if(e.name===t.constructor.name)throw new yi(vi.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=fl(t);throw new yi(vi.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function pl(t,e){if(e<=0)throw new yi(vi.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var dl=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new yi(vi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new yi(vi.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,al("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),vl=new Map,yl=function(){function t(t,e){this.w_="(lite)",this.E_=new dl({}),this.T_=!1,t instanceof Ei?(this.I_=t,this.m_=new ji):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new yi(vi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ei(t.options.projectId)}(t),this.m_=new Si(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.A_)throw new yi(vi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),t.prototype.g_=function(t){if(this.T_)throw new yi(vi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new dl(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new ji;switch(t.type){case"gapi":var e=t.client;return ui(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ni(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new yi(vi.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.V_=function(){return this.E_},t.prototype.p_=function(){return this.T_=!0,this.E_},t.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},t.prototype.b_=function(){return(t=vl.get(this))&&(ni("ComponentProvider","Removing Datastore"),vl.delete(this),t.terminate()),Promise.resolve();var t},t}(),gl=function(){function t(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.S_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new ml(this.firestore,this.v_,this.S_.path.Z())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.S_)},t}(),bl=function(){function t(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.C_)},t}(),ml=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,Fo(r))||this).firestore=e,i.D_=r,i.type="collection",i}return Object($r.d)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.C_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.C_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.D_.Z();return t.nt()?null:new gl(this.firestore,null,new Mi(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.D_)},e}(bl);function wl(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof bi&&(t=t._),sl("collection","path",e),t instanceof yl)return hl(n=Ci.ct.apply(Ci,Object($r.i)([e],r))),new ml(t,null,n);if(!(t instanceof gl||t instanceof ml))throw new yi(vi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return hl(n=Ci.ct.apply(Ci,Object($r.i)([t.path],r)).child(Ci.ct(e))),new ml(t.firestore,null,n)}function Il(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof bi&&(t=t._),1===arguments.length&&(e=hi.t()),sl("doc","path",e),t instanceof yl)return cl(n=Ci.ct.apply(Ci,Object($r.i)([e],r))),new gl(t,null,new Mi(n));if(!(t instanceof gl||t instanceof ml))throw new yi(vi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return cl(n=t.D_.child(Ci.ct.apply(Ci,Object($r.i)([e],r)))),new gl(t.firestore,t instanceof ml?t.v_:null,new Mi(n))}function _l(t,e){return t instanceof bi&&(t=t._),e instanceof bi&&(e=e._),(t instanceof gl||t instanceof ml)&&(e instanceof gl||e instanceof ml)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function El(t,e){return t instanceof bi&&(t=t._),e instanceof bi&&(e=e._),t instanceof bl&&e instanceof bl&&t.firestore===e.firestore&&Wo(t.C_,e.C_)&&t.v_===e.v_}var Ol=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new yi(vi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new yi(vi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},t.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},t.prototype.K=function(t){return fi(this.x_,t.x_)||fi(this.N_,t.N_)},t}(),Tl=/^__.*__$/,jl=function(){function t(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return null!==this.zt?new Ns(t,this.data,this.zt,e,this.fieldTransforms):new xs(t,this.data,e,this.fieldTransforms)},t}(),Sl=function(){function t(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return new Ns(t,this.data,this.zt,e,this.fieldTransforms)},t}();function xl(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw si()}}var Nl=function(){function t(t,e,n,r,i,o){this.settings=t,this.T=e,this.Kt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.zt=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),t.prototype.M_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.T,this.Kt,this.ignoreUndefinedProperties,this.fieldTransforms,this.zt)},t.prototype.L_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.q_(t),r},t.prototype.U_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.O_(),r},t.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},t.prototype.K_=function(t){return Xl(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},t.prototype.contains=function(t){return void 0!==this.zt.find(function(e){return t.st(e)})||void 0!==this.fieldTransforms.find(function(e){return t.st(e.field)})},t.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},t.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(xl(this.k_)&&Tl.test(t))throw this.K_('Document fields cannot begin and end with "__"')},t}(),Al=function(){function t(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.Kt=n||jh(t)}return t.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new Nl({k_:t,methodName:e,j_:n,path:Ri.at(),B_:!1,W_:r},this.T,this.Kt,this.ignoreUndefinedProperties)},t}();function Pl(t){var e=t.p_(),n=jh(t.I_);return new Al(t.I_,!!e.ignoreUndefinedProperties,n)}function kl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);Hl("Data must be an object, but it was:",s,r);var u,a,c=zl(r,s);if(o.merge)u=new Fi(s.zt),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=Kl(e,l[f],n);if(!s.contains(p))throw new yi(vi.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Wl(h,p)||h.push(p)}u=new Fi(h),a=s.fieldTransforms.filter(function(t){return u.It(t.field)})}else u=null,a=s.fieldTransforms;return new jl(new fo(c),u,a)}var Dl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object($r.d)(e,t),e.prototype.z_=function(t){if(2!==t.k_)throw t.K_(1===t.k_?this._methodName+"() can only appear at the top level of your update data":this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.zt.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(ol);function Cl(t,e,n){return new Nl({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.T,e.Kt,e.ignoreUndefinedProperties)}var Ll=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object($r.d)(e,t),e.prototype.z_=function(t){return new bs(t.path,new hs)},e.prototype.isEqual=function(t){return t instanceof e},e}(ol),Rl=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Object($r.d)(e,t),e.prototype.z_=function(t){var e=Cl(this,t,!0),n=this.H_.map(function(t){return Bl(t,e)}),r=new fs(n);return new bs(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(ol),Ml=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Object($r.d)(e,t),e.prototype.z_=function(t){var e=Cl(this,t,!0),n=this.H_.map(function(t){return Bl(t,e)}),r=new ps(n);return new bs(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(ol),Ul=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).J_=n,r}return Object($r.d)(e,t),e.prototype.z_=function(t){var e=new vs(t.Kt,os(t.Kt,this.J_));return new bs(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(ol);function Vl(t,e,n,r){var i=t.G_(1,e,n);Hl("Data must be an object, but it was:",i,r);var o=[],s=new lo;Vi(r,function(t,r){var u=Jl(e,t,n);r instanceof bi&&(r=r._);var a=i.U_(u);if(r instanceof Dl)o.push(u);else{var c=Bl(r,a);null!=c&&(o.push(u),s.set(u,c))}});var u=new Fi(o);return new Sl(s.yt(),u,i.fieldTransforms)}function ql(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[Kl(e,r,n)],a=[i];if(o.length%2!=0)throw new yi(vi.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Kl(e,o[c])),a.push(o[c+1]);for(var h=[],f=new lo,l=u.length-1;l>=0;--l)if(!Wl(h,u[l])){var p=u[l],d=a[l];d instanceof bi&&(d=d._);var v=s.U_(p);if(d instanceof Dl)h.push(p);else{var y=Bl(d,v);null!=y&&(h.push(p),f.set(p,y))}}var g=new Fi(h);return new Sl(f.yt(),g,s.fieldTransforms)}function Fl(t,e,n,r){return void 0===r&&(r=!1),Bl(n,t.G_(r?4:3,e))}function Bl(t,e){if(t instanceof bi&&(t=t._),Gl(t))return Hl("Unsupported field value:",e,t),zl(t,e);if(t instanceof ol)return function(t,e){if(!xl(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.zt.push(e.path),t instanceof Array){if(e.settings.B_&&4!==e.k_)throw e.K_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Bl(o[i],e.Q_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof bi&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return os(e.Kt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Pi.fromDate(t);return{timestampValue:bu(e.Kt,n)}}if(t instanceof Pi)return n=new Pi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:bu(e.Kt,n)};if(t instanceof Ol)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof gi)return{bytesValue:mu(e.Kt,t.l)};if(t instanceof gl){var r=t.firestore.I_;if(!r.isEqual(n=e.T))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:_u(t.firestore.I_||e.T,t.S_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.K_("Unsupported field value: "+fl(t))}(t,e)}function zl(t,e){var n={};return qi(t)?e.path&&e.path.length>0&&e.zt.push(e.path):Vi(t,function(t,r){var i=Bl(r,e.L_(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function Gl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Pi||t instanceof Ol||t instanceof gi||t instanceof gl||t instanceof ol)}function Hl(t,e,n){if(!Gl(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=fl(n);throw e.K_("an object"===r?t+" a custom object":t+" "+r)}}function Kl(t,e,n){if(e instanceof bi&&(e=e._),e instanceof il)return e.d_;if("string"==typeof e)return Jl(t,e);throw Xl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Ql=new RegExp("[~\\*/\\[\\]]");function Jl(t,e,n){if(e.search(Ql)>=0)throw Xl("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(il.bind.apply(il,Object($r.i)([void 0],e.split("."))))).d_}catch(r){throw Xl("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Xl(t,e,n,r,i){var o=r&&!r.nt(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new yi(vi.INVALID_ARGUMENT,(u+=". ")+t+a)}function Wl(t,e){return t.some(function(t){return t.isEqual(e)})}var Yl=function(){function t(t){this.Dh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}return t.prototype.ef=function(t){return Object($r.b)(this,void 0,void 0,function(){var e,n=this;return Object($r.e)(this,function(r){switch(r.label){case 0:if(this.nf(),this.mutations.length>0)throw new yi(vi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object($r.b)(this,void 0,void 0,function(){var n,r,i,o,s,u;return Object($r.e)(this,function(a){switch(a.label){case 0:return n=ai(t),r=xu(n.Kt)+"/documents",i={documents:e.map(function(t){return Ou(n.Kt,t)})},[4,n.Cu("BatchGetDocuments",r,i)];case 1:return o=a.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){ui(!!e.found);var n=Tu(t,e.found.name),r=Iu(e.found.updateTime),i=new fo({mapValue:{fields:e.found.fields}});return new yo(n,r,i,{})}(t,e):"missing"in e?function(t,e){ui(!!e.missing),ui(!!e.readTime);var n=Tu(t,e.missing),r=Iu(e.readTime);return new go(n,r)}(t,e):si()}(n.Kt,t);s.set(e.key.toString(),e)}),u=[],[2,(e.forEach(function(t){var e=s.get(t.toString());ui(!!e),u.push(e)}),u)]}})})}(this.Dh,t)];case 1:return[2,((e=r.sent()).forEach(function(t){t instanceof go||t instanceof yo?n.sf(t):si()}),e)]}})})},t.prototype.set=function(t,e){this.write(e.F_(t,this.Gt(t))),this.tf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},t.prototype.delete=function(t){this.write(new Rs(t,this.Gt(t))),this.tf.add(t.toString())},t.prototype.commit=function(){return Object($r.b)(this,void 0,void 0,function(){var t,e=this;return Object($r.e)(this,function(n){switch(n.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return t=this.Y_,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=Mi.ft(n);e.mutations.push(new Ms(r,e.Gt(r)))}),[4,function(t,e){return Object($r.b)(this,void 0,void 0,function(){var n,r,i;return Object($r.e)(this,function(o){switch(o.label){case 0:return n=ai(t),r=xu(n.Kt)+"/documents",i={writes:e.map(function(t){return ku(n.Kt,t)})},[4,n.bu("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.Dh,this.mutations)];case 1:return n.sent(),this.X_=!0,[2]}})})},t.prototype.sf=function(t){var e;if(t instanceof yo)e=t.version;else{if(!(t instanceof go))throw si();e=ki.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new yi(vi.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},t.prototype.Gt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?ws.updateTime(e):ws.Wt()},t.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(!this.tf.has(t.toString())&&e){if(e.isEqual(ki.min()))throw new yi(vi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ws.updateTime(e)}return ws.exists(!0)},t.prototype.write=function(t){this.nf(),this.mutations.push(t)},t.prototype.nf=function(){},t}(),Zl=function(){function t(t,e,n,r){this.fs=t,this.Dh=e,this.updateFunction=n,this.Ts=r,this.cf=5,this.zu=new Sh(this.fs,"transaction_retry")}return t.prototype.run=function(){this.af()},t.prototype.af=function(){var t=this;this.zu.Bu(function(){return Object($r.b)(t,void 0,void 0,function(){var t,e,n=this;return Object($r.e)(this,function(r){return t=new Yl(this.Dh),(e=this.uf(t))&&e.then(function(e){n.fs.ys(function(){return t.commit().then(function(){n.Ts.resolve(e)}).catch(function(t){n.hf(t)})})}).catch(function(t){n.hf(t)}),[2]})})})},t.prototype.uf=function(t){try{var e=this.updateFunction(t);return!Xi(e)&&e.catch&&e.then?e:(this.Ts.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ts.reject(t),null}},t.prototype.hf=function(t){var e=this;this.cf>0&&this.lf(t)?(this.cf-=1,this.fs.ys(function(){return e.af(),Promise.resolve()})):this.Ts.reject(t)},t.prototype.lf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Vs(e)}return!1},t}(),$l=function(){function t(t,e,n){var r=this;this.credentials=t,this.fs=e,this.gu=n,this.user=Oi.UNAUTHENTICATED,this.clientId=hi.t(),this._f=function(){},this.N=new Ju,this.credentials.S(function(t){ni("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.N.resolve()})}return t.prototype.getConfiguration=function(){return Object($r.b)(this,void 0,void 0,function(){return Object($r.e)(this,function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{fs:this.fs,gu:this.gu,clientId:this.clientId,credentials:this.credentials,Yl:this.user,bl:100})]}})})},t.prototype.ff=function(t){var e=this;this._f=t,this.N.promise.then(function(){return e._f(e.user)})},t.prototype.df=function(){if(this.fs.wf)throw new yi(vi.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.fs.Ef();var e=new Ju;return this.fs.Tf(function(){return Object($r.b)(t,void 0,void 0,function(){var t,n;return Object($r.e)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.D(),e.resolve(),[3,6];case 5:return t=r.sent(),n=sa(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function tp(t,e){return Object($r.b)(this,void 0,void 0,function(){var n,r,i=this;return Object($r.e)(this,function(o){switch(o.label){case 0:return t.fs.Af(),ni("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.Yl,t.ff(function(n){r.isEqual(n)||(r=n,t.fs.bo(function(){return Object($r.b)(i,void 0,void 0,function(){return Object($r.e)(this,function(t){switch(t.label){case 0:return[4,Vc(e.Sh,n)];case 1:return t.sent(),[2]}})})}))}),e.persistence.yo(function(){return t.terminate()}),t.mf=e,[2]}})})}function ep(t,e){return Object($r.b)(this,void 0,void 0,function(){var n,r;return Object($r.e)(this,function(i){switch(i.label){case 0:return t.fs.Af(),[4,np(t)];case 1:return n=i.sent(),ni("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.ff(function(n){return t.fs.bo(function(){return function(t,e){return Object($r.b)(this,void 0,void 0,function(){var n,r;return Object($r.e)(this,function(i){switch(i.label){case 0:return(n=ai(t)).fs.Af(),ni("RemoteStore","RemoteStore received new credentials"),r=Bh(n),n.Fh.add(3),[4,Lh(n)];case 1:return i.sent(),r&&n.Mh.set("Unknown"),[4,n.Ch.s_(e)];case 2:return i.sent(),n.Fh.delete(3),[4,Ch(n)];case 3:return i.sent(),[2]}})})}(e.gl,n)})}),t.If=e,[2]}})})}function np(t){return Object($r.b)(this,void 0,void 0,function(){return Object($r.e)(this,function(e){switch(e.label){case 0:return t.mf?[3,2]:(ni("FirestoreClient","Using default OfflineComponentProvider"),[4,tp(t,new $f)]);case 1:e.sent(),e.label=2;case 2:return[2,t.mf]}})})}function rp(t){return Object($r.b)(this,void 0,void 0,function(){return Object($r.e)(this,function(e){switch(e.label){case 0:return t.If?[3,2]:(ni("FirestoreClient","Using default OnlineComponentProvider"),[4,ep(t,new nl)]);case 1:e.sent(),e.label=2;case 2:return[2,t.If]}})})}function ip(t){return np(t).then(function(t){return t.persistence})}function op(t){return np(t).then(function(t){return t.Sh})}function sp(t){return rp(t).then(function(t){return t.gl})}function up(t){return rp(t).then(function(t){return t.fa})}function ap(t){return Object($r.b)(this,void 0,void 0,function(){var e,n;return Object($r.e)(this,function(r){switch(r.label){case 0:return[4,rp(t)];case 1:return e=r.sent(),[2,((n=e.Vl).Gh=_f.bind(null,e.fa),n.Jh=Of.bind(null,e.fa),n)]}})})}function cp(t,e,n){var r=this;void 0===n&&(n={});var i=new Ju;return t.fs.ys(function(){return Object($r.b)(r,void 0,void 0,function(){var r;return Object($r.e)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new rl({next:function(o){e.ys(function(){return cf(t,s)});var u=o.docs.has(n);!u&&o.fromCache?i.reject(new yi(vi.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&o.fromCache&&r&&"server"===r.source?i.reject(new yi(vi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new pf(Fo(n.path),o,{includeMetadataChanges:!0,sl:!0});return af(t,s)},[4,ap(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.fs,e,n,i])]}})})}),i.promise}function hp(t,e,n){var r=this;void 0===n&&(n={});var i=new Ju;return t.fs.ys(function(){return Object($r.b)(r,void 0,void 0,function(){var r;return Object($r.e)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new rl({next:function(n){e.ys(function(){return cf(t,s)}),n.fromCache&&"server"===r.source?i.reject(new yi(vi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new pf(n,o,{includeMetadataChanges:!0,sl:!0});return af(t,s)},[4,ap(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.fs,e,n,i])]}})})}),i.promise}var fp=function(){function t(){var t=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.zu=new Sh(this,"async_queue_retry"),this.vf=function(){var e=Th();e&&ni("AsyncQueue","Visibility state changed to "+e.visibilityState),t.zu.Uu()};var e=Th();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.vf)}return Object.defineProperty(t.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),t.prototype.ys=function(t){this.enqueue(t)},t.prototype.Tf=function(t){this.Sf(),this.Df(t)},t.prototype.Ef=function(){if(!this.yf){this.yf=!0;var t=Th();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf)}},t.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},t.prototype.bo=function(t){var e=this;this.ys(function(){return e.Pf.push(t),e.Cf()})},t.prototype.Cf=function(){return Object($r.b)(this,void 0,void 0,function(){var t,e=this;return Object($r.e)(this,function(n){switch(n.label){case 0:if(0===this.Pf.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return n.sent(),this.Pf.shift(),this.zu.reset(),[3,4];case 3:if(!ta(t=n.sent()))throw t;return ni("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Pf.length>0&&this.zu.Bu(function(){return e.Cf()}),n.label=5;case 5:return[2]}})})},t.prototype.Df=function(t){var e=this,n=this.Rf.then(function(){return e.pf=!0,t().catch(function(t){throw e.Vf=t,e.pf=!1,ri("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.pf=!1,t})});return this.Rf=n,n},t.prototype.Ir=function(t,e,n){var r=this;this.Sf(),this.bf.indexOf(t)>-1&&(e=0);var i=oa.Is(this,t,e,n,function(t){return r.xf(t)});return this.gf.push(i),i},t.prototype.Sf=function(){this.Vf&&si()},t.prototype.Af=function(){},t.prototype.Nf=function(){return Object($r.b)(this,void 0,void 0,function(){var t;return Object($r.e)(this,function(e){switch(e.label){case 0:return[4,t=this.Rf];case 1:e.sent(),e.label=2;case 2:if(t!==this.Rf)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.Ff=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].ds===t)return!0;return!1},t.prototype.Of=function(t){var e=this;return this.Nf().then(function(){e.gf.sort(function(t,e){return t.ws-e.ws});for(var n=0,r=e.gf;n<r.length;n++){var i=r[n];if(i.Ps(),"all"!==t&&i.ds===t)break}return e.Nf()})},t.prototype.kf=function(t){this.bf.push(t)},t.prototype.xf=function(t){var e=this.gf.indexOf(t);this.gf.splice(e,1)},t}(),lp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).Mf=new fp,r.w_="name"in e?e.name:"[DEFAULT]",r}return Object($r.d)(e,t),e.prototype.b_=function(){return this.Lf||dp(this),this.Lf.terminate()},e}(yl);function pp(t){return t.Lf||dp(t),t.Lf.df(),t.Lf}function dp(t){var e=t.p_(),n=function(t,e,n){return new _i(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.I_,t.w_,e);t.Lf=new $l(t.m_,t.Mf,n)}function vp(t,e,n){var r=this,i=new Ju;return t.fs.enqueue(function(){return Object($r.b)(r,void 0,void 0,function(){var r;return Object($r.e)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,tp(t,n)];case 1:return o.sent(),[4,ep(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===vi.FAILED_PRECONDITION||t.code===vi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function yp(t){if(t.R_||t.P_)throw new yi(vi.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var gp=function(){function t(){}return t.prototype.$f=function(t,e){switch(void 0===e&&(e="none"),Zi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Gi(t.integerValue||t.doubleValue);case 3:return this.Bf(t.timestampValue);case 4:return this.qf(t,e);case 5:return t.stringValue;case 6:return this.Uf(Hi(t.bytesValue));case 7:return this.Qf(t.referenceValue);case 8:return this.Kf(t.geoPointValue);case 9:return this.Wf(t.arrayValue,e);case 10:return this.jf(t.mapValue,e);default:throw si()}},t.prototype.jf=function(t,e){var n=this,r={};return Vi(t.fields||{},function(t,i){r[t]=n.$f(i,e)}),r},t.prototype.Kf=function(t){return new Ol(Gi(t.latitude),Gi(t.longitude))},t.prototype.Wf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.$f(t,e)})},t.prototype.qf=function(t,e){switch(e){case"previous":var n=Qi(t);return null==n?null:this.$f(n,e);case"estimate":return this.Bf(Ji(t));default:return null}},t.prototype.Bf=function(t){var e=zi(t);return new Pi(e.seconds,e.nanos)},t.prototype.Gf=function(t,e){var n=Ci.ct(t);ui(Qu(n));var r=new Ei(n.get(1),n.get(3)),i=new Mi(n.X(5));return r.isEqual(e)||ri("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),bp=function(){function t(t,e,n,r,i){this.zf=t,this.Hf=e,this.S_=n,this.Jf=r,this.v_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new gl(this.zf,this.v_,this.S_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.Jf},t.prototype.data=function(){if(this.Jf){if(this.v_){var t=new mp(this.zf,this.Hf,this.S_,this.Jf,null);return this.v_.fromFirestore(t)}return this.Hf.$f(this.Jf.vt())}},t.prototype.get=function(t){if(this.Jf){var e=this.Jf.data().field(wp("DocumentSnapshot.get",t));if(null!==e)return this.Hf.$f(e)}},t}(),mp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object($r.d)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(bp);function wp(t,e){return"string"==typeof e?Jl(t,e):e instanceof bi?e._.d_:e.d_}function Ip(t){if(zo(t)&&0===t.Nt.length)throw new yi(vi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var _p=function(){};function Ep(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.Yf(t)}return t}var Op=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xf=e,i.Zf=n,i.td=r,i.type="where",i}return Object($r.d)(e,t),e.prototype.Yf=function(t){var e=Pl(t.firestore),n=function(t,e,n,r,i,o,s){var u;if(i.ht()){if("array-contains"===o||"array-contains-any"===o)throw new yi(vi.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Pp(s,o);for(var a=[],c=0,h=s;c<h.length;c++)a.push(Ap(r,t,h[c]));u={arrayValue:{values:a}}}else u=Ap(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Pp(s,o),u=Fl(n,"where",s,"in"===o||"not-in"===o);var f=Oo.create(i,o,u);return function(t,e){if(e.xt()){var n=Ho(t);if(null!==n&&!n.isEqual(e.field))throw new yi(vi.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Go(t);null!==r&&kp(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new yi(vi.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t.C_,0,e,t.firestore.I_,this.Xf,this.Zf,this.td);return new bl(t.firestore,t.v_,function(t,e){var n=t.filters.concat([e]);return new Vo(t.path,t.collectionGroup,t.Nt.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,n))},e}(_p),Tp=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Xf=e,r.ed=n,r.type="orderBy",r}return Object($r.d)(e,t),e.prototype.Yf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new yi(vi.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new yi(vi.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Lo(e,n);return function(t,e){if(null===Go(t)){var n=Ho(t);null!==n&&kp(0,n,e.field)}}(t,r),r}(t.C_,this.Xf,this.ed);return new bl(t.firestore,t.v_,function(t,e){var n=t.Nt.concat([e]);return new Vo(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,e))},e}(_p),jp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.nd=n,i.sd=r,i}return Object($r.d)(e,t),e.prototype.Yf=function(t){return new bl(t.firestore,t.v_,Xo(t.C_,this.nd,this.sd))},e}(_p),Sp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return Object($r.d)(e,t),e.prototype.Yf=function(t){var e=Np(t,this.type,this.rd,this.od);return new bl(t.firestore,t.v_,function(t,e){return new Vo(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.C_,e))},e}(_p),xp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return Object($r.d)(e,t),e.prototype.Yf=function(t){var e=Np(t,this.type,this.rd,this.od);return new bl(t.firestore,t.v_,function(t,e){return new Vo(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.C_,e))},e}(_p);function Np(t,e,n,r){if(n[0]instanceof bi&&(n[0]=n[0]._),n[0]instanceof bp)return function(t,e,n,r,i){if(!r)throw new yi(vi.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=Qo(t);s<u.length;s++){var a=u[s];if(a.field.ht())o.push(oo(e,r.key));else{var c=r.field(a.field);if(Ki(c))throw new yi(vi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.ot();throw new yi(vi.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Do(o,i)}(t.C_,t.firestore.I_,e,n[0].Jf,r);var i=Pl(t.firestore);return function(t,e,n,r,i,o){var s=t.Nt;if(i.length>s.length)throw new yi(vi.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ht()){if("string"!=typeof c)throw new yi(vi.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Ko(t)&&-1!==c.indexOf("/"))throw new yi(vi.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Ci.ct(c));if(!Mi.Et(h))throw new yi(vi.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new Mi(h);u.push(oo(e,f))}else{var l=Fl(n,r,c);u.push(l)}}return new Do(u,o)}(t.C_,t.firestore.I_,i,e,n,r)}function Ap(t,e,n){if(n instanceof bi&&(n=n._),"string"==typeof n){if(""===n)throw new yi(vi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ko(e)&&-1!==n.indexOf("/"))throw new yi(vi.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Ci.ct(n));if(!Mi.Et(r))throw new yi(vi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return oo(t,new Mi(r))}if(n instanceof gl)return oo(t,n.S_);throw new yi(vi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+fl(n)+".")}function Pp(t,e){if(!Array.isArray(t)||0===t.length)throw new yi(vi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new yi(vi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function kp(t,e,n){if(!n.isEqual(e))throw new yi(vi.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Dp(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}function Cp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Lp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object($r.d)(e,t),e.prototype.Uf=function(t){return new gi(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return new gl(this.firestore,null,e)},e}(gp),Rp=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Mp=function(t){function e(e,n,r,i,o,s){var u=this;return(u=t.call(this,e,n,r,i,s)||this).zf=e,u.ad=e,u.metadata=o,u}return Object($r.d)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.Jf){if(this.v_){var e=new Up(this.zf,this.Hf,this.S_,this.Jf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Hf.$f(this.Jf.vt(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Jf){var n=this.Jf.data().field(wp("DocumentSnapshot.get",t));if(null!==n)return this.Hf.$f(n,e.serverTimestamps)}},e}(bp),Up=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object($r.d)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Mp),Vp=function(){function t(t,e,n,r){this.zf=t,this.Hf=e,this.ud=r,this.metadata=new Rp(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.ud.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.ud.docs.forEach(function(r){t.call(e,new Up(n.zf,n.Hf,r.key,r,new Rp(n.ud.Ce.has(r.key),n.ud.fromCache),n.query.v_))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this.ud.Ne)throw new yi(vi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.hd&&this.ld===e||(this.hd=function(t,e){if(t.ud.De.nt()){var n=0;return t.ud.docChanges.map(function(e){return{type:"added",doc:new Up(t.zf,t.Hf,e.doc.key,e.doc,new Rp(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_),oldIndex:-1,newIndex:n++}})}var r=t.ud.De;return t.ud.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new Up(t.zf,t.Hf,e.doc.key,e.doc,new Rp(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:qp(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this.ld=e),this.hd},t}();function qp(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return si()}}function Fp(t,e){return t instanceof Mp&&e instanceof Mp?t.zf===e.zf&&t.S_.isEqual(e.S_)&&(null===t.Jf?null===e.Jf:t.Jf.isEqual(e.Jf))&&t.v_===e.v_:t instanceof Vp&&e instanceof Vp&&t.zf===e.zf&&El(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.ud.isEqual(e.ud)}var Bp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object($r.d)(e,t),e.prototype.Uf=function(t){return new gi(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return new gl(this.firestore,null,e)},e}(gp);function zp(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=ll(t,gl);var o=ll(t.firestore,lp),s=Pl(o);return e instanceof bi&&(e=e._),Hp(o,[("string"==typeof e||e instanceof il?ql(s,"updateDoc",t.S_,e,n,r):Vl(s,"updateDoc",t.S_,e)).F_(t.S_,ws.exists(!0))])}function Gp(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t instanceof bi&&(t=t._);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||Dp(i[u])||(s=i[u],u++);var a,c,h,f={includeMetadataChanges:s.includeMetadataChanges};if(Dp(i[u])){var l=i[u];i[u]=null===(e=l.next)||void 0===e?void 0:e.bind(l),i[u+1]=null===(n=l.error)||void 0===n?void 0:n.bind(l),i[u+2]=null===(r=l.complete)||void 0===r?void 0:r.bind(l)}if(t instanceof gl)c=ll(t.firestore,lp),h=Fo(t.S_.path),a={next:function(e){i[u]&&i[u](Kp(c,t,e))},error:i[u+1],complete:i[u+2]};else{var p=ll(t,bl);c=ll(p.firestore,lp),h=p.C_;var d=new Bp(c);a={next:function(t){i[u]&&i[u](new Vp(c,d,p,t))},error:i[u+1],complete:i[u+2]},Ip(t.C_)}return function(t,e,n,r){var i=this,o=new rl(r),s=new pf(e,o,n);return t.fs.ys(function(){return Object($r.b)(i,void 0,void 0,function(){var e;return Object($r.e)(this,function(n){switch(n.label){case 0:return e=af,[4,ap(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})}),function(){o.r_(),t.fs.ys(function(){return Object($r.b)(i,void 0,void 0,function(){var e;return Object($r.e)(this,function(n){switch(n.label){case 0:return e=cf,[4,ap(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})})}}(pp(c),h,f,a)}function Hp(t,e){return function(t,e){var n=this,r=new Ju;return t.fs.ys(function(){return Object($r.b)(n,void 0,void 0,function(){var n;return Object($r.e)(this,function(i){switch(i.label){case 0:return n=Tf,[4,up(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(pp(t),e)}function Kp(t,e,n){var r=n.docs.get(e.S_),i=new Bp(t);return new Mp(t,i,e.S_,r,new Rp(n.hasPendingWrites,n.fromCache),e.v_)}var Qp=function(){function t(t,e){this.zf=t,this._d=e,this.fd=[],this.dd=!1,this.wd=Pl(t)}return t.prototype.set=function(t,e,n){this.Ed();var r=Jp(t,this.zf),i=Cp(r.v_,e,n),o=kl(this.wd,"WriteBatch.set",r.S_,i,null!==r.v_,n);return this.fd.push(o.F_(r.S_,ws.Wt())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Ed();var o,s=Jp(t,this.zf);return e instanceof bi&&(e=e._),o="string"==typeof e||e instanceof il?ql(this.wd,"WriteBatch.update",s.S_,e,n,r):Vl(this.wd,"WriteBatch.update",s.S_,e),this.fd.push(o.F_(s.S_,ws.exists(!0))),this},t.prototype.delete=function(t){this.Ed();var e=Jp(t,this.zf);return this.fd=this.fd.concat(new Rs(e.S_,ws.Wt())),this},t.prototype.commit=function(){return this.Ed(),this.dd=!0,this.fd.length>0?this._d(this.fd):Promise.resolve()},t.prototype.Ed=function(){if(this.dd)throw new yi(vi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function Jp(t,e){if(t instanceof bi&&(t=t._),t.firestore!==e)throw new yi(vi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Xp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).zf=e,r}return Object($r.d)(e,t),e.prototype.get=function(e){var n=this,r=Jp(e,this.zf),i=new Bp(this.zf);return t.prototype.get.call(this,e).then(function(t){return new Mp(n.zf,i,r.S_,t.Jf,new Rp(!1,!1),r.v_)})},e}(function(){function t(t,e){this.zf=t,this.Td=e,this.wd=Pl(t)}return t.prototype.get=function(t){var e=this,n=Jp(t,this.zf),r=new Lp(this.zf);return this.Td.ef([n.S_]).then(function(t){if(!t||1!==t.length)return si();var i=t[0];if(i instanceof go)return new bp(e.zf,r,n.S_,null,n.v_);if(i instanceof yo)return new bp(e.zf,r,i.key,i,n.v_);throw si()})},t.prototype.set=function(t,e,n){var r=Jp(t,this.zf),i=Cp(r.v_,e,n),o=kl(this.wd,"Transaction.set",r.S_,i,null!==r.v_,n);return this.Td.set(r.S_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=Jp(t,this.zf);return e instanceof bi&&(e=e._),o="string"==typeof e||e instanceof il?ql(this.wd,"Transaction.update",s.S_,e,n,r):Vl(this.wd,"Transaction.update",s.S_,e),this.Td.update(s.S_,o),this},t.prototype.delete=function(t){var e=Jp(t,this.zf);return this.Td.delete(e.S_),this},t}()),Wp=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){yp(t=ll(t,lp));var n=pp(t),r=t.p_(),i=new nl;return vp(n,i,new tl(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){yp(t=ll(t,lp));var e=pp(t),n=t.p_(),r=new nl;return vp(e,r,new el(r,n.cacheSizeBytes))}(t._)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.R_&&!t.P_)throw new yi(vi.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Ju;return t.Mf.Tf(function(){return Object($r.b)(e,void 0,void 0,function(){var e;return Object($r.e)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object($r.b)(this,void 0,void 0,function(){return Object($r.e)(this,function(e){switch(e.label){case 0:return Yu.Wn()?[4,Yu.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(kc(t.I_,t.w_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t._)},t}(),Yp=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).Id=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof Ei||(i.md=e),i}return Object($r.d)(e,t),Object.defineProperty(e.prototype,"I_",{get:function(){return this._.I_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.V_()),t)).merge,this._.g_(t)},e.prototype.useEmulator=function(t,e){!function(t,e,n){var r=(t=ll(t,yl)).V_();"firestore.googleapis.com"!==r.host&&r.host!==e&&ii("Host has been set in both settings() and useEmulator(), emulator host will be used"),t.g_(Object.assign(Object.assign({},r),{host:e+":"+n,ssl:!1}))}(this._,t,e)},e.prototype.enableNetwork=function(){return function(t){var e=this;return t.fs.enqueue(function(){return Object($r.b)(e,void 0,void 0,function(){var e,n;return Object($r.e)(this,function(r){switch(r.label){case 0:return[4,ip(t)];case 1:return e=r.sent(),[4,sp(t)];case 2:return n=r.sent(),[2,(e.Vo(!0),function(t){var e=ai(t);return e.Fh.delete(0),Ch(e)}(n))]}})})})}(pp(ll(this._,lp)))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t.fs.enqueue(function(){return Object($r.b)(e,void 0,void 0,function(){var e,n;return Object($r.e)(this,function(r){switch(r.label){case 0:return[4,ip(t)];case 1:return e=r.sent(),[4,sp(t)];case 2:return n=r.sent(),[2,(e.Vo(!1),function(t){return Object($r.b)(this,void 0,void 0,function(){var e;return Object($r.e)(this,function(n){switch(n.label){case 0:return(e=ai(t)).Fh.add(0),[4,Lh(e)];case 1:return n.sent(),e.Mh.set("Offline"),[2]}})})}(n))]}})})})}(pp(ll(this._,lp)))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&al("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Id.enableMultiTabIndexedDbPersistence(this):this.Id.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Id.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Ju;return t.fs.ys(function(){return Object($r.b)(e,void 0,void 0,function(){var e;return Object($r.e)(this,function(r){switch(r.label){case 0:return e=Pf,[4,up(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(pp(ll(this._,lp)))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new rl(e);return t.fs.ys(function(){return Object($r.b)(n,void 0,void 0,function(){var e;return Object($r.e)(this,function(n){switch(n.label){case 0:return e=function(t,e){ai(t).jh.add(e),e.next()},[4,ap(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})}),function(){r.r_(),t.fs.ys(function(){return Object($r.b)(n,void 0,void 0,function(){var e;return Object($r.e)(this,function(n){switch(n.label){case 0:return e=function(t,e){ai(t).jh.delete(e)},[4,ap(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})})}}(pp(t=ll(t,lp)),Dp(e)?e:{next:e})}(this._,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.md)throw new yi(vi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new fd(this,wl(this._,t))}catch(t){throw rd(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new nd(this,Il(this._,t))}catch(t){throw rd(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new ad(this,function(t,e){if(t=ll(t,yl),sl("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new yi(vi.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new bl(t,null,function(t){return new Vo(Ci.at(),t)}(e))}(this._,t))}catch(t){throw rd(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Ju;return t.fs.ys(function(){return Object($r.b)(n,void 0,void 0,function(){var n;return Object($r.e)(this,function(i){switch(i.label){case 0:return[4,function(t){return rp(t).then(function(t){return t.Dh})}(t)];case 1:return n=i.sent(),new Zl(t.fs,n,e,r).run(),[2]}})})}),r.promise}(pp(t),function(n){return e(new Xp(t,n))})}(this._,function(n){return t(new $p(e,n))})},e.prototype.batch=function(){var t=this;return pp(this._),new td(new Qp(this._,function(e){return Hp(t._,e)}))},e.prototype.loadBundle=function(t){throw new yi(vi.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(t){throw new yi(vi.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(bi),Zp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object($r.d)(e,t),e.prototype.Uf=function(t){return new Ii(new gi(t))},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return nd.Ad(e,this.firestore,null)},e}(gp),$p=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r.Hf=new Zp(e),r}return Object($r.d)(e,t),e.prototype.get=function(t){var e=this,n=ld(t);return this._.get(n).then(function(t){return new sd(e.zf,new Mp(e.zf._,e.Hf,t.S_,t.Jf,t.metadata,n.v_))})},e.prototype.set=function(t,e,n){var r=ld(t);return n?(ul("Transaction.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=ld(t);return 2===arguments.length?this._.update(s,e):(r=this._).update.apply(r,Object($r.i)([s,e,n],i)),this},e.prototype.delete=function(t){var e=ld(t);return this._.delete(e),this},e}(bi),td=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object($r.d)(e,t),e.prototype.set=function(t,e,n){var r=ld(t);return n?(ul("WriteBatch.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=ld(t);return 2===arguments.length?this._.update(s,e):(r=this._).update.apply(r,Object($r.i)([s,e,n],i)),this},e.prototype.delete=function(t){var e=ld(t);return this._.delete(e),this},e.prototype.commit=function(){return this._.commit()},e}(bi),ed=function(t){function e(e,n,r){var i=this;return(i=t.call(this,r)||this).zf=e,i.Hf=n,i}return Object($r.d)(e,t),e.prototype.fromFirestore=function(t,e){var n=new Up(this.zf._,this.Hf,t.S_,t.Jf,t.metadata,null);return this._.fromFirestore(new ud(this.zf,n),null!=e?e:{})},e.prototype.toFirestore=function(t,e){return e?this._.toFirestore(t,e):this._.toFirestore(t)},e.Rd=function(t,n){var r=e.Pd,i=r.get(t);i||(i=new WeakMap,r.set(t,i));var o=i.get(n);return o||(o=new e(t,new Zp(t),n),i.set(n,o)),o},e}(bi);ed.Pd=new WeakMap;var nd=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new Zp(e),r}return Object($r.d)(e,t),e.yd=function(t,n,r){if(t.length%2!=0)throw new yi(vi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.ot()+" has "+t.length);return new e(n,new gl(n._,r,new Mi(t)))},e.Ad=function(t,n,r){return new e(n,new gl(n._,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new fd(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new fd(this.firestore,wl(this._,t))}catch(t){throw rd(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof bi&&(t=t._),t instanceof gl&&_l(this._,t)},e.prototype.set=function(t,e){e=ul("DocumentReference.set",e);try{return function(t,e,n){t=ll(t,gl);var r=ll(t.firestore,lp),i=Cp(t.v_,e,n);return Hp(r,[kl(Pl(r),"setDoc",t.S_,i,null!==t.v_,n).F_(t.S_,ws.Wt())])}(this._,t,e)}catch(t){throw rd(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?zp(this._,t):zp.apply(void 0,Object($r.i)([this._,t,e],n))}catch(t){throw rd(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return Hp(ll((t=this._).firestore,lp),[new Rs(t.S_,ws.Wt())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=id(e),i=od(e,function(e){return new sd(t.firestore,new Mp(t.firestore._,t.Hf,e.S_,e.Jf,e.metadata,t._.v_))});return Gp(this._,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=ll(t,gl);var e=ll(t.firestore,lp),n=pp(e),r=new Bp(e);return function(t,e){var n=this,r=new Ju;return t.fs.ys(function(){return Object($r.b)(n,void 0,void 0,function(){var n;return Object($r.e)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object($r.b)(this,void 0,void 0,function(){var r,i;return Object($r.e)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=ai(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Ic.Jo(t,e)})}(t,e)];case 1:return(i=o.sent())instanceof yo?n.resolve(i):i instanceof go?n.resolve(null):n.reject(new yi(vi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=sa(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}})})},[4,op(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t.S_).then(function(n){return new Mp(e,r,t.S_,n,new Rp(n instanceof yo&&n.bt,!0),t.v_)})}(this._):"server"===(null==t?void 0:t.source)?function(t){t=ll(t,gl);var e=ll(t.firestore,lp);return cp(pp(e),t.S_,{source:"server"}).then(function(n){return Kp(e,t,n)})}(this._):function(t){t=ll(t,gl);var e=ll(t.firestore,lp);return cp(pp(e),t.S_).then(function(n){return Kp(e,t,n)})}(this._)).then(function(t){return new sd(e.firestore,new Mp(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))})},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(ed.Rd(this.firestore,t)))},e}(bi);function rd(t,e,n){return t.message=t.message.replace(e,n),t}function id(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Dp(r))return r}return{}}function od(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Dp(t[0])?t[0]:Dp(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var sd=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object($r.d)(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new nd(this.zf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this._.data(t)},e.prototype.get=function(t,e){return this._.get(t,e)},e.prototype.isEqual=function(t){return Fp(this._,t._)},e}(bi),ud=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object($r.d)(e,t),e.prototype.data=function(t){return this._.data(t)},e}(sd),ad=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new Zp(e),r}return Object($r.d)(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,Ep(this._,function(t,e,n){var r=e,i=wp("where",t);return new Op(i,r,n)}(t,n,r)))}catch(t){throw rd(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,Ep(this._,function(t,e){void 0===e&&(e="asc");var n=e,r=wp("orderBy",t);return new Tp(r,n)}(t,n)))}catch(t){throw rd(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,Ep(this._,function(t){return pl("limit",t),new jp("limit",t,"F")}(t)))}catch(t){throw rd(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,Ep(this._,function(t){return pl("limitToLast",t),new jp("limitToLast",t,"L")}(t)))}catch(t){throw rd(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Ep(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Sp("startAt",t,!0)}).apply(void 0,t)))}catch(t){throw rd(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Ep(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Sp("startAfter",t,!1)}).apply(void 0,t)))}catch(t){throw rd(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Ep(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new xp("endBefore",t,!0)}).apply(void 0,t)))}catch(t){throw rd(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Ep(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new xp("endAt",t,!1)}).apply(void 0,t)))}catch(t){throw rd(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return El(this._,t._)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=ll(t,bl);var e=ll(t.firestore,lp),n=pp(e),r=new Bp(e);return function(t,e){var n=this,r=new Ju;return t.fs.ys(function(){return Object($r.b)(n,void 0,void 0,function(){var n;return Object($r.e)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object($r.b)(this,void 0,void 0,function(){var r,i,o,s,u;return Object($r.e)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,Qc(t,e,!0)];case 1:return u=a.sent(),r=new bf(e,u.Pc),i=r.dl(u.documents),o=r.Ei(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=a.sent(),u=sa(s,"Failed to execute query '"+e+" against cache"),n.reject(u),[3,3];case 3:return[2]}})})},[4,op(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t.C_).then(function(n){return new Vp(e,r,t,n)})}(this._):"server"===(null==t?void 0:t.source)?function(t){t=ll(t,bl);var e=ll(t.firestore,lp),n=pp(e),r=new Bp(e);return hp(n,t.C_,{source:"server"}).then(function(n){return new Vp(e,r,t,n)})}(this._):function(t){t=ll(t,bl);var e=ll(t.firestore,lp),n=pp(e),r=new Bp(e);return Ip(t.C_),hp(n,t.C_).then(function(n){return new Vp(e,r,t,n)})}(this._)).then(function(t){return new hd(e.firestore,new Vp(e.firestore._,e.Hf,e._,t.ud))})},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=id(e),i=od(e,function(e){return new hd(t.firestore,new Vp(t.firestore._,t.Hf,t._,e.ud))});return Gp(this._,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(ed.Rd(this.firestore,t)))},e}(bi),cd=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object($r.d)(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new ud(this.zf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),e}(bi),hd=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object($r.d)(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new ad(this.zf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this._.docs.map(function(e){return new ud(t.zf,e)})},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new cd(e.zf,t)})},e.prototype.forEach=function(t,e){var n=this;this._.forEach(function(r){t.call(e,new ud(n.zf,r))})},e.prototype.isEqual=function(t){return Fp(this._,t._)},e}(bi),fd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._=n,r}return Object($r.d)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._.parent;return t?new nd(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new nd(this.firestore,void 0===t?Il(this._):Il(this._,t))}catch(t){throw rd(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=ll(t.firestore,lp),r=Il(t),i=Cp(t.v_,e);return Hp(n,[kl(Pl(t.firestore),"addDoc",r.S_,i,null!==t.v_,{}).F_(r.S_,ws.exists(!1))]).then(function(){return r})}(this._,t).then(function(t){return new nd(e.firestore,t)})},e.prototype.isEqual=function(t){return _l(this._,t._)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(ed.Rd(this.firestore,t)))},e}(ad);function ld(t){return t instanceof bi&&(t=t._),ll(t,gl)}var pd=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(il.bind.apply(il,Object($r.i)([void 0],e))))||this}return Object($r.d)(e,t),e.documentId=function(){return new e(Ri.lt().ot())},e.prototype.isEqual=function(t){return t instanceof bi&&(t=t._),t instanceof il&&this._.d_.isEqual(t.d_)},e}(bi),dd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object($r.d)(e,t),e.serverTimestamp=function(){var t=new Ll("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new Dl("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Rl("arrayUnion",t)}).apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ml("arrayRemove",t)}).apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new Ul("increment",t)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e}(bi);!function(){function t(){this.gd={},this.Vd=new Ju,this.pd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this.gd={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this.Vd.promise.catch(t)},t.prototype.then=function(t,e){return this.Vd.promise.then(t,e)},t.prototype.Ul=function(t){this.Ql(t),this.gd.complete&&this.gd.complete(),this.Vd.resolve(t)},t.prototype.Wl=function(t){this.pd.taskState="Error",this.gd.next&&this.gd.next(this.pd),this.gd.error&&this.gd.error(t),this.Vd.reject(t)},t.prototype.Ql=function(t){this.pd=t,this.gd.next&&this.gd.next(t)}}();var vd,yd=n("/6Yf"),gd={Firestore:Yp,GeoPoint:Ol,Timestamp:Pi,Blob:Ii,Transaction:$p,WriteBatch:td,DocumentReference:nd,DocumentSnapshot:sd,Query:ad,QueryDocumentSnapshot:ud,QuerySnapshot:hd,CollectionReference:fd,FieldPath:pd,FieldValue:dd,setLogLevel:function(t){ti.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new yd.a("firestore",function(t){return function(t,e){return new Yp(t,new lp(t,e),new Wp)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},gd)))})(vd=J.a),vd.registerVersion("@firebase/firestore","2.1.3");var bd=n("UbJi");function md(t,e){return function(t,e=L.b){return new R.a(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{null!=r&&r()}})}(t,e)}function wd(t,e){return md(t,e).pipe(Object(F.a)(t=>({payload:t,type:"query"})))}function Id(t,e){return wd(t,e).pipe(Object(V.a)(void 0),Object(q.a)(),Object(F.a)(([t,e])=>{const n=e.payload.docChanges(),r=n.map(t=>({type:t.type,payload:t}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(e.payload.metadata)&&e.payload.docs.forEach((e,i)=>{const o=n.find(t=>t.doc.ref.isEqual(e.ref)),s=null==t?void 0:t.payload.docs.find(t=>t.ref.isEqual(e.ref));o&&JSON.stringify(o.doc.metadata)===JSON.stringify(e.metadata)||!o&&s&&JSON.stringify(s.metadata)===JSON.stringify(e.metadata)||r.push({type:"modified",payload:{oldIndex:i,newIndex:i,type:"modified",doc:e}})}),r}))}function _d(t,e,n){return Id(t,n).pipe(Object(B.a)((t,n)=>function(t,e,n){return e.forEach(e=>{n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":if(!t[e.newIndex]||!t[e.newIndex].doc.ref.isEqual(e.doc.ref))return Ed(t,e.newIndex,0,e);break;case"modified":if(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}return Ed(t,e.newIndex,1,e)}break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Ed(t,e.oldIndex,1)}return t}(t,e))}),t}(t,n.map(t=>t.payload),e),[]),Object(z.a)(),Object(F.a)(t=>t.map(t=>({type:t.type,payload:t}))))}function Ed(t,e,n,...r){const i=t.slice();return i.splice(e,n,...r),i}function Od(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}class Td{constructor(t,e,n){this.ref=t,this.query=e,this.afs=n}stateChanges(t){let e=Id(this.query,this.afs.schedulers.outsideAngular);return t&&t.length>0&&(e=e.pipe(Object(F.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)))),e.pipe(Object(V.a)(void 0),Object(q.a)(),Object(G.a)(([t,e])=>e.length>0||!t),Object(F.a)(([t,e])=>e),this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(B.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=Od(t);return _d(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return wd(this.query,this.afs.schedulers.outsideAngular).pipe(Object(F.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(M.a)(this.query.get(t)).pipe(Object(H.b)(this.afs.schedulers.insideAngular))}add(t){return this.ref.add(t)}doc(t){return new jd(this.ref.doc(t),this.afs)}}class jd{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const n=this.ref.collection(t),{ref:r,query:i}=kd(n,e);return new Td(r,i,this.afs)}snapshotChanges(){return md(this.ref,this.afs.schedulers.outsideAngular).pipe(Object(V.a)(void 0),Object(q.a)(),Object(F.a)(([t,e])=>e.exists?(null==t?void 0:t.exists)?{payload:e,type:"modified"}:{payload:e,type:"added"}:{payload:e,type:"removed"})).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return this.snapshotChanges().pipe(Object(F.a)(({payload:e})=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data()))}get(t){return Object(M.a)(this.ref.get(t)).pipe(Object(H.b)(this.afs.schedulers.insideAngular))}}class Sd{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?Id(this.query,this.afs.schedulers.outsideAngular).pipe(Object(F.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Object(G.a)(t=>t.length>0),this.afs.keepUnstableUntilFirst):Id(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(B.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=Od(t);return _d(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return wd(this.query,this.afs.schedulers.outsideAngular).pipe(Object(F.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign({[t.idField]:e.id},e.data()):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(M.a)(this.query.get(t)).pipe(Object(H.b)(this.afs.schedulers.insideAngular))}}const xd=new s.q("angularfire2.enableFirestorePersistence"),Nd=new s.q("angularfire2.firestore.persistenceSettings"),Ad=new s.q("angularfire2.firestore.settings"),Pd=new s.q("angularfire2.firestore.use-emulator");function kd(t,e=(t=>t)){return{query:e(t),ref:t}}let Dd=(()=>{class t{constructor(t,e,n,i,o,s,u,a,c){this.schedulers=new K.d(s),this.keepUnstableUntilFirst=Object(K.h)(this.schedulers);const h=Object(K.g)(t,s,e);!Q.a.auth&&c&&Object(K.j)();const f=a;[this.firestore,this.persistenceEnabled$]=Object(K.f)(h.name+".firestore","AngularFirestore",h,()=>{const t=s.runOutsideAngular(()=>h.firestore());if(i&&t.settings(i),f&&t.useEmulator(...f),n&&!Object(r.r)(o)){const e=()=>{try{return Object(M.a)(t.enablePersistence(u||void 0).then(()=>!0,()=>!1))}catch(vd){return"undefined"!=typeof console&&console.warn(vd),Object(U.a)(!1)}};return[t,s.runOutsideAngular(e)]}return[t,Object(U.a)(!1)]},[i,f,n])}collection(t,e){let n;n="string"==typeof t?this.firestore.collection(t):t;const{ref:r,query:i}=kd(n,e),o=this.schedulers.ngZone.run(()=>r);return new Td(o,i,this)}collectionGroup(t,e){const n=e||(t=>t),r=this.firestore.collectionGroup(t);return new Sd(n(r),this)}doc(t){let e;e="string"==typeof t?this.firestore.doc(t):t;const n=this.schedulers.ngZone.run(()=>e);return new jd(n,this)}createId(){return this.firestore.collection("_").doc().id}}return t.\u0275fac=function(e){return new(e||t)(s.Ub(K.c),s.Ub(K.b,8),s.Ub(xd,8),s.Ub(Ad,8),s.Ub(s.B),s.Ub(s.z),s.Ub(Nd,8),s.Ub(Pd,8),s.Ub(bd.a,8))},t.\u0275prov=Object(s.Hb)({factory:function(){return new t(Object(s.Ub)(K.c),Object(s.Ub)(K.b,8),Object(s.Ub)(xd,8),Object(s.Ub)(Ad,8),Object(s.Ub)(s.B),Object(s.Ub)(s.z),Object(s.Ub)(Nd,8),Object(s.Ub)(Pd,8),Object(s.Ub)(bd.a,8))},token:t,providedIn:"any"}),t})();const Cd=["dynamicInsert"],Ld=[{path:"",component:(()=>{class t{constructor(t,e,n,r){this.title=t,this.firestore=e,this.unsplash=n,this.dialog=r,this.title.setTitle("LearningAce | Course")}ngOnInit(){}openDialog(){this.dialog.open(C,{hasBackdrop:!0}).afterClosed().subscribe(t=>{console.log("Dialog result: "+t)})}}return t.\u0275fac=function(e){return new(e||t)(s.Lb(u.a),s.Lb(Dd),s.Lb(x),s.Lb(N.a))},t.\u0275cmp=s.Fb({type:t,selectors:[["app-course-home"]],viewQuery:function(t,e){if(1&t&&s.yc(Cd,!0,s.Q),2&t){let t;s.jc(t=s.Yb())&&(e.dynamicInsert=t.first)}},decls:14,vars:4,consts:[[3,"background","type","elevation","stackable"],[2,"cursor","pointer"],["src","https://learningace.github.io/app/assets/logo4.png","alt","LearningAce logo","width","150px",2,"padding-left","10px"],["routerLink","/course",1,"ui-button"],[1,"ui-container",2,"display","flex","flex-direction","row","justify-content","space-around"],["routerLink","add",1,"ui-card-4","d-flex","justify-content-center","box",2,"width","350px","height","300px","margin-top","20px","cursor","pointer"],[1,"glyphicon","glyphicon-plus",2,"font-size","5em","color","lightblue","text-align","center"],[1,"ui-card-4","d-flex","justify-content-center","box",2,"width","350px","height","300px","margin-top","20px","cursor","pointer",3,"click"]],template:function(t,e){1&t&&(s.Qb(0,"app-header",0),s.Qb(1,"header",1),s.Mb(2,"img",2),s.Pb(),s.Qb(3,"a",3),s.uc(4,"Back to courses"),s.Pb(),s.Pb(),s.Qb(5,"div",4),s.Qb(6,"div",5),s.Mb(7,"span",6),s.Qb(8,"label"),s.uc(9,"Add a course"),s.Pb(),s.Pb(),s.Qb(10,"div",7),s.Xb("click",function(){return e.openDialog()}),s.Mb(11,"span",6),s.Qb(12,"label"),s.uc(13,"Get Photos"),s.Pb(),s.Pb(),s.Pb()),2&t&&s.ec("background","light-gray")("type","horizontal")("elevation",!0)("stackable",!0)},directives:[a.a,o.i,o.g],styles:['.glyphicon[_ngcontent-%COMP%]{position:relative;top:1px;display:inline-block;font-family:Glyphicons Halflings;font-style:normal;font-weight:400;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.glyphicon-plus-sign[_ngcontent-%COMP%]:before{content:"\\e081"}.glyphicon-plus[_ngcontent-%COMP%]:before{content:"\\002b"}.box[_ngcontent-%COMP%]{border-radius:20px;transition:.5s ease;transition-property:all}.box[_ngcontent-%COMP%]:hover{box-shadow:0 1px 5px 1px #006089;transform:scale(1.05);-moz-transform:scale(1.05);-o-transform:scale(1.05)}']}),t})()},{path:"add",component:O}];let Rd=(()=>{class t{}return t.\u0275mod=s.Jb({type:t}),t.\u0275inj=s.Ib({factory:function(e){return new(e||t)},imports:[[o.j.forChild(Ld)],o.j]}),t})(),Md=(()=>{class t{}return t.\u0275mod=s.Jb({type:t}),t.\u0275inj=s.Ib({factory:function(e){return new(e||t)},imports:[[r.c,Rd,i.a]]}),t})()}}]);